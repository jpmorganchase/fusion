
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jpmorganchase.github.io/fusion/2.0.17/api/">
      
      
        <link rel="prev" href="../quickstart/">
      
      
        <link rel="next" href="../download/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Fusion Client - fusion</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fusion.fusion" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="fusion" class="md-header__button md-logo" aria-label="fusion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            fusion
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fusion Client
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jpmorganchase/jpmorganchase.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    jpmorganchase/fusion
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart/" class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Fusion Client

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../download/" class="md-tabs__link">
        
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../upload/" class="md-tabs__link">
        
  
    
  
  Upload

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../attributes/" class="md-tabs__link">
          
  
  Metadata Creation

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../fsync/" class="md-tabs__link">
        
  
    
  
  fsync

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../get_started/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="fusion" class="md-nav__button md-logo" aria-label="fusion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    fusion
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jpmorganchase/jpmorganchase.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    jpmorganchase/fusion
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Fusion Client
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Fusion Client
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fusion.fusion" class="md-nav__link">
    <span class="md-ellipsis">
      fusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion" class="md-nav__link">
    <span class="md-ellipsis">
      Fusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.default_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      default_catalog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.attribute" class="md-nav__link">
    <span class="md-ellipsis">
      attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.catalog_resources" class="md-nav__link">
    <span class="md-ellipsis">
      catalog_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.create_dataset_lineage" class="md-nav__link">
    <span class="md-ellipsis">
      create_dataset_lineage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.dataset" class="md-nav__link">
    <span class="md-ellipsis">
      dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.dataset_resources" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.datasetmember_resources" class="md-nav__link">
    <span class="md-ellipsis">
      datasetmember_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.delete_all_datasetmembers" class="md-nav__link">
    <span class="md-ellipsis">
      delete_all_datasetmembers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.delete_datasetmembers" class="md-nav__link">
    <span class="md-ellipsis">
      delete_datasetmembers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.download" class="md-nav__link">
    <span class="md-ellipsis">
      download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.from_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      from_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_async_fusion_vector_store_client" class="md-nav__link">
    <span class="md-ellipsis">
      get_async_fusion_vector_store_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_events" class="md-nav__link">
    <span class="md-ellipsis">
      get_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_fusion_filesystem" class="md-nav__link">
    <span class="md-ellipsis">
      get_fusion_filesystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_fusion_vector_store_client" class="md-nav__link">
    <span class="md-ellipsis">
      get_fusion_vector_store_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.input_dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      input_dataflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.link_attributes_to_terms" class="md-nav__link">
    <span class="md-ellipsis">
      link_attributes_to_terms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_catalogs" class="md-nav__link">
    <span class="md-ellipsis">
      list_catalogs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_dataset_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      list_dataset_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_dataset_lineage" class="md-nav__link">
    <span class="md-ellipsis">
      list_dataset_lineage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_datasetmembers" class="md-nav__link">
    <span class="md-ellipsis">
      list_datasetmembers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_datasetmembers_distributions" class="md-nav__link">
    <span class="md-ellipsis">
      list_datasetmembers_distributions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      list_datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_distributions" class="md-nav__link">
    <span class="md-ellipsis">
      list_distributions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_indexes" class="md-nav__link">
    <span class="md-ellipsis">
      list_indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_product_dataset_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      list_product_dataset_mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_products" class="md-nav__link">
    <span class="md-ellipsis">
      list_products
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_registered_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      list_registered_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_report_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      list_report_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_reports" class="md-nav__link">
    <span class="md-ellipsis">
      list_reports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.listen_to_events" class="md-nav__link">
    <span class="md-ellipsis">
      listen_to_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.output_dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      output_dataflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.product" class="md-nav__link">
    <span class="md-ellipsis">
      product
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.report" class="md-nav__link">
    <span class="md-ellipsis">
      report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.report_attribute" class="md-nav__link">
    <span class="md-ellipsis">
      report_attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.report_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      report_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.reports" class="md-nav__link">
    <span class="md-ellipsis">
      reports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.to_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      to_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.to_df" class="md-nav__link">
    <span class="md-ellipsis">
      to_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.to_table" class="md-nav__link">
    <span class="md-ellipsis">
      to_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upload
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metadata Creation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Metadata Creation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attributes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../products/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Products
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fsync
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fusion - get started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadata_creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fusion - Metadata Creation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fusion.fusion" class="md-nav__link">
    <span class="md-ellipsis">
      fusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion" class="md-nav__link">
    <span class="md-ellipsis">
      Fusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.default_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      default_catalog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.attribute" class="md-nav__link">
    <span class="md-ellipsis">
      attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.catalog_resources" class="md-nav__link">
    <span class="md-ellipsis">
      catalog_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.create_dataset_lineage" class="md-nav__link">
    <span class="md-ellipsis">
      create_dataset_lineage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.dataset" class="md-nav__link">
    <span class="md-ellipsis">
      dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.dataset_resources" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.datasetmember_resources" class="md-nav__link">
    <span class="md-ellipsis">
      datasetmember_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.delete_all_datasetmembers" class="md-nav__link">
    <span class="md-ellipsis">
      delete_all_datasetmembers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.delete_datasetmembers" class="md-nav__link">
    <span class="md-ellipsis">
      delete_datasetmembers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.download" class="md-nav__link">
    <span class="md-ellipsis">
      download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.from_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      from_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_async_fusion_vector_store_client" class="md-nav__link">
    <span class="md-ellipsis">
      get_async_fusion_vector_store_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_events" class="md-nav__link">
    <span class="md-ellipsis">
      get_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_fusion_filesystem" class="md-nav__link">
    <span class="md-ellipsis">
      get_fusion_filesystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.get_fusion_vector_store_client" class="md-nav__link">
    <span class="md-ellipsis">
      get_fusion_vector_store_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.input_dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      input_dataflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.link_attributes_to_terms" class="md-nav__link">
    <span class="md-ellipsis">
      link_attributes_to_terms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_catalogs" class="md-nav__link">
    <span class="md-ellipsis">
      list_catalogs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_dataset_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      list_dataset_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_dataset_lineage" class="md-nav__link">
    <span class="md-ellipsis">
      list_dataset_lineage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_datasetmembers" class="md-nav__link">
    <span class="md-ellipsis">
      list_datasetmembers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_datasetmembers_distributions" class="md-nav__link">
    <span class="md-ellipsis">
      list_datasetmembers_distributions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      list_datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_distributions" class="md-nav__link">
    <span class="md-ellipsis">
      list_distributions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_indexes" class="md-nav__link">
    <span class="md-ellipsis">
      list_indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_product_dataset_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      list_product_dataset_mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_products" class="md-nav__link">
    <span class="md-ellipsis">
      list_products
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_registered_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      list_registered_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_report_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      list_report_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.list_reports" class="md-nav__link">
    <span class="md-ellipsis">
      list_reports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.listen_to_events" class="md-nav__link">
    <span class="md-ellipsis">
      listen_to_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.output_dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      output_dataflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.product" class="md-nav__link">
    <span class="md-ellipsis">
      product
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.report" class="md-nav__link">
    <span class="md-ellipsis">
      report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.report_attribute" class="md-nav__link">
    <span class="md-ellipsis">
      report_attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.report_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      report_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.reports" class="md-nav__link">
    <span class="md-ellipsis">
      reports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.to_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      to_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.to_df" class="md-nav__link">
    <span class="md-ellipsis">
      to_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.to_table" class="md-nav__link">
    <span class="md-ellipsis">
      to_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion.fusion.Fusion.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Fusion Client</h1>

<div class="doc doc-object doc-module">



<a id="fusion.fusion"></a>
    <div class="doc doc-contents first">

        <p>Main Fusion module.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="fusion.fusion.Fusion" class="doc doc-heading">
            <code>Fusion</code>


<a href="#fusion.fusion.Fusion" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Core Fusion class for API access.</p>






              <details class="quote">
                <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Fusion</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Core Fusion class for API access.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Private function that calls an API endpoint and returns the data as a pandas dataframe, </span>
<span class="sd">        with pagination support.</span>
<span class="sd">        Args:</span>
<span class="sd">            url (Union[FusionCredentials, Union[str, dict]): URL for an API endpoint with valid parameters.</span>
<span class="sd">            session (requests.Session): Specify a proxy if required to access the authentication server. Defaults to {}.</span>
<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: a dataframe containing the requested data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">response_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resources&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">ret_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret_df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_call_for_bytes_object</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BytesIO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Private function that calls an API endpoint and returns the data as a bytes object in memory.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (Union[FusionCredentials, Union[str, dict]): URL for an API endpoint with valid parameters.</span>
<span class="sd">            session (requests.Session): Specify a proxy if required to access the authentication server. Defaults to {}.</span>

<span class="sd">        Returns:</span>
<span class="sd">            io.BytesIO: in memory file content</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">FusionCredentials</span> <span class="o">=</span> <span class="s2">&quot;config/client_credentials.json&quot;</span><span class="p">,</span>
        <span class="n">root_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://fusion.jpmorgan.com/api/v1/&quot;</span><span class="p">,</span>
        <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;downloads&quot;</span><span class="p">,</span>
        <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
        <span class="n">fs</span><span class="p">:</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">filesystem</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">log_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">enable_logging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor to instantiate a new Fusion object.</span>

<span class="sd">        Args:</span>
<span class="sd">            credentials (Union[str, FusionCredentials]): A path to a credentials file or a fully populated</span>
<span class="sd">            FusionCredentials object. Defaults to &#39;config/client_credentials.json&#39;.</span>
<span class="sd">            root_url (_type_, optional): The API root URL.</span>
<span class="sd">                Defaults to &quot;https://fusion.jpmorgan.com/api/v1/&quot;.</span>
<span class="sd">            download_folder (str, optional): The folder path where downloaded data files</span>
<span class="sd">                are saved. Defaults to &quot;downloads&quot;.</span>
<span class="sd">            log_level (int, optional): Set the logging level. Defaults to logging.ERROR.</span>
<span class="sd">            fs (fsspec.filesystem): filesystem.</span>
<span class="sd">            log_path (str, optional): The folder path where the log is stored.</span>
<span class="sd">            enable_logging (bool, optional): If True, enables logging to a file in addition to stdout.</span>
<span class="sd">                If False, logging is only directed to stdout. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_catalog</span> <span class="o">=</span> <span class="s2">&quot;common&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="o">=</span> <span class="n">root_url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span> <span class="o">=</span> <span class="n">download_folder</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">download_folder</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="n">VERBOSE_LVL</span><span class="p">,</span> <span class="s2">&quot;VERBOSE&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>

        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2">.</span><span class="si">%(msecs)03d</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2">:</span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">enable_logging</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">):</span>
            <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">/fusion_sdk.log&quot;</span><span class="p">)</span>
            <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">):</span>
            <span class="n">stdout_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
            <span class="n">stdout_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">stdout_handler</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="n">FusionCredentials</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span> <span class="o">=</span> <span class="n">credentials</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span> <span class="o">=</span> <span class="n">FusionCredentials</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">credentials</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">CredentialError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;status_code&quot;</span><span class="p">):</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Failed to load credentials. Please check the credentials file.&quot;</span>
                    <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;credentials must be a path to a credentials file or FusionCredentials object&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">get_session</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span> <span class="k">if</span> <span class="n">fs</span> <span class="k">else</span> <span class="n">get_default_fs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Object representation to list all available methods.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;Fusion object </span><span class="se">\n</span><span class="s2">Available methods:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">tabulate</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="n">method_name</span>
                        <span class="k">for</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">method_name</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">method_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="o">+</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="nb">property</span><span class="p">)],</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">method_name</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">method_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="o">+</span> <span class="p">[</span>
                        <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="nb">property</span><span class="p">)</span>
                    <span class="p">],</span>
                <span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the default catalog.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_catalog</span>

    <span class="nd">@default_catalog</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow the default catalog, which is &quot;common&quot; to be overridden.</span>

<span class="sd">        Args:</span>
<span class="sd">            catalog (str): The catalog to use as the default</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_catalog</span> <span class="o">=</span> <span class="n">catalog</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_use_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine which catalog to use in an API call.</span>

<span class="sd">        Args:</span>
<span class="sd">            catalog (str): The catalog value passed as an argument to an API function wrapper.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The catalog to use</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">catalog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_catalog</span>

        <span class="k">return</span> <span class="n">catalog</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_fusion_filesystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FusionHTTPFileSystem</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve Fusion file system instance.</span>

<span class="sd">        Note: This function always returns a reference to the exact same FFS instance since</span>
<span class="sd">        an FFS instance is based off the FusionCredentials object.</span>

<span class="sd">        Returns: Fusion Filesystem</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">as_async</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;asynchronous&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">FusionHTTPFileSystem</span><span class="p">(</span>
            <span class="n">asynchronous</span><span class="o">=</span><span class="n">as_async</span><span class="p">,</span> <span class="n">client_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;root_url&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_new_root_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a modified version of the root URL to support the new API format.</span>

<span class="sd">        This method temporarily strips trailing segments such as &quot;/api/v1/&quot; or &quot;/v1/&quot;</span>
<span class="sd">        from the original `root_url` to align with an updated API base path format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The adjusted root URL without trailing version segments.</span>

<span class="sd">        Deprecated:</span>
<span class="sd">            This method is temporary and will be removed once all components have migrated</span>
<span class="sd">            to the new API structure. Use `root_url` and apply formatting externally</span>
<span class="sd">            as needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_root_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span>

        <span class="k">if</span> <span class="n">new_root_url</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">new_root_url</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/api/v1/&quot;</span><span class="p">):</span>
                <span class="n">new_root_url</span> <span class="o">=</span> <span class="n">new_root_url</span><span class="p">[:</span><span class="o">-</span><span class="mi">8</span><span class="p">]</span>  <span class="c1"># remove &quot;/api/v1/&quot;</span>
            <span class="k">elif</span> <span class="n">new_root_url</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/v1/&quot;</span><span class="p">):</span>
                <span class="n">new_root_url</span> <span class="o">=</span> <span class="n">new_root_url</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># remove &quot;/v1/&quot;</span>

        <span class="k">return</span> <span class="n">new_root_url</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_catalogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lists the catalogs available to the API account.</span>

<span class="sd">        Args:</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each catalog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/&quot;</span>
        <span class="n">cat_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">cat_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">catalog_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the resources contained within the catalog, for example products and datasets.</span>

<span class="sd">        Args:</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">           class:`pandas.DataFrame`: A dataframe with a row for each resource within the catalog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">cat_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">cat_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_products</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">contains</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">id_contains</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the products contained in a catalog. A product is a grouping of datasets.</span>

<span class="sd">        Args:</span>
<span class="sd">            contains (Union[str, list], optional): A string or a list of strings that are product</span>
<span class="sd">                identifiers to filter the products list. If a list is provided then it will return</span>
<span class="sd">                products whose identifier matches any of the strings. Defaults to None.</span>
<span class="sd">            id_contains (bool): Filter datasets only where the string(s) are contained in the identifier,</span>
<span class="sd">                ignoring description.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">            max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">                Defaults to -1 which returns all results.</span>
<span class="sd">            display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">                otherwise only the key columns are displayed</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: a dataframe with a row for each product</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/products&quot;</span>
        <span class="n">full_prod_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">contains</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">contains</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">id_contains</span><span class="p">:</span>
                <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">full_prod_df</span><span class="p">[</span><span class="n">full_prod_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">full_prod_df</span><span class="p">[</span>
                    <span class="n">full_prod_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="o">|</span> <span class="n">full_prod_df</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">full_prod_df</span>

        <span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
        <span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span>
                <span class="n">filtered_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;region&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">filtered_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_datasets</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912, PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">contains</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">id_contains</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dataset_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the datasets contained in a catalog.</span>

<span class="sd">        Args:</span>
<span class="sd">            contains (Union[str, list], optional): A string or a list of strings that are dataset</span>
<span class="sd">                identifiers to filter the datasets list. If a list is provided then it will return</span>
<span class="sd">                datasets whose identifier matches any of the strings. If a single dataset identifier is provided and</span>
<span class="sd">                there is an exact match, only that dataset will be returned. Defaults to None.</span>
<span class="sd">            id_contains (bool): Filter datasets only where the string(s) are contained in the identifier,</span>
<span class="sd">                ignoring description.</span>
<span class="sd">            product (Union[str, list], optional): A string or a list of strings that are product</span>
<span class="sd">                identifiers to filter the datasets list. Defaults to None.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">            max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">                Defaults to -1 which returns all results.</span>
<span class="sd">            display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">                otherwise only the key columns are displayed</span>
<span class="sd">            status (str, optional): filter the datasets by status, default is to show all results.</span>
<span class="sd">            dataset_type (str, optional): filter the datasets by type, default is to show all results.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: a dataframe with a row for each dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="c1"># try for exact match</span>
        <span class="k">if</span> <span class="n">contains</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">contains</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">resp_json</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;containerType&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;region&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;coverageStartDate&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;coverageEndDate&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">resp_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">}</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">resp_json</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets&quot;</span>
        <span class="n">ds_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">contains</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">contains</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">id_contains</span><span class="p">:</span>
                <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span>
                    <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="o">|</span> <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">]</span>

        <span class="k">if</span> <span class="n">product</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/productDatasets&quot;</span>
            <span class="n">prd_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
            <span class="n">prd_df</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">prd_df</span><span class="p">[</span><span class="n">prd_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">product</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">prd_df</span><span class="p">[</span><span class="n">prd_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">product</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">prd_df</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">())]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_df</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
        <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_df</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;containerType&quot;</span><span class="p">,</span>
                <span class="s2">&quot;region&quot;</span><span class="p">,</span>
                <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                <span class="s2">&quot;coverageStartDate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;coverageEndDate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ds_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">status</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">dataset_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">ds_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_reports</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">report_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve a single report or all reports from the Fusion system.&quot;&quot;&quot;</span>
        <span class="n">key_columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;id&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;alternateId&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tierType&quot;</span><span class="p">,</span>
            <span class="s2">&quot;frequency&quot;</span><span class="p">,</span>
            <span class="s2">&quot;category&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subCategory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;reportOwner&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lob&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">report_id</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_new_root_url</span><span class="p">()</span><span class="si">}</span><span class="s2">/api/corelineage-service/v1/reports/</span><span class="si">{</span><span class="n">report_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
                <span class="n">rep_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
                    <span class="n">rep_df</span> <span class="o">=</span> <span class="n">rep_df</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">return</span> <span class="n">rep_df</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_new_root_url</span><span class="p">()</span><span class="si">}</span><span class="s2">/api/corelineage-service/v1/reports/list&quot;</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="n">rep_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
                    <span class="n">rep_df</span> <span class="o">=</span> <span class="n">rep_df</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">return</span> <span class="n">rep_df</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">key_columns</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_report_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">report_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the attributes (report elements) of a specific report.&quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_new_root_url</span><span class="p">()</span><span class="si">}</span><span class="s2">/api/corelineage-service/v1/reports/</span><span class="si">{</span><span class="n">report_id</span><span class="si">}</span><span class="s2">/reportElements&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="n">rep_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
                <span class="n">key_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;dataType&quot;</span><span class="p">,</span> <span class="s2">&quot;isMandatory&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;createdBy&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="n">rep_df</span> <span class="o">=</span> <span class="n">rep_df</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="n">rep_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;dataType&quot;</span><span class="p">,</span> <span class="s2">&quot;isMandatory&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;createdBy&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dataset_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the resources available for a dataset, currently this will always be a datasetseries.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each resource</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">ds_res_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">ds_res_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_dataset_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the list of attributes that are in the dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">            display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">                otherwise only the key columns are displayed</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/attributes&quot;</span>
        <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;index&quot;</span> <span class="ow">in</span> <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
            <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">ds_attr_df</span><span class="p">[</span>
                <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;dataType&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;isDatasetKey&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">ds_attr_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_datasetmembers</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the available members in the dataset series.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">            max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">                Defaults to -1 which returns all results.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: a dataframe with a row for each dataset member.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries&quot;</span>
        <span class="n">ds_members_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ds_members_df</span> <span class="o">=</span> <span class="n">ds_members_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">ds_members_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">datasetmember_resources</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">series</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the available resources for a datasetseries member.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            series (str): The datasetseries identifier</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each datasetseries member resource.</span>
<span class="sd">                Currently, this will always be distributions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries/</span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">ds_mem_res_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">ds_mem_res_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_distributions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">series</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the available distributions (downloadable instances of the dataset with a format type).</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            series (str): The datasetseries identifier</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries/</span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">/distributions&quot;</span>
        <span class="n">distros_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">distros_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_resolve_distro_tuples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve distribution tuples given specification params.</span>

<span class="sd">        A private utility function to generate a list of distribution tuples.</span>
<span class="sd">        Each tuple is a distribution, identified by catalog, dataset id,</span>
<span class="sd">        datasetseries member id, and the file format.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">                or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">                instance of the dataset.</span>
<span class="sd">            dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: a list of tuples, one for each distribution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">datasetseries_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasetseries_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are no dataset members for dataset </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">datasetseries_list</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No data available for dataset </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Check that a valid dataset identifier and date/date range has been set.&quot;</span>
                <span class="p">),</span>
                <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
            <span class="n">dt_str</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">datasetseries_list</span><span class="p">[</span>
                    <span class="n">datasetseries_list</span><span class="p">[</span><span class="s2">&quot;createdDate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">datasetseries_list</span><span class="p">[</span><span class="s2">&quot;createdDate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="p">]</span>
                <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;identifier&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">datasetseries_list</span> <span class="o">=</span> <span class="n">datasetseries_list</span><span class="p">[</span><span class="n">datasetseries_list</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dt_str</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parsed_dates</span> <span class="o">=</span> <span class="n">normalise_dt_param_str</span><span class="p">(</span><span class="n">dt_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_dates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">parsed_dates</span> <span class="o">=</span> <span class="p">(</span><span class="n">parsed_dates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">parsed_dates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">parsed_dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">datasetseries_list</span> <span class="o">=</span> <span class="n">datasetseries_list</span><span class="p">[</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">datasetseries_list</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]])</span>
                    <span class="o">&gt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">parsed_dates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">parsed_dates</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">datasetseries_list</span> <span class="o">=</span> <span class="n">datasetseries_list</span><span class="p">[</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">datasetseries_list</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]])</span>
                    <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">parsed_dates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasetseries_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
                <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No data available for dataset </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Check that a valid dataset identifier and date/date range has been set.&quot;</span>
                <span class="p">),</span>
                <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">required_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasetseries_list</span><span class="p">[</span><span class="s2">&quot;@id&quot;</span><span class="p">])</span>
        <span class="n">tups</span> <span class="o">=</span> <span class="p">[(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">dataset_format</span><span class="p">)</span> <span class="k">for</span> <span class="n">series</span> <span class="ow">in</span> <span class="n">required_series</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">tups</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912, PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">partitioning</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">preserve_original_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Downloads the requested distributions of a dataset to disk.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">                or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">                instance of the dataset. If more than one series member exists on the latest date, the</span>
<span class="sd">                series member identifiers will be sorted alphabetically and the last one will be downloaded.</span>
<span class="sd">            dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">                If set to None, the function will download if only one format is available, else it will raise an error.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            n_par (int, optional): Specify how many distributions to download in parallel.</span>
<span class="sd">                Defaults to all cpus available.</span>
<span class="sd">            show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">            force_download (bool, optional): If True then will always download a file even</span>
<span class="sd">                if it is already on disk. Defaults to True.</span>
<span class="sd">            download_folder (str, optional): The path, absolute or relative, where downloaded files are saved.</span>
<span class="sd">                Defaults to download_folder as set in __init__</span>
<span class="sd">            return_paths (bool, optional): Return paths and success statuses of the downloaded files.</span>
<span class="sd">            partitioning (str, optional): Partitioning specification.</span>
<span class="sd">            preserve_original_name (bool, optional): Preserve the original name of the file. Defaults to False.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="c1"># check access to the dataset</span>
        <span class="n">dataset_resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">dataset_resp</span><span class="p">)</span>

        <span class="n">access_status</span> <span class="o">=</span> <span class="n">dataset_resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">access_status</span> <span class="o">!=</span> <span class="s2">&quot;Subscribed&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>
                <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are not subscribed to </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">. Please request access.&quot;</span><span class="p">),</span>
                <span class="n">status_code</span><span class="o">=</span><span class="mi">401</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">valid_date_range</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(\d</span><span class="si">{4}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">)$|^((\d</span><span class="si">{4}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">)?([:])(\d</span><span class="si">{4}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">)?)$&quot;</span><span class="p">)</span>

        <span class="c1"># check that format is valid and if none, check if there is only one format available</span>
        <span class="n">distributions_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_datasetmembers_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">distributions_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No distributions found for dataset &#39;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&#39; in catalog &#39;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

        <span class="n">available_formats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">distributions_df</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">and</span> <span class="n">dataset_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available_formats</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Dataset format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2"> is not available for </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Available formats are </span><span class="si">{</span><span class="n">available_formats</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_formats</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dataset_format</span> <span class="o">=</span> <span class="n">available_formats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Multiple formats found for </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">. Dataset format is required to&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;download. Available formats are </span><span class="si">{</span><span class="n">available_formats</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">valid_date_range</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">dt_str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
            <span class="n">required_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_distro_tuples</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">dataset_format</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># sample data is limited to csv</span>
            <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">:</span>
                <span class="n">dataset_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">required_series</span> <span class="o">=</span> <span class="p">[(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">dataset_format</span><span class="p">)]</span>  <span class="c1"># type: ignore[list-item]</span>

        <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RECOGNIZED_FORMATS</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2"> is not supported.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">download_folder</span><span class="p">:</span>
            <span class="n">download_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span>

        <span class="n">download_folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">download_folder</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">required_series</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">partitioning</span> <span class="o">==</span> <span class="s2">&quot;hive&quot;</span><span class="p">:</span>
            <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">series</span> <span class="ow">in</span> <span class="n">required_series</span><span class="p">]</span>
            <span class="n">download_folders</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">download_folders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">members</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">series</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">required_series</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">download_folders</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">create_parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">n_par</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
        <span class="n">download_spec</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;lfs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
                <span class="s2">&quot;rpath&quot;</span><span class="p">:</span> <span class="n">distribution_to_url</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">is_download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="s2">&quot;lpath&quot;</span><span class="p">:</span> <span class="n">distribution_to_filename</span><span class="p">(</span>
                    <span class="n">download_folders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">partitioning</span><span class="o">=</span><span class="n">partitioning</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="s2">&quot;overwrite&quot;</span><span class="p">:</span> <span class="n">force_download</span><span class="p">,</span>
                <span class="s2">&quot;preserve_original_name&quot;</span><span class="p">:</span> <span class="n">preserve_original_name</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">series</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">required_series</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
            <span class="n">VERBOSE_LVL</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Beginning </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">download_spec</span><span class="p">)</span><span class="si">}</span><span class="s2"> downloads in batches of </span><span class="si">{</span><span class="n">n_par</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">Progress</span><span class="p">()</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">task</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;Downloading&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">download_spec</span><span class="p">))</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">download_spec</span><span class="p">:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="o">**</span><span class="n">spec</span><span class="p">)</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="o">**</span><span class="n">spec</span><span class="p">)</span> <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">download_spec</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The download of </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> was not successful&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span> <span class="k">if</span> <span class="n">return_paths</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_stream_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return async stream of a file fro mthe given url.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): File url. Appends Fusion.root_url if http prefix not present.</span>
<span class="sd">            chunk_size (int, optional): Size for each chunk in async stream. Defaults to 100.</span>

<span class="sd">        Returns:</span>
<span class="sd">            AsyncGenerator[bytes, None]: Async generator object.</span>

<span class="sd">        Yields:</span>
<span class="sd">            Iterator[AsyncGenerator[bytes, None]]: Next set of bytes read from the file at given url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dup_credentials</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">)</span>
        <span class="n">async_fs</span> <span class="o">=</span> <span class="n">FusionHTTPFileSystem</span><span class="p">(</span>
            <span class="n">client_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;root_url&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="n">dup_credentials</span><span class="p">},</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">session</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fs</span><span class="o">.</span><span class="n">set_session</span><span class="p">()</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">async_fs</span><span class="o">.</span><span class="n">_stream_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">chunk</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a file from url as a bytes object, asynchronously.</span>

<span class="sd">        Under the hood, opens up an async stream downloading file in chunk_size bytes per chunk.</span>
<span class="sd">        Larger chunk sizes results in shorter execution time for this function.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): File url. Appends Fusion.root_url if http prefix not present.</span>
<span class="sd">            chunk_size (int, optional): Size of chunks to get from async stream. Defaults to 1000.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: File from url as a bytes object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">async_generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_async_stream_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
        <span class="n">bytes_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">async</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">async_generator</span><span class="p">]</span>
        <span class="n">final_bytes</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bytes_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">final_bytes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_df</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filters</span><span class="p">:</span> <span class="n">PyArrowFilterT</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dataframe_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets distributions for a specified date or date range and returns the data as a dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">                or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">                instance of the dataset.</span>
<span class="sd">            dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            n_par (int, optional): Specify how many distributions to download in parallel.</span>
<span class="sd">                Defaults to all cpus available.</span>
<span class="sd">            show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">            columns (List, optional): A list of columns to return from a parquet file. Defaults to None</span>
<span class="sd">            filters (List, optional): List[Tuple] or List[List[Tuple]] or None (default)</span>
<span class="sd">                Rows which do not match the filter predicate will be removed from scanned data.</span>
<span class="sd">                Partition keys embedded in a nested directory structure will be exploited to avoid</span>
<span class="sd">                loading files at all if they contain no matching rows. If use_legacy_dataset is True,</span>
<span class="sd">                filters can only reference partition keys and only a hive-style directory structure</span>
<span class="sd">                is supported. When setting use_legacy_dataset to False, also within-file level filtering</span>
<span class="sd">                and different partitioning schemes are supported.</span>
<span class="sd">                More on https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html</span>
<span class="sd">            force_download (bool, optional): If True then will always download a file even</span>
<span class="sd">                if it is already on disk. Defaults to False.</span>
<span class="sd">            download_folder (str, optional): The path, absolute or relative, where downloaded files are saved.</span>
<span class="sd">                Defaults to download_folder as set in __init__</span>
<span class="sd">            dataframe_type (str, optional): Type</span>
<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: a dataframe containing the requested data.</span>
<span class="sd">                If multiple dataset instances are retrieved then these are concatenated first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="c1"># sample data is limited to csv</span>
        <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">:</span>
            <span class="n">dataset_format</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">download_folder</span><span class="p">:</span>
            <span class="n">download_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span>

        <span class="n">download_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
            <span class="n">dataset</span><span class="p">,</span>
            <span class="n">dt_str</span><span class="p">,</span>
            <span class="n">dataset_format</span><span class="p">,</span>
            <span class="n">catalog</span><span class="p">,</span>
            <span class="n">n_par</span><span class="p">,</span>
            <span class="n">show_progress</span><span class="p">,</span>
            <span class="n">force_download</span><span class="p">,</span>
            <span class="n">download_folder</span><span class="p">,</span>
            <span class="n">return_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">download_res</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must specify &#39;return_paths=True&#39; in download call to use this function&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">):</span>
            <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Not all downloads were successfully completed. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Re-run to collect missing files. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">]</span>

        <span class="n">pd_read_fn_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="n">read_csv</span><span class="p">,</span>
            <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="n">read_parquet</span><span class="p">,</span>
            <span class="s2">&quot;parq&quot;</span><span class="p">:</span> <span class="n">read_parquet</span><span class="p">,</span>
            <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">read_json</span><span class="p">,</span>
            <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">read_csv</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">pd_read_default_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
                <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
                <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
                <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
                <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
                <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
                <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
                <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
                <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

        <span class="n">pd_read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">]</span>

        <span class="n">pd_reader</span> <span class="o">=</span> <span class="n">pd_read_fn_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">)</span>
        <span class="n">pd_read_kwargs</span> <span class="o">=</span> <span class="n">pd_read_default_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pd_reader</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No pandas function to read file in format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">pd_read_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>
                <span class="ne">Exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No series members for dataset: </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in date or date range: </span><span class="si">{</span><span class="n">dt_str</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;and format: </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
                <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;parq&quot;</span><span class="p">]:</span>
            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd_reader</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">pd_read_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">elif</span> <span class="n">dataset_format</span> <span class="o">==</span> <span class="s2">&quot;raw&quot;</span><span class="p">:</span>
            <span class="n">dataframes</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">pd_reader</span><span class="p">(</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="o">**</span><span class="n">pd_read_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">namelist</span><span class="p">()],</span>  <span class="c1"># type: ignore  # noqa: SIM115</span>
                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span>
            <span class="p">)</span>
            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataframes</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd_reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">pd_read_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">dataframe_type</span> <span class="o">==</span> <span class="s2">&quot;pandas&quot;</span><span class="p">:</span>
                <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dataframe_type</span> <span class="o">==</span> <span class="s2">&quot;polars&quot;</span><span class="p">:</span>
                <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

                <span class="n">data_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;diagonal&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">data_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_bytes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">series_member</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BytesIO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an instance of dataset (the distribution) as a bytes object.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            series_member (str,): A dataset series member identifier</span>
<span class="sd">            dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="n">distribution_to_url</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
            <span class="n">dataset</span><span class="p">,</span>
            <span class="n">series_member</span><span class="p">,</span>
            <span class="n">dataset_format</span><span class="p">,</span>
            <span class="n">catalog</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_bytes_object</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_table</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">filters</span><span class="p">:</span> <span class="n">PyArrowFilterT</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets distributions for a specified date or date range and returns the data as an arrow table.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">                or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">                instance of the dataset.</span>
<span class="sd">            dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            n_par (int, optional): Specify how many distributions to download in parallel.</span>
<span class="sd">                Defaults to all cpus available.</span>
<span class="sd">            show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">            columns (List, optional): A list of columns to return from a parquet file. Defaults to None</span>
<span class="sd">            filters (List, optional): List[Tuple] or List[List[Tuple]] or None (default)</span>
<span class="sd">                Rows which do not match the filter predicate will be removed from scanned data.</span>
<span class="sd">                Partition keys embedded in a nested directory structure will be exploited to avoid</span>
<span class="sd">                loading files at all if they contain no matching rows. If use_legacy_dataset is True,</span>
<span class="sd">                filters can only reference partition keys and only a hive-style directory structure</span>
<span class="sd">                is supported. When setting use_legacy_dataset to False, also within-file level filtering</span>
<span class="sd">                and different partitioning schemes are supported.</span>
<span class="sd">                More on https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html</span>
<span class="sd">            force_download (bool, optional): If True then will always download a file even</span>
<span class="sd">                if it is already on disk. Defaults to False.</span>
<span class="sd">            download_folder (str, optional): The path, absolute or relative, where downloaded files are saved.</span>
<span class="sd">                Defaults to download_folder as set in __init__</span>
<span class="sd">        Returns:</span>
<span class="sd">            class:`pyarrow.Table`: a dataframe containing the requested data.</span>
<span class="sd">                If multiple dataset instances are retrieved then these are concatenated first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">n_par</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">download_folder</span><span class="p">:</span>
            <span class="n">download_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span>
        <span class="n">download_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
            <span class="n">dataset</span><span class="p">,</span>
            <span class="n">dt_str</span><span class="p">,</span>
            <span class="n">dataset_format</span><span class="p">,</span>
            <span class="n">catalog</span><span class="p">,</span>
            <span class="n">n_par</span><span class="p">,</span>
            <span class="n">show_progress</span><span class="p">,</span>
            <span class="n">force_download</span><span class="p">,</span>
            <span class="n">download_folder</span><span class="p">,</span>
            <span class="n">return_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">download_res</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must specify &#39;return_paths=True&#39; in download call to use this function&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">):</span>
            <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Not all downloads were successfully completed. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Re-run to collect missing files. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">]</span>

        <span class="n">read_fn_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="n">csv_to_table</span><span class="p">,</span>
            <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="n">parquet_to_table</span><span class="p">,</span>
            <span class="s2">&quot;parq&quot;</span><span class="p">:</span> <span class="n">parquet_to_table</span><span class="p">,</span>
            <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">json_to_table</span><span class="p">,</span>
            <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">csv_to_table</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">read_default_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
            <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
            <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
            <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
        <span class="p">}</span>

        <span class="n">read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">]</span>

        <span class="n">reader</span> <span class="o">=</span> <span class="n">read_fn_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">)</span>
        <span class="n">read_kwargs</span> <span class="o">=</span> <span class="n">read_default_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reader</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No function to read file in format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">read_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>
                <span class="ne">Exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No series members for dataset: </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in date or date range: </span><span class="si">{</span><span class="n">dt_str</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;and format: </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
                <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;parq&quot;</span><span class="p">]:</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">read_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="p">(</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">read_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">concat_tables</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tbl</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">upload</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912, PLR0913, PLR0915</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multipart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">from_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">to_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">preserve_original_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">additional_headers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uploads the requested files/files to Fusion.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): path to a file or a folder with sub folders and files</span>
<span class="sd">            dataset (str, optional): Dataset identifier to which the files will be uploaded.</span>
<span class="sd">                                    If not provided the dataset will be implied from file&#39;s name.</span>
<span class="sd">                                    This is mandatory when uploading a directory.</span>
<span class="sd">            dt_str (str, optional): A file name. Can be any string but is usually a date.</span>
<span class="sd">                                    Defaults to &#39;latest&#39; which will return the most recent.</span>
<span class="sd">                                    Relevant for a single file upload only. If not provided the dataset will</span>
<span class="sd">                                    be implied from file&#39;s name. dt_str will be ignored when uploading</span>
<span class="sd">                                    a directory.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            n_par (int, optional): Specify how many distributions to upload in parallel.</span>
<span class="sd">                Defaults to all cpus available.</span>
<span class="sd">            show_progress (bool, optional): Display a progress bar during data upload Defaults to True.</span>
<span class="sd">            return_paths (bool, optional): Return paths and success statuses of the uploaded files.</span>
<span class="sd">            multipart (bool, optional): Is multipart upload. Defaults to True.</span>
<span class="sd">            chunk_size (int, optional): Maximum chunk size.</span>
<span class="sd">            from_date (str, optional): start of the data date range contained in the distribution,</span>
<span class="sd">                defaults to upoad date</span>
<span class="sd">            to_date (str, optional): end of the data date range contained in the distribution,</span>
<span class="sd">                defaults to upload date.</span>
<span class="sd">            preserve_original_name (bool, optional): Preserve the original name of the file. Defaults to False.</span>
<span class="sd">                Original name not preserved when uploading a directory.</span>

<span class="sd">        Returns:</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The provided path does not exist&quot;</span><span class="p">)</span>

        <span class="n">fs_fusion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;directory&quot;</span><span class="p">:</span>
            <span class="n">validate_file_formats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dt_str</span> <span class="ow">and</span> <span class="n">dt_str</span> <span class="o">!=</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;`dt_str` is not considered when uploading a directory. &quot;</span>
                    <span class="s2">&quot;File names in the directory are used as series members instead.&quot;</span>
                <span class="p">)</span>

            <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="n">base_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
            <span class="c1"># Construct unique file names by flattening the relative path from the base directory.</span>
            <span class="c1"># For example, if the base directory is &#39;data_folder&#39; and a file is at &#39;data_folder/sub1/file.txt&#39;,</span>
            <span class="c1"># the resulting name will be &#39;data_folder__sub1__file.txt&#39;.</span>
            <span class="c1"># This ensures that files in different subdirectories with the same base name do not conflict</span>
            <span class="c1"># and helps preserve the folder structure in the filename.</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">base_path</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;__&quot;</span> <span class="o">+</span> <span class="s2">&quot;__&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_path_lst</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="n">catalog</span> <span class="ow">and</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="c1"># Construct URL mappings using the constructed file names as the series member</span>
                <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_name_to_url</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">is_download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># No catalog/dataset: validate file names and infer raw</span>
                <span class="n">local_file_validation</span> <span class="o">=</span> <span class="n">validate_file_names</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">)</span>
                <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">flag</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">local_file_validation</span><span class="p">,</span> <span class="n">file_path_lst</span><span class="p">)</span> <span class="k">if</span> <span class="n">flag</span><span class="p">]</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_path_lst</span><span class="p">]</span>
                <span class="n">is_raw_lst</span> <span class="o">=</span> <span class="n">is_dataset_raw</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">fs_fusion</span><span class="p">)</span>
                <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span><span class="n">path_to_url</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">is_raw_lst</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">catalog</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">local_file_validation</span> <span class="o">=</span> <span class="n">validate_file_names</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">)</span>
                <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">flag</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">local_file_validation</span><span class="p">,</span> <span class="n">file_path_lst</span><span class="p">)</span> <span class="k">if</span> <span class="n">flag</span><span class="p">]</span>
                <span class="n">is_raw_lst</span> <span class="o">=</span> <span class="n">is_dataset_raw</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">fs_fusion</span><span class="p">)</span>
                <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span><span class="n">path_to_url</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">is_raw_lst</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">preserve_original_name</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;preserve_original_name can only be used when catalog and dataset are provided.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Normalize the dt_str</span>
                <span class="n">date_identifier</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(\d</span><span class="si">{4}</span><span class="s2">)(\d</span><span class="si">{2}</span><span class="s2">)(\d</span><span class="si">{2}</span><span class="s2">)$&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
                    <span class="n">dt_str</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;today&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">date_identifier</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">dt_str</span><span class="p">):</span>
                    <span class="n">dt_str</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">dt_str</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">file_format</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">file_format</span> <span class="o">=</span> <span class="s2">&quot;raw&quot;</span> <span class="k">if</span> <span class="n">file_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RECOGNIZED_FORMATS</span> <span class="k">else</span> <span class="n">file_format</span>

                <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">distribution_to_url</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">file_format</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;directory&quot;</span> <span class="ow">or</span> <span class="n">preserve_original_name</span><span class="p">:</span>
            <span class="n">data_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">local_url_eqiv</span><span class="p">,</span> <span class="n">file_name</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="n">data_map_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">local_url_eqiv</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="n">data_map_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">])</span>

        <span class="n">n_par</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">upload_files</span><span class="p">(</span>
            <span class="n">fs_fusion</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
            <span class="n">data_map_df</span><span class="p">,</span>
            <span class="n">multipart</span><span class="o">=</span><span class="n">multipart</span><span class="p">,</span>
            <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
            <span class="n">from_date</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span>
            <span class="n">to_date</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span>
            <span class="n">additional_headers</span><span class="o">=</span><span class="n">additional_headers</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">):</span>
            <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Not all uploads were successfully completed. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span> <span class="k">if</span> <span class="n">return_paths</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">from_bytes</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">BytesIO</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">series_member</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">multipart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">from_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">to_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>  <span class="c1"># noqa: ARG002</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uploads data from an object in memory.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str): an object in memory to upload</span>
<span class="sd">            dataset (str): Dataset name to which the bytes will be uploaded.</span>
<span class="sd">            series_member (str, optional): A single date or label. Defaults to &#39;latest&#39; which will return</span>
<span class="sd">                the most recent.</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            distribution (str, optional): A distribution type, e.g. a file format or raw</span>
<span class="sd">            show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">            multipart (bool, optional): Is multipart upload.</span>
<span class="sd">            return_paths (bool, optional): Return paths and success statuses of the downloaded files.</span>
<span class="sd">            chunk_size (int, optional): Maximum chunk size.</span>
<span class="sd">            from_date (str, optional): start of the data date range contained in the distribution,</span>
<span class="sd">                defaults to upload date</span>
<span class="sd">            to_date (str, optional): end of the data date range contained in the distribution, defaults to upload date.</span>
<span class="sd">            file_name (str, optional): file name to be used for the uploaded file. Defaults to Fusion standard naming.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[list[tuple[bool, str, Optional[str]]]: a list of tuples, one for each distribution</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">fs_fusion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">distribution</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RECOGNIZED_FORMATS</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset format </span><span class="si">{</span><span class="n">distribution</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

        <span class="n">is_raw</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">fs_fusion</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))[</span><span class="s2">&quot;isRawData&quot;</span><span class="p">]</span>
        <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="n">path_to_url</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">series_member</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">distribution</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">is_raw</span><span class="p">)</span>

        <span class="n">data_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">local_url_eqiv</span><span class="p">,</span> <span class="n">file_name</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">data_map_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore[assignment]</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">upload_files</span><span class="p">(</span>
            <span class="n">fs_fusion</span><span class="p">,</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">data_map_df</span><span class="p">,</span>
            <span class="n">multipart</span><span class="o">=</span><span class="n">multipart</span><span class="p">,</span>
            <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
            <span class="n">from_date</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span>
            <span class="n">to_date</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">):</span>
            <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Not all uploads were successfully completed. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span> <span class="k">if</span> <span class="n">return_paths</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">listen_to_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">last_event_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run server sent event listener in the background. Retrieve results by running get_events.</span>

<span class="sd">        Args:</span>
<span class="sd">            last_event_id (str): Last event ID (exclusive).</span>
<span class="sd">            catalog (str): catalog.</span>
<span class="sd">            url (str): subscription url. Defaults to client&#39;s root url.</span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">url</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">aiohttp_sse_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">client</span> <span class="k">as</span> <span class="n">sse_client</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_client</span>

        <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">last_event_id</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Last-Event-ID&quot;</span><span class="p">:</span> <span class="n">last_event_id</span><span class="p">}}</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_events</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Events sync function.</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="mf">1e100</span>
            <span class="n">session</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">sse_client</span><span class="o">.</span><span class="n">EventSource</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/notifications/subscribe&quot;</span><span class="p">,</span>
                <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">messages</span><span class="p">:</span>
                <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                        <span class="n">event</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                        <span class="c1"># Preserve the original metaData column</span>
                        <span class="n">original_meta_data</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metaData&quot;</span><span class="p">,</span> <span class="p">{})</span>

                        <span class="c1"># Flatten the metaData dictionary into the event dictionary</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="n">event</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">)</span>
                        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst</span><span class="p">)],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                                <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
                            <span class="p">)</span>
                <span class="k">except</span> <span class="ne">TimeoutError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
                <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                    <span class="k">raise</span>

        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_resources</span><span class="p">()</span>  <span class="c1"># refresh token</span>
        <span class="k">if</span> <span class="s2">&quot;headers&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">bearer_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">bearer_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="s2">&quot;http&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;https&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">[</span><span class="s2">&quot;https&quot;</span><span class="p">]</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">async_events</span><span class="p">(),),</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">last_event_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">in_background</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run server sent event listener and print out the new events. Keyboard terminate to stop.</span>

<span class="sd">        Args:</span>
<span class="sd">            last_event_id (str): id of the last event.</span>
<span class="sd">            catalog (str): catalog.</span>
<span class="sd">            in_background (bool): execute event monitoring in the background (default = True).</span>
<span class="sd">            url (str): subscription url. Defaults to client&#39;s root url.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Union[None, class:`pandas.DataFrame`]: If in_background is True then the function returns no output.</span>
<span class="sd">                If in_background is set to False then pandas DataFrame is output upon keyboard termination.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">url</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_background</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">sseclient</span><span class="w"> </span><span class="kn">import</span> <span class="n">SSEClient</span>

            <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_resources</span><span class="p">()</span>  <span class="c1"># refresh token</span>
            <span class="n">interrupted</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">messages</span> <span class="o">=</span> <span class="n">SSEClient</span><span class="p">(</span>
                <span class="n">session</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/notifications/subscribe&quot;</span><span class="p">,</span>
                <span class="n">last_id</span><span class="o">=</span><span class="n">last_event_id</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">bearer_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">)</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                    <span class="n">event</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                    <span class="c1"># Preserve the original metaData column</span>
                    <span class="n">original_meta_data</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metaData&quot;</span><span class="p">,</span> <span class="p">{})</span>

                    <span class="c1"># Flatten the metaData dictionary into the event dictionary</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">event</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;HeartBeatNotification&quot;</span><span class="p">:</span>
                        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="n">interrupted</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="k">if</span> <span class="n">interrupted</span> <span class="ow">or</span> <span class="n">lst</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_dataset_lineage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the upstream and downstream lineage of the dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">            max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">                Defaults to -1 which returns all results.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each resource</span>

<span class="sd">        Raises:</span>
<span class="sd">            HTTPError: If the dataset is not found in the catalog.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/lineage&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="n">relations_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;relations&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">restricted_datasets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">dataset_metadata</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">dataset_metadata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;datasets&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">dataset_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Restricted&quot;</span>
        <span class="p">]</span>

        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">relations_data</span><span class="p">:</span>
            <span class="n">source_dataset_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span>
            <span class="n">source_catalog</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;catalog&quot;</span><span class="p">]</span>
            <span class="n">destination_dataset_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span>
            <span class="n">destination_catalog</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">][</span><span class="s2">&quot;catalog&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">destination_dataset_id</span> <span class="o">==</span> <span class="n">dataset_id</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;datasets&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Restricted&quot;</span><span class="p">:</span>
                        <span class="n">source_dataset_title</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Restricted&quot;</span><span class="p">:</span>
                        <span class="n">source_dataset_title</span> <span class="o">=</span> <span class="s2">&quot;Access Restricted&quot;</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">source_dataset_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                    <span class="n">source_catalog</span><span class="p">,</span>
                    <span class="n">source_dataset_title</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">source_dataset_id</span> <span class="o">==</span> <span class="n">dataset_id</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;datasets&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">destination_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Restricted&quot;</span><span class="p">:</span>
                        <span class="n">destination_dataset_title</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="p">(</span>
                        <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">destination_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Restricted&quot;</span>
                    <span class="p">):</span>
                        <span class="n">destination_dataset_title</span> <span class="o">=</span> <span class="s2">&quot;Access Restricted&quot;</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">destination_dataset_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;produced&quot;</span><span class="p">,</span>
                    <span class="n">destination_catalog</span><span class="p">,</span>
                    <span class="n">destination_dataset_title</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">output_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
            <span class="s2">&quot;dataset_identifier&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
            <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
        <span class="p">}</span>

        <span class="n">lineage_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
        <span class="n">lineage_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">lineage_df</span><span class="p">[</span><span class="s2">&quot;dataset_identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">restricted_datasets</span><span class="p">),</span>
            <span class="p">[</span><span class="s2">&quot;dataset_identifier&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">],</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Access Restricted&quot;</span>

        <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">lineage_df</span> <span class="o">=</span> <span class="n">lineage_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">lineage_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_dataset_lineage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">base_dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">source_dataset_catalog_mapping</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Upload lineage to a dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            base_dataset (str): A dataset identifier to which you want to add lineage.</span>
<span class="sd">            source_dataset_catalog_mapping (Union[pd.DataFrame, list[dict[str]]]): Mapping for the dataset</span>
<span class="sd">                identifier(s) and catalog(s) from which to add lineage.</span>
<span class="sd">            catalog (Optional[str], optional): Catalog identifier. Defaults to None.</span>
<span class="sd">            return_resp_obj (bool, optional): If True then return the response object. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If source_dataset_catalog_mapping is not a pandas DataFrame or a list of dictionaries</span>
<span class="sd">            HTTPError: If the request is unsuccessful.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Creating lineage from a pandas DataFrame.</span>
<span class="sd">            &gt;&gt;&gt; data = [{&quot;dataset&quot;: &quot;a&quot;, &quot;catalog&quot;: &quot;a&quot;}, {&quot;dataset&quot;: &quot;b&quot;, &quot;catalog&quot;: &quot;b&quot;}]</span>
<span class="sd">            &gt;&gt;&gt; df = pd.DataFrame(data)</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; fusion.create_dataset_lineage(base_dataset=&quot;c&quot;, source_dataset_catalog_mapping=df, catalog=&quot;c&quot;)</span>

<span class="sd">            Creating lineage from a list of dictionaries.</span>
<span class="sd">            &gt;&gt;&gt; data = [{&quot;dataset&quot;: &quot;a&quot;, &quot;catalog&quot;: &quot;a&quot;}, {&quot;dataset&quot;: &quot;b&quot;, &quot;catalog&quot;: &quot;b&quot;}]</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; fusion.create_dataset_lineage(base_dataset=&quot;c&quot;, source_dataset_catalog_mapping=data, catalog=&quot;c&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_dataset_catalog_mapping</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">dataset_mapping_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">],</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;catalog&quot;</span><span class="p">]}</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">source_dataset_catalog_mapping</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_dataset_catalog_mapping</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dataset_mapping_list</span> <span class="o">=</span> <span class="n">source_dataset_catalog_mapping</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;source_dataset_catalog_mapping must be a pandas DataFrame or a list of dictionaries.&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">dataset_mapping_list</span><span class="p">}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">base_dataset</span><span class="si">}</span><span class="s2">/lineage&quot;</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

        <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">resp</span> <span class="k">if</span> <span class="n">return_resp_obj</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_product_dataset_mapping</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get the product to dataset linking contained in  a catalog. A product is a grouping of datasets.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str | list[str] | None, optional): A string or list of strings that are dataset</span>
<span class="sd">            identifiers to filter the output. If a list is provided then it will return</span>
<span class="sd">            datasets whose identifier matches any of the strings. Defaults to None.</span>
<span class="sd">            product (str | list[str] | None, optional): A string or list of strings that are product</span>
<span class="sd">            identifiers to filter the output. If a list is provided then it will return</span>
<span class="sd">            products whose identifier matches any of the strings. Defaults to None.</span>
<span class="sd">            catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: a dataframe with a row  for each dataset to product mapping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/productDatasets&quot;</span>
        <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">dataset</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">)</span>
                <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">product</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">product</span><span class="p">)</span>
                <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">mapping_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">product</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">short_abstract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Global&quot;</span><span class="p">,</span>
        <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">release_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">logo</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Product</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a Product object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            identifier (str): Product identifier.</span>
<span class="sd">            title (str, optional): Product title. If not provided, defaults to identifier.</span>
<span class="sd">            category (str | list[str] | None, optional): Category. Defaults to None.</span>
<span class="sd">            short_abstract (str, optional): Short description. Defaults to &quot;&quot;.</span>
<span class="sd">            description (str, optional): Description. If not provided, defaults to identifier.</span>
<span class="sd">            is_active (bool, optional): Boolean for Active status. Defaults to True.</span>
<span class="sd">            is_restricted (bool | None, optional): Flag for restricted products. Defaults to None.</span>
<span class="sd">            maintainer (str | list[str] | None, optional): Product maintainer. Defaults to None.</span>
<span class="sd">            region (str | list[str] | None, optional): Product region. Defaults to None.</span>
<span class="sd">            publisher (str | None, optional): Name of vendor that publishes the data. Defaults to None.</span>
<span class="sd">            sub_category (str | list[str] | None, optional): Product sub-category. Defaults to None.</span>
<span class="sd">            tag (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">            delivery_channel (str | list[str], optional): Product delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">            theme (str | None, optional): Product theme. Defaults to None.</span>
<span class="sd">            release_date (str | None, optional): Product release date. Defaults to None.</span>
<span class="sd">            language (str, optional): Product language. Defaults to &quot;English&quot;.</span>
<span class="sd">            status (str, optional): Product status. Defaults to &quot;Available&quot;.</span>
<span class="sd">            image (str, optional): Product image. Defaults to &quot;&quot;.</span>
<span class="sd">            logo (str, optional): Product logo. Defaults to &quot;&quot;.</span>
<span class="sd">            dataset (str | list[str] | None, optional): Product datasets. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Product: Fusion Product class instance.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; fusion.product(identifier=&quot;PRODUCT_1&quot;, title=&quot;Product&quot;)</span>

<span class="sd">        Note:</span>
<span class="sd">            See the product module for more information on functionalities of product objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">product_obj</span> <span class="o">=</span> <span class="n">Product</span><span class="p">(</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">short_abstract</span><span class="o">=</span><span class="n">short_abstract</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
            <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
            <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
            <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
            <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
            <span class="n">release_date</span><span class="o">=</span><span class="n">release_date</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
            <span class="n">logo</span><span class="o">=</span><span class="n">logo</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">product_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">product_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dataset</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
        <span class="n">is_internal_only_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_third_party_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_raw_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan Fusion&quot;</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
        <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">created_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">modified_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
        <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span>
        <span class="n">container_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Snapshot-Full&quot;</span><span class="p">,</span>
        <span class="n">snowflake</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">complexity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_immutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_mnpi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_pci</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_pii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_client</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_internal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_highly_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">owners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a Dataset object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            identifier (str): Dataset identifier.</span>
<span class="sd">            title (str, optional): Dataset title. If not provided, defaults to identifier.</span>
<span class="sd">            category (str | list[str] | None, optional): A category or list of categories for the dataset.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">            description (str, optional): Dataset description. If not provided, defaults to identifier.</span>
<span class="sd">            frequency (str, optional): The frequency of the dataset. Defaults to &quot;Once&quot;.</span>
<span class="sd">            is_internal_only_dataset (bool, optional): Flag for internal datasets. Defaults to False.</span>
<span class="sd">            is_third_party_data (bool, optional): Flag for third party data. Defaults to True.</span>
<span class="sd">            is_restricted (bool | None, optional): Flag for restricted datasets. Defaults to None.</span>
<span class="sd">            is_raw_data (bool, optional): Flag for raw datasets. Defaults to True.</span>
<span class="sd">            maintainer (str | None, optional): Dataset maintainer. Defaults to &quot;J.P. Morgan Fusion&quot;.</span>
<span class="sd">            source (str | list[str] | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">            region (str | list[str] | None, optional): Region. Defaults to None.</span>
<span class="sd">            publisher (str, optional): Name of vendor that publishes the data. Defaults to &quot;J.P. Morgan&quot;.</span>
<span class="sd">            product (str | list[str] | None, optional): Product to associate dataset with. Defaults to None.</span>
<span class="sd">            sub_category (str | list[str] | None, optional): Sub-category. Defaults to None.</span>
<span class="sd">            tags (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">            created_date (str | None, optional): Created date. Defaults to None.</span>
<span class="sd">            modified_date (str | None, optional): Modified date. Defaults to None.</span>
<span class="sd">            delivery_channel (str | list[str], optional): Delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">            language (str, optional): Language. Defaults to &quot;English&quot;.</span>
<span class="sd">            status (str, optional): Status. Defaults to &quot;Available&quot;.</span>
<span class="sd">            type_ (str | None, optional): Dataset type. Defaults to &quot;Source&quot;.</span>
<span class="sd">            container_type (str | None, optional): Container type. Defaults to &quot;Snapshot-Full&quot;.</span>
<span class="sd">            snowflake (str | None, optional): Snowflake account connection. Defaults to None.</span>
<span class="sd">            complexity (str | None, optional): Complexity. Defaults to None.</span>
<span class="sd">            is_immutable (bool | None, optional): Flag for immutable datasets. Defaults to None.</span>
<span class="sd">            is_mnpi (bool | None, optional): is_mnpi. Defaults to None.</span>
<span class="sd">            is_pci (bool | None, optional): is_pci. Defaults to None.</span>
<span class="sd">            is_pii (bool | None, optional): is_pii. Defaults to None.</span>
<span class="sd">            is_client (bool | None, optional): is_client. Defaults to None.</span>
<span class="sd">            is_public (bool | None, optional): is_public. Defaults to None.</span>
<span class="sd">            is_internal (bool | None, optional): is_internal. Defaults to None.</span>
<span class="sd">            is_confidential (bool | None, optional): is_confidential. Defaults to None.</span>
<span class="sd">            is_highly_confidential (bool | None, optional): is_highly_confidential. Defaults to None.</span>
<span class="sd">            is_active (bool | None, optional): is_active. Defaults to None.</span>
<span class="sd">            owners (list[str] | None, optional): The owners of the dataset. Defaults to None.</span>
<span class="sd">            application_id (str | None, optional): The application ID of the dataset. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dataset: Fusion Dataset class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; dataset = fusion.dataset(identifier=&quot;DATASET_1&quot;)</span>

<span class="sd">        Note:</span>
<span class="sd">            See the dataset module for more information on functionalities of dataset objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dataset_obj</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
            <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="n">is_internal_only_dataset</span><span class="p">,</span>
            <span class="n">is_third_party_data</span><span class="o">=</span><span class="n">is_third_party_data</span><span class="p">,</span>
            <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
            <span class="n">is_raw_data</span><span class="o">=</span><span class="n">is_raw_data</span><span class="p">,</span>
            <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
            <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
            <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">created_date</span><span class="o">=</span><span class="n">created_date</span><span class="p">,</span>
            <span class="n">modified_date</span><span class="o">=</span><span class="n">modified_date</span><span class="p">,</span>
            <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
            <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
            <span class="n">container_type</span><span class="o">=</span><span class="n">container_type</span><span class="p">,</span>
            <span class="n">snowflake</span><span class="o">=</span><span class="n">snowflake</span><span class="p">,</span>
            <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
            <span class="n">is_immutable</span><span class="o">=</span><span class="n">is_immutable</span><span class="p">,</span>
            <span class="n">is_mnpi</span><span class="o">=</span><span class="n">is_mnpi</span><span class="p">,</span>
            <span class="n">is_pci</span><span class="o">=</span><span class="n">is_pci</span><span class="p">,</span>
            <span class="n">is_pii</span><span class="o">=</span><span class="n">is_pii</span><span class="p">,</span>
            <span class="n">is_client</span><span class="o">=</span><span class="n">is_client</span><span class="p">,</span>
            <span class="n">is_public</span><span class="o">=</span><span class="n">is_public</span><span class="p">,</span>
            <span class="n">is_internal</span><span class="o">=</span><span class="n">is_internal</span><span class="p">,</span>
            <span class="n">is_confidential</span><span class="o">=</span><span class="n">is_confidential</span><span class="p">,</span>
            <span class="n">is_highly_confidential</span><span class="o">=</span><span class="n">is_highly_confidential</span><span class="p">,</span>
            <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
            <span class="n">owners</span><span class="o">=</span><span class="n">owners</span><span class="p">,</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">dataset_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">dataset_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">attribute</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Types</span> <span class="o">=</span> <span class="s2">&quot;String&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">is_dataset_key</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source_field_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_internal_dataset_key</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_externally_visible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">unit</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">is_propagation_eligible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">available_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">deprecated_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">term</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bizterm1&quot;</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attribute_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Attribute</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate an Attribute object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            identifier (str): The unique identifier for the attribute.</span>
<span class="sd">            index (int): Attribute index.</span>
<span class="sd">            data_type (str | Types, optional): Datatype of attribute. Defaults to &quot;String&quot;.</span>
<span class="sd">            title (str, optional): Attribute title. If not provided, defaults to identifier.</span>
<span class="sd">            description (str, optional): Attribute description. If not provided, defaults to identifier.</span>
<span class="sd">            is_dataset_key (bool, optional): Flag for primary keys. Defaults to False.</span>
<span class="sd">            source (str | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">            source_field_id (str | None, optional): Original identifier of attribute, if attribute has been renamed.</span>
<span class="sd">                If not provided, defaults to identifier.</span>
<span class="sd">            is_internal_dataset_key (bool | None, optional): Flag for internal primary keys. Defaults to None.</span>
<span class="sd">            is_externally_visible (bool | None, optional): Flag for externally visible attributes. Defaults to True.</span>
<span class="sd">            unit (Any | None, optional): Unit of attribute. Defaults to None.</span>
<span class="sd">            multiplier (float, optional): Multiplier for unit. Defaults to 1.0.</span>
<span class="sd">            is_propagation_eligible (bool | None, optional): Flag for propagation eligibility. Defaults to None.</span>
<span class="sd">            is_metric (bool | None, optional): Flag for attributes that are metrics. Defaults to None.</span>
<span class="sd">            available_from (str | None, optional): Date from which the attribute is available. Defaults to None.</span>
<span class="sd">            deprecated_from (str | None, optional): Date from which the attribute is deprecated. Defaults to None.</span>
<span class="sd">            term (str, optional): Term. Defaults to &quot;bizterm1&quot;.</span>
<span class="sd">            dataset (int | None, optional): Dataset. Defaults to None.</span>
<span class="sd">            attribute_type (str | None, optional): Attribute type. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Attribute: Fusion Attribute class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; attr = fusion.attribute(identifier=&quot;attr1&quot;, index=0)</span>

<span class="sd">        Note:</span>
<span class="sd">            See the attributes module for more information on functionalities of attribute objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">Types</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()]</span>
        <span class="n">attribute_obj</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">is_dataset_key</span><span class="o">=</span><span class="n">is_dataset_key</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">source_field_id</span><span class="o">=</span><span class="n">source_field_id</span><span class="p">,</span>
            <span class="n">is_internal_dataset_key</span><span class="o">=</span><span class="n">is_internal_dataset_key</span><span class="p">,</span>
            <span class="n">is_externally_visible</span><span class="o">=</span><span class="n">is_externally_visible</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span>
            <span class="n">is_propagation_eligible</span><span class="o">=</span><span class="n">is_propagation_eligible</span><span class="p">,</span>
            <span class="n">is_metric</span><span class="o">=</span><span class="n">is_metric</span><span class="p">,</span>
            <span class="n">available_from</span><span class="o">=</span><span class="n">available_from</span><span class="p">,</span>
            <span class="n">deprecated_from</span><span class="o">=</span><span class="n">deprecated_from</span><span class="p">,</span>
            <span class="n">term</span><span class="o">=</span><span class="n">term</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
            <span class="n">attribute_type</span><span class="o">=</span><span class="n">attribute_type</span><span class="p">,</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">attribute_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">attribute_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Attribute</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Attributes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate an Attributes object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            attributes (list[Attribute] | None, optional): List of Attribute objects. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Attributes: Fusion Attributes class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; attr1 = fusion.attribute(&quot;attr1&quot;, 0)</span>
<span class="sd">            &gt;&gt;&gt; attr2 = fusion.attribute(&quot;attr2&quot;, 1)</span>
<span class="sd">            &gt;&gt;&gt; attrs = fusion.attributes([attr1, attr2])</span>

<span class="sd">        Note:</span>
<span class="sd">            See the attributes module for more information on functionalities of attributes object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attributes_obj</span> <span class="o">=</span> <span class="n">Attributes</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="n">attributes_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">attributes_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">report_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sourceIdentifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">technicalDataType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReportAttribute</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a ReportAttribute object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            title (str): The display title of the attribute (required).</span>
<span class="sd">            sourceIdentifier (str | None, optional): A unique identifier or reference ID from the source system.</span>
<span class="sd">            description (str | None, optional): A longer description of the attribute.</span>
<span class="sd">            technicalDataType (str | None, optional): The technical data type (e.g., string, int, boolean).</span>
<span class="sd">            path (str | None, optional): The hierarchical path or logical grouping for the attribute.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ReportAttribute: A single ReportAttribute instance with the client context attached.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; attr = fusion.report_attribute(</span>
<span class="sd">            ...     title=&quot;Customer ID&quot;,</span>
<span class="sd">            ...     sourceIdentifier=&quot;cust_id_123&quot;,</span>
<span class="sd">            ...     description=&quot;Unique customer identifier&quot;,</span>
<span class="sd">            ...     technicalDataType=&quot;String&quot;,</span>
<span class="sd">            ...     path=&quot;Customer.Details&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attribute_obj</span> <span class="o">=</span> <span class="n">ReportAttribute</span><span class="p">(</span>
            <span class="n">sourceIdentifier</span><span class="o">=</span><span class="n">sourceIdentifier</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">technicalDataType</span><span class="o">=</span><span class="n">technicalDataType</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">attribute_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">attribute_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">report_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ReportAttribute</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReportAttributes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a ReportAttributes collection with this client, allowing batch creation or manipulation.</span>

<span class="sd">        Args:</span>
<span class="sd">            attributes (list[ReportAttribute] | None, optional): A list of ReportAttribute objects to include.</span>
<span class="sd">                Defaults to an empty list if not provided.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ReportAttributes: A ReportAttributes collection object with the client context attached.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; attr1 = fusion.report_attribute(title=&quot;Code&quot;)</span>
<span class="sd">            &gt;&gt;&gt; attr2 = fusion.report_attribute(title=&quot;Label&quot;)</span>
<span class="sd">            &gt;&gt;&gt; attr_collection = fusion.report_attributes([attr1, attr2])</span>
<span class="sd">            &gt;&gt;&gt; attr_collection.create(report_id=&quot;abc-123&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attributes_obj</span> <span class="o">=</span> <span class="n">ReportAttributes</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="n">attributes_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">attributes_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReportsWrapper</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a ReportsWrapper collection with this client, providing access to</span>
<span class="sd">        report-related operations such as creation, retrieval, and bulk manipulation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ReportsWrapper: A ReportsWrapper collection object with the client context attached.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; reports = fusion.reports()</span>
<span class="sd">            &gt;&gt;&gt; new_report = reports.create(</span>
<span class="sd">            ...     title=&quot;Monthly Risk Report&quot;,</span>
<span class="sd">            ...     description=&quot;Summary of monthly risk metrics&quot;,</span>
<span class="sd">            ...     frequency=&quot;Monthly&quot;,</span>
<span class="sd">            ...     category=&quot;Risk&quot;,</span>
<span class="sd">            ...     sub_category=&quot;Credit Risk&quot;,</span>
<span class="sd">            ...     data_node_id={&quot;id&quot;: &quot;node123&quot;},</span>
<span class="sd">            ...     regulatory_related=True,</span>
<span class="sd">            ...     domain={&quot;id&quot;: &quot;domain123&quot;}</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ReportsWrapper</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_datasetmembers</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">series_members</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">requests</span><span class="o">.</span><span class="n">Response</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete dataset members.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            series_members (str | list[str]): A string or list of strings that are dataset series member</span>
<span class="sd">            identifiers to delete.</span>
<span class="sd">            catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            return_resp_obj (bool, optional): If True then return the response object. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[requests.Response]: a list of response objects.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Delete one dataset member.</span>

<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; fusion.delete_datasetmembers(dataset=&quot;dataset1&quot;, series_members=&quot;series1&quot;)</span>

<span class="sd">            Delete multiple dataset members.</span>

<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; fusion.delete_datasetmembers(dataset=&quot;dataset1&quot;, series_members=[&quot;series1&quot;, &quot;series2&quot;])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_members</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">series_members</span> <span class="o">=</span> <span class="p">[</span><span class="n">series_members</span><span class="p">]</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">series_member</span> <span class="ow">in</span> <span class="n">series_members</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries/</span><span class="si">{</span><span class="n">series_member</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
            <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">responses</span> <span class="k">if</span> <span class="n">return_resp_obj</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_all_datasetmembers</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete all dataset members within a dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (str): A dataset identifier</span>
<span class="sd">            catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            return_resp_obj (bool, optional): If True then return the response object. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[requests.Response]: a list of response objects.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; fusion.delete_all_datasetmembers(dataset=&quot;dataset1&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span> <span class="k">if</span> <span class="n">return_resp_obj</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the list of attributes in a catalog.</span>

<span class="sd">        Args:</span>
<span class="sd">            catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">            display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">                otherwise only the key columns are displayed</span>

<span class="sd">        Returns:</span>
<span class="sd">            class:`pandas.DataFrame`: A dataframe with a row for each attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/attributes&quot;</span>
        <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
            <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">ds_attr_df</span><span class="p">[</span>
                <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;dataType&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;publisher&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;applicationId&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">ds_attr_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">input_dataflow</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
        <span class="n">is_internal_only_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_third_party_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_raw_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan Fusion&quot;</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
        <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">created_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">modified_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
        <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Flow&quot;</span><span class="p">,</span>
        <span class="n">container_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Snapshot-Full&quot;</span><span class="p">,</span>
        <span class="n">snowflake</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">complexity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_immutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_mnpi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_pci</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_pii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_client</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_internal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_highly_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">owners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">producer_application_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">consumer_application_id</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">flow_details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InputDataFlow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate an Input Dataflow object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            identifier (str): Dataset identifier.</span>
<span class="sd">            title (str, optional): Dataset title. If not provided, defaults to identifier.</span>
<span class="sd">            category (str | list[str] | None, optional): A category or list of categories for the dataset.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">            description (str, optional): Dataset description. If not provided, defaults to identifier.</span>
<span class="sd">            frequency (str, optional): The frequency of the dataset. Defaults to &quot;Once&quot;.</span>
<span class="sd">            is_internal_only_dataset (bool, optional): Flag for internal datasets. Defaults to False.</span>
<span class="sd">            is_third_party_data (bool, optional): Flag for third party data. Defaults to True.</span>
<span class="sd">            is_restricted (bool | None, optional): Flag for restricted datasets. Defaults to None.</span>
<span class="sd">            is_raw_data (bool, optional): Flag for raw datasets. Defaults to True.</span>
<span class="sd">            maintainer (str | None, optional): Dataset maintainer. Defaults to &quot;J.P. Morgan Fusion&quot;.</span>
<span class="sd">            source (str | list[str] | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">            region (str | list[str] | None, optional): Region. Defaults to None.</span>
<span class="sd">            publisher (str, optional): Name of vendor that publishes the data. Defaults to &quot;J.P. Morgan&quot;.</span>
<span class="sd">            product (str | list[str] | None, optional): Product to associate dataset with. Defaults to None.</span>
<span class="sd">            sub_category (str | list[str] | None, optional): Sub-category. Defaults to None.</span>
<span class="sd">            tags (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">            created_date (str | None, optional): Created date. Defaults to None.</span>
<span class="sd">            modified_date (str | None, optional): Modified date. Defaults to None.</span>
<span class="sd">            delivery_channel (str | list[str], optional): Delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">            language (str, optional): Language. Defaults to &quot;English&quot;.</span>
<span class="sd">            status (str, optional): Status. Defaults to &quot;Available&quot;.</span>
<span class="sd">            type_ (str | None, optional): Dataset type. Defaults to &quot;Flow&quot;.</span>
<span class="sd">            container_type (str | None, optional): Container type. Defaults to &quot;Snapshot-Full&quot;.</span>
<span class="sd">            snowflake (str | None, optional): Snowflake account connection. Defaults to None.</span>
<span class="sd">            complexity (str | None, optional): Complexity. Defaults to None.</span>
<span class="sd">            is_immutable (bool | None, optional): Flag for immutable datasets. Defaults to None.</span>
<span class="sd">            is_mnpi (bool | None, optional): is_mnpi. Defaults to None.</span>
<span class="sd">            is_pci (bool | None, optional): is_pci. Defaults to None.</span>
<span class="sd">            is_pii (bool | None, optional): is_pii. Defaults to None.</span>
<span class="sd">            is_client (bool | None, optional): is_client. Defaults to None.</span>
<span class="sd">            is_public (bool | None, optional): is_public. Defaults to None.</span>
<span class="sd">            is_internal (bool | None, optional): is_internal. Defaults to None.</span>
<span class="sd">            is_confidential (bool | None, optional): is_confidential. Defaults to None.</span>
<span class="sd">            is_highly_confidential (bool | None, optional): is_highly_confidential. Defaults to None.</span>
<span class="sd">            is_active (bool | None, optional): is_active. Defaults to None.</span>
<span class="sd">            owners (list[str] | None, optional): The owners of the dataset. Defaults to None.</span>
<span class="sd">            application_id (str | None, optional): The application ID of the dataset. Defaults to None.</span>
<span class="sd">            producer_application_id (dict[str, str] | None, optional): The producer application ID (upstream application</span>
<span class="sd">                producing the flow).</span>
<span class="sd">            consumer_application_id (list[dict[str, str]] | dict[str, str] | None, optional): The consumer application</span>
<span class="sd">                ID (downstream application, consuming the flow).</span>
<span class="sd">            flow_details (dict[str, str] | None, optional): The flow details. Specifies input versus output flow.</span>
<span class="sd">                Defaults to {&quot;flowDirection&quot;: &quot;Input&quot;}.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dataset: Fusion InputDataFlow class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; dataset = fusion.input_dataflow(identifier=&quot;MY_DATAFLOW&quot;)</span>

<span class="sd">        Note:</span>
<span class="sd">            See the dataset module for more information on functionalities of input dataflow objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flow_details</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;flowDirection&quot;</span><span class="p">:</span> <span class="s2">&quot;Input&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="n">flow_details</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">flow_details</span>
        <span class="n">dataflow_obj</span> <span class="o">=</span> <span class="n">InputDataFlow</span><span class="p">(</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
            <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="n">is_internal_only_dataset</span><span class="p">,</span>
            <span class="n">is_third_party_data</span><span class="o">=</span><span class="n">is_third_party_data</span><span class="p">,</span>
            <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
            <span class="n">is_raw_data</span><span class="o">=</span><span class="n">is_raw_data</span><span class="p">,</span>
            <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
            <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
            <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">created_date</span><span class="o">=</span><span class="n">created_date</span><span class="p">,</span>
            <span class="n">modified_date</span><span class="o">=</span><span class="n">modified_date</span><span class="p">,</span>
            <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
            <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
            <span class="n">container_type</span><span class="o">=</span><span class="n">container_type</span><span class="p">,</span>
            <span class="n">snowflake</span><span class="o">=</span><span class="n">snowflake</span><span class="p">,</span>
            <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
            <span class="n">is_immutable</span><span class="o">=</span><span class="n">is_immutable</span><span class="p">,</span>
            <span class="n">is_mnpi</span><span class="o">=</span><span class="n">is_mnpi</span><span class="p">,</span>
            <span class="n">is_pci</span><span class="o">=</span><span class="n">is_pci</span><span class="p">,</span>
            <span class="n">is_pii</span><span class="o">=</span><span class="n">is_pii</span><span class="p">,</span>
            <span class="n">is_client</span><span class="o">=</span><span class="n">is_client</span><span class="p">,</span>
            <span class="n">is_public</span><span class="o">=</span><span class="n">is_public</span><span class="p">,</span>
            <span class="n">is_internal</span><span class="o">=</span><span class="n">is_internal</span><span class="p">,</span>
            <span class="n">is_confidential</span><span class="o">=</span><span class="n">is_confidential</span><span class="p">,</span>
            <span class="n">is_highly_confidential</span><span class="o">=</span><span class="n">is_highly_confidential</span><span class="p">,</span>
            <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
            <span class="n">owners</span><span class="o">=</span><span class="n">owners</span><span class="p">,</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
            <span class="n">producer_application_id</span><span class="o">=</span><span class="n">producer_application_id</span><span class="p">,</span>
            <span class="n">consumer_application_id</span><span class="o">=</span><span class="n">consumer_application_id</span><span class="p">,</span>
            <span class="n">flow_details</span><span class="o">=</span><span class="n">flow_details</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">dataflow_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">dataflow_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">output_dataflow</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
        <span class="n">is_internal_only_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_third_party_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_raw_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan Fusion&quot;</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
        <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">created_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">modified_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
        <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Flow&quot;</span><span class="p">,</span>
        <span class="n">container_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Snapshot-Full&quot;</span><span class="p">,</span>
        <span class="n">snowflake</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">complexity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_immutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_mnpi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_pci</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_pii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_client</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_internal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_highly_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">owners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">producer_application_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">consumer_application_id</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">flow_details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OutputDataFlow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate an Output Dataflow object with this client for metadata creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            identifier (str): Dataset identifier.</span>
<span class="sd">            title (str, optional): Dataset title. If not provided, defaults to identifier.</span>
<span class="sd">            category (str | list[str] | None, optional): A category or list of categories for the dataset.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">            description (str, optional): Dataset description. If not provided, defaults to identifier.</span>
<span class="sd">            frequency (str, optional): The frequency of the dataset. Defaults to &quot;Once&quot;.</span>
<span class="sd">            is_internal_only_dataset (bool, optional): Flag for internal datasets. Defaults to False.</span>
<span class="sd">            is_third_party_data (bool, optional): Flag for third party data. Defaults to True.</span>
<span class="sd">            is_restricted (bool | None, optional): Flag for restricted datasets. Defaults to None.</span>
<span class="sd">            is_raw_data (bool, optional): Flag for raw datasets. Defaults to True.</span>
<span class="sd">            maintainer (str | None, optional): Dataset maintainer. Defaults to &quot;J.P. Morgan Fusion&quot;.</span>
<span class="sd">            source (str | list[str] | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">            region (str | list[str] | None, optional): Region. Defaults to None.</span>
<span class="sd">            publisher (str, optional): Name of vendor that publishes the data. Defaults to &quot;J.P. Morgan&quot;.</span>
<span class="sd">            product (str | list[str] | None, optional): Product to associate dataset with. Defaults to None.</span>
<span class="sd">            sub_category (str | list[str] | None, optional): Sub-category. Defaults to None.</span>
<span class="sd">            tags (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">            created_date (str | None, optional): Created date. Defaults to None.</span>
<span class="sd">            modified_date (str | None, optional): Modified date. Defaults to None.</span>
<span class="sd">            delivery_channel (str | list[str], optional): Delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">            language (str, optional): Language. Defaults to &quot;English&quot;.</span>
<span class="sd">            status (str, optional): Status. Defaults to &quot;Available&quot;.</span>
<span class="sd">            type_ (str | None, optional): Dataset type. Defaults to &quot;Flow&quot;.</span>
<span class="sd">            container_type (str | None, optional): Container type. Defaults to &quot;Snapshot-Full&quot;.</span>
<span class="sd">            snowflake (str | None, optional): Snowflake account connection. Defaults to None.</span>
<span class="sd">            complexity (str | None, optional): Complexity. Defaults to None.</span>
<span class="sd">            is_immutable (bool | None, optional): Flag for immutable datasets. Defaults to None.</span>
<span class="sd">            is_mnpi (bool | None, optional): is_mnpi. Defaults to None.</span>
<span class="sd">            is_pci (bool | None, optional): is_pci. Defaults to None.</span>
<span class="sd">            is_pii (bool | None, optional): is_pii. Defaults to None.</span>
<span class="sd">            is_client (bool | None, optional): is_client. Defaults to None.</span>
<span class="sd">            is_public (bool | None, optional): is_public. Defaults to None.</span>
<span class="sd">            is_internal (bool | None, optional): is_internal. Defaults to None.</span>
<span class="sd">            is_confidential (bool | None, optional): is_confidential. Defaults to None.</span>
<span class="sd">            is_highly_confidential (bool | None, optional): is_highly_confidential. Defaults to None.</span>
<span class="sd">            is_active (bool | None, optional): is_active. Defaults to None.</span>
<span class="sd">            owners (list[str] | None, optional): The owners of the dataset. Defaults to None.</span>
<span class="sd">            application_id (str | None, optional): The application ID of the dataset. Defaults to None.</span>
<span class="sd">            producer_application_id (dict[str, str] | None, optional): The producer application ID (upstream application</span>
<span class="sd">                producing the flow).</span>
<span class="sd">            consumer_application_id (list[dict[str, str]] | dict[str, str] | None, optional): The consumer application</span>
<span class="sd">                ID (downstream application, consuming the flow).</span>
<span class="sd">            flow_details (dict[str, str] | None, optional): The flow details. Specifies input versus output flow.</span>
<span class="sd">                Defaults to {&quot;flowDirection&quot;: &quot;Output&quot;}.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dataset: Fusion OutputDataFlow class.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">            &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">            &gt;&gt;&gt; dataset = fusion.output_dataflow(identifier=&quot;MY_DATAFLOW&quot;)</span>

<span class="sd">        Note:</span>
<span class="sd">            See the dataset module for more information on functionalities of output dataflow objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flow_details</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;flowDirection&quot;</span><span class="p">:</span> <span class="s2">&quot;Output&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="n">flow_details</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">flow_details</span>
        <span class="n">dataflow_obj</span> <span class="o">=</span> <span class="n">OutputDataFlow</span><span class="p">(</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
            <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="n">is_internal_only_dataset</span><span class="p">,</span>
            <span class="n">is_third_party_data</span><span class="o">=</span><span class="n">is_third_party_data</span><span class="p">,</span>
            <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
            <span class="n">is_raw_data</span><span class="o">=</span><span class="n">is_raw_data</span><span class="p">,</span>
            <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
            <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
            <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">created_date</span><span class="o">=</span><span class="n">created_date</span><span class="p">,</span>
            <span class="n">modified_date</span><span class="o">=</span><span class="n">modified_date</span><span class="p">,</span>
            <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
            <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
            <span class="n">container_type</span><span class="o">=</span><span class="n">container_type</span><span class="p">,</span>
            <span class="n">snowflake</span><span class="o">=</span><span class="n">snowflake</span><span class="p">,</span>
            <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
            <span class="n">is_immutable</span><span class="o">=</span><span class="n">is_immutable</span><span class="p">,</span>
            <span class="n">is_mnpi</span><span class="o">=</span><span class="n">is_mnpi</span><span class="p">,</span>
            <span class="n">is_pci</span><span class="o">=</span><span class="n">is_pci</span><span class="p">,</span>
            <span class="n">is_pii</span><span class="o">=</span><span class="n">is_pii</span><span class="p">,</span>
            <span class="n">is_client</span><span class="o">=</span><span class="n">is_client</span><span class="p">,</span>
            <span class="n">is_public</span><span class="o">=</span><span class="n">is_public</span><span class="p">,</span>
            <span class="n">is_internal</span><span class="o">=</span><span class="n">is_internal</span><span class="p">,</span>
            <span class="n">is_confidential</span><span class="o">=</span><span class="n">is_confidential</span><span class="p">,</span>
            <span class="n">is_highly_confidential</span><span class="o">=</span><span class="n">is_highly_confidential</span><span class="p">,</span>
            <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
            <span class="n">owners</span><span class="o">=</span><span class="n">owners</span><span class="p">,</span>
            <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
            <span class="n">producer_application_id</span><span class="o">=</span><span class="n">producer_application_id</span><span class="p">,</span>
            <span class="n">consumer_application_id</span><span class="o">=</span><span class="n">consumer_application_id</span><span class="p">,</span>
            <span class="n">flow_details</span><span class="o">=</span><span class="n">flow_details</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">dataflow_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">dataflow_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_indexes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">knowledge_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_details</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the indexes in a knowledge base.</span>

<span class="sd">        Args:</span>
<span class="sd">            knowledge_base (str): Knowledge base (dataset) identifier.</span>
<span class="sd">            catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">            show_details (bool | None, optional): If True then show detailed information. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: a dataframe with a column for each index.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">dataspaces/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">knowledge_base</span><span class="si">}</span><span class="s2">/indexes/&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_details</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_format_full_index_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_format_summary_index_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_fusion_vector_store_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">knowledge_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpenSearch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns Fusion Embeddings Search client.</span>

<span class="sd">        Args:</span>
<span class="sd">            knowledge_base (str): Knowledge base (dataset) identifier.</span>
<span class="sd">            catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            OpenSearch: Fusion Embeddings Search client.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">opensearchpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenSearch</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">fusion.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">FusionEmbeddingsConnection</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">OpenSearch</span><span class="p">(</span>
            <span class="n">connection_class</span><span class="o">=</span><span class="n">FusionEmbeddingsConnection</span><span class="p">,</span>
            <span class="n">catalog</span><span class="o">=</span><span class="n">catalog</span><span class="p">,</span>
            <span class="n">knowledge_base</span><span class="o">=</span><span class="n">knowledge_base</span><span class="p">,</span>
            <span class="n">root_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_async_fusion_vector_store_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">knowledge_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncOpenSearch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns Fusion Embeddings Search client.</span>

<span class="sd">        Args:</span>
<span class="sd">            knowledge_base (str): Knowledge base (dataset) identifier.</span>
<span class="sd">            catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            OpenSearch: Fusion Embeddings Search client.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">opensearchpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncOpenSearch</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">fusion.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">FusionAsyncHttpConnection</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AsyncOpenSearch</span><span class="p">(</span>
            <span class="n">connection_class</span><span class="o">=</span><span class="n">FusionAsyncHttpConnection</span><span class="p">,</span>
            <span class="n">catalog</span><span class="o">=</span><span class="n">catalog</span><span class="p">,</span>
            <span class="n">knowledge_base</span><span class="o">=</span><span class="n">knowledge_base</span><span class="p">,</span>
            <span class="n">root_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_datasetmembers_distributions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the distributions of dataset members.</span>

<span class="sd">                Args:</span>
<span class="sd">                    dataset (str): Dataset identifier.</span>
<span class="sd">                    catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">                    output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        F</span>
<span class="sd">                Returns:</span>
<span class="sd">                    pd.DataFrame: A dataframe with a row for each dataset member distribution.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/changes?datasets=</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

        <span class="n">datasets</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datasets&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="n">dists</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;distributions&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">MEMBER_FORMAT_INDEX</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Index for member_format in values list</span>
        <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">dists</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">values</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MEMBER_FORMAT_INDEX</span><span class="p">:</span>
                <span class="n">member_id</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">member_format</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">MEMBER_FORMAT_INDEX</span><span class="p">]</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">member_id</span><span class="p">,</span> <span class="n">member_format</span><span class="p">))</span>

        <span class="n">members_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">members_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">data_node_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">regulatory_related</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">domain</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">tier_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">alternative_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sub_lob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_bcbs239_program</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">risk_area</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">risk_stripe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sap_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Report</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a Report object with the current Fusion client attached.</span>

<span class="sd">        Args:</span>
<span class="sd">            description (str): Description of the report.</span>
<span class="sd">            title (str): Title of the report or process.</span>
<span class="sd">            frequency (str): Reporting frequency (e.g., Monthly, Quarterly).</span>
<span class="sd">            category (str): Main classification of the report.</span>
<span class="sd">            sub_category (str): Sub-classification under the main category.</span>
<span class="sd">            data_node_id (dict[str, str]): Associated data node details. Should include &quot;name&quot; and &quot;dataNodeType&quot;.</span>
<span class="sd">            regulatory_related (bool): Whether the report is regulatory-designated. This is a required field.</span>
<span class="sd">            tier_type (str, optional): Tier classification (e.g., &quot;Tier 1&quot;, &quot;Non Tier 1&quot;).</span>
<span class="sd">            lob (str, optional): Line of business.</span>
<span class="sd">            alternative_id (dict[str, str], optional): Alternate identifiers for the report.</span>
<span class="sd">            sub_lob (str, optional): Subdivision of the line of business.</span>
<span class="sd">            is_bcbs239_program (bool, optional): Whether the report is part of the BCBS 239 program.</span>
<span class="sd">            risk_area (str, optional): Risk area covered by the report.</span>
<span class="sd">            risk_stripe (str, optional): Stripe or classification under the risk area.</span>
<span class="sd">            sap_code (str, optional): SAP financial tracking code.</span>
<span class="sd">            domain (dict[str, str | bool], optional): Domain details. Typically contains a &quot;name&quot; key.</span>
<span class="sd">            **kwargs (Any): Additional optional fields such as:</span>
<span class="sd">                - tier_designation (str)</span>
<span class="sd">                - region (str)</span>
<span class="sd">                - mnpi_indicator (bool)</span>
<span class="sd">                - country_of_reporting_obligation (str)</span>
<span class="sd">                - primary_regulator (str)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Report: A Report object ready for API upload or further manipulation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">report_obj</span> <span class="o">=</span> <span class="n">Report</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
            <span class="n">data_node_id</span><span class="o">=</span><span class="n">data_node_id</span><span class="p">,</span>
            <span class="n">regulatory_related</span><span class="o">=</span><span class="n">regulatory_related</span><span class="p">,</span>
            <span class="n">tier_type</span><span class="o">=</span><span class="n">tier_type</span><span class="p">,</span>
            <span class="n">lob</span><span class="o">=</span><span class="n">lob</span><span class="p">,</span>
            <span class="n">alternative_id</span><span class="o">=</span><span class="n">alternative_id</span><span class="p">,</span>
            <span class="n">sub_lob</span><span class="o">=</span><span class="n">sub_lob</span><span class="p">,</span>
            <span class="n">is_bcbs239_program</span><span class="o">=</span><span class="n">is_bcbs239_program</span><span class="p">,</span>
            <span class="n">risk_area</span><span class="o">=</span><span class="n">risk_area</span><span class="p">,</span>
            <span class="n">risk_stripe</span><span class="o">=</span><span class="n">risk_stripe</span><span class="p">,</span>
            <span class="n">sap_code</span><span class="o">=</span><span class="n">sap_code</span><span class="p">,</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">report_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">report_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">link_attributes_to_terms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">report_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">mappings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Report</span><span class="o">.</span><span class="n">AttributeTermMapping</span><span class="p">],</span>
        <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Link one or more report attributes to business glossary terms.</span>

<span class="sd">        Each mapping should follow this format:</span>
<span class="sd">            {</span>
<span class="sd">                &quot;attribute&quot;: {&quot;id&quot;: &quot;attribute-id&quot;},</span>
<span class="sd">                &quot;term&quot;: {&quot;id&quot;: &quot;term-id&quot;},</span>
<span class="sd">                &quot;isKDE&quot;: True  # Optional; defaults to True if not provided</span>
<span class="sd">            }</span>

<span class="sd">        This method wraps `Report.link_attributes_to_terms` and automatically attaches the Fusion client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">processed_mappings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mapping</span> <span class="ow">in</span> <span class="n">mappings</span><span class="p">:</span>
            <span class="n">new_mapping</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;isKDE&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_mapping</span><span class="p">:</span>
                <span class="n">new_mapping</span><span class="p">[</span><span class="s2">&quot;isKDE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">processed_mappings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_mapping</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Report</span><span class="o">.</span><span class="n">link_attributes_to_terms</span><span class="p">(</span>
            <span class="n">report_id</span><span class="o">=</span><span class="n">report_id</span><span class="p">,</span> <span class="n">mappings</span><span class="o">=</span><span class="n">processed_mappings</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_resp_obj</span><span class="o">=</span><span class="n">return_resp_obj</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="fusion.fusion.Fusion.default_catalog" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">default_catalog</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#fusion.fusion.Fusion.default_catalog" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the default catalog.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="s1">&#39;config/client_credentials.json&#39;</span><span class="p">,</span> <span class="n">root_url</span><span class="o">=</span><span class="s1">&#39;https://fusion.jpmorgan.com/api/v1/&#39;</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="s1">&#39;downloads&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">enable_logging</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Constructor to instantiate a new Fusion object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>credentials</code>
            </td>
            <td>
                  <code>Union[str, <span title="fusion._fusion.FusionCredentials">FusionCredentials</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A path to a credentials file or a fully populated</p>
              </div>
            </td>
            <td>
                  <code>&#39;config/client_credentials.json&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>root_url</code>
            </td>
            <td>
                  <code>_type_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API root URL.
Defaults to "https://fusion.jpmorgan.com/api/v1/".</p>
              </div>
            </td>
            <td>
                  <code>&#39;https://fusion.jpmorgan.com/api/v1/&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>download_folder</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The folder path where downloaded data files
are saved. Defaults to "downloads".</p>
              </div>
            </td>
            <td>
                  <code>&#39;downloads&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_level</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set the logging level. Defaults to logging.ERROR.</p>
              </div>
            </td>
            <td>
                  <code><span title="logging.ERROR">ERROR</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fs</code>
            </td>
            <td>
                  <code><span title="fsspec.filesystem">filesystem</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filesystem.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The folder path where the log is stored.</p>
              </div>
            </td>
            <td>
                  <code>&#39;.&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_logging</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, enables logging to a file in addition to stdout.
If False, logging is only directed to stdout. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">FusionCredentials</span> <span class="o">=</span> <span class="s2">&quot;config/client_credentials.json&quot;</span><span class="p">,</span>
    <span class="n">root_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://fusion.jpmorgan.com/api/v1/&quot;</span><span class="p">,</span>
    <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;downloads&quot;</span><span class="p">,</span>
    <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
    <span class="n">fs</span><span class="p">:</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">filesystem</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">enable_logging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor to instantiate a new Fusion object.</span>

<span class="sd">    Args:</span>
<span class="sd">        credentials (Union[str, FusionCredentials]): A path to a credentials file or a fully populated</span>
<span class="sd">        FusionCredentials object. Defaults to &#39;config/client_credentials.json&#39;.</span>
<span class="sd">        root_url (_type_, optional): The API root URL.</span>
<span class="sd">            Defaults to &quot;https://fusion.jpmorgan.com/api/v1/&quot;.</span>
<span class="sd">        download_folder (str, optional): The folder path where downloaded data files</span>
<span class="sd">            are saved. Defaults to &quot;downloads&quot;.</span>
<span class="sd">        log_level (int, optional): Set the logging level. Defaults to logging.ERROR.</span>
<span class="sd">        fs (fsspec.filesystem): filesystem.</span>
<span class="sd">        log_path (str, optional): The folder path where the log is stored.</span>
<span class="sd">        enable_logging (bool, optional): If True, enables logging to a file in addition to stdout.</span>
<span class="sd">            If False, logging is only directed to stdout. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_default_catalog</span> <span class="o">=</span> <span class="s2">&quot;common&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="o">=</span> <span class="n">root_url</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span> <span class="o">=</span> <span class="n">download_folder</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">download_folder</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="n">VERBOSE_LVL</span><span class="p">,</span> <span class="s2">&quot;VERBOSE&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>

    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2">.</span><span class="si">%(msecs)03d</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2">:</span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">enable_logging</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">):</span>
        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">/fusion_sdk.log&quot;</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">):</span>
        <span class="n">stdout_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
        <span class="n">stdout_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">stdout_handler</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="n">FusionCredentials</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span> <span class="o">=</span> <span class="n">credentials</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span> <span class="o">=</span> <span class="n">FusionCredentials</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">credentials</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">CredentialError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;status_code&quot;</span><span class="p">):</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Failed to load credentials. Please check the credentials file.&quot;</span>
                <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;credentials must be a path to a credentials file or FusionCredentials object&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">get_session</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span> <span class="k">if</span> <span class="n">fs</span> <span class="k">else</span> <span class="n">get_default_fs</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#fusion.fusion.Fusion.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Object representation to list all available methods.</p>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Object representation to list all available methods.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;Fusion object </span><span class="se">\n</span><span class="s2">Available methods:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">tabulate</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="n">method_name</span>
                    <span class="k">for</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">method_name</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">method_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="nb">property</span><span class="p">)],</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">method_name</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">method_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="o">+</span> <span class="p">[</span>
                    <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Fusion</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Fusion</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="nb">property</span><span class="p">)</span>
                <span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.attribute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">attribute</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;String&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">is_dataset_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_field_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_internal_dataset_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_externally_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">is_propagation_eligible</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">available_from</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deprecated_from</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">term</span><span class="o">=</span><span class="s1">&#39;bizterm1&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribute_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.attribute" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate an Attribute object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifier</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique identifier for the attribute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Attribute index.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_type</code>
            </td>
            <td>
                  <code>str | <span title="fusion.fusion_types.Types">Types</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datatype of attribute. Defaults to "String".</p>
              </div>
            </td>
            <td>
                  <code>&#39;String&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Attribute title. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Attribute description. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_dataset_key</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for primary keys. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of data vendor which provided the data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_field_id</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original identifier of attribute, if attribute has been renamed.
If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal_dataset_key</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for internal primary keys. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_externally_visible</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for externally visible attributes. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit of attribute. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multiplier</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier for unit. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_propagation_eligible</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for propagation eligibility. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_metric</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for attributes that are metrics. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>available_from</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date from which the attribute is available. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deprecated_from</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date from which the attribute is deprecated. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>term</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Term. Defaults to "bizterm1".</p>
              </div>
            </td>
            <td>
                  <code>&#39;bizterm1&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>int | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attribute_type</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Attribute type. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Attribute</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="fusion.attributes.Attribute" href="../attributes/#fusion.attributes.Attribute">Attribute</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion Attribute class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attr</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;attr1&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>See the attributes module for more information on functionalities of attribute objects.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">attribute</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Types</span> <span class="o">=</span> <span class="s2">&quot;String&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">is_dataset_key</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source_field_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_internal_dataset_key</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_externally_visible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">unit</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">is_propagation_eligible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">available_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">deprecated_from</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">term</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bizterm1&quot;</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">attribute_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Attribute</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate an Attribute object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier (str): The unique identifier for the attribute.</span>
<span class="sd">        index (int): Attribute index.</span>
<span class="sd">        data_type (str | Types, optional): Datatype of attribute. Defaults to &quot;String&quot;.</span>
<span class="sd">        title (str, optional): Attribute title. If not provided, defaults to identifier.</span>
<span class="sd">        description (str, optional): Attribute description. If not provided, defaults to identifier.</span>
<span class="sd">        is_dataset_key (bool, optional): Flag for primary keys. Defaults to False.</span>
<span class="sd">        source (str | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">        source_field_id (str | None, optional): Original identifier of attribute, if attribute has been renamed.</span>
<span class="sd">            If not provided, defaults to identifier.</span>
<span class="sd">        is_internal_dataset_key (bool | None, optional): Flag for internal primary keys. Defaults to None.</span>
<span class="sd">        is_externally_visible (bool | None, optional): Flag for externally visible attributes. Defaults to True.</span>
<span class="sd">        unit (Any | None, optional): Unit of attribute. Defaults to None.</span>
<span class="sd">        multiplier (float, optional): Multiplier for unit. Defaults to 1.0.</span>
<span class="sd">        is_propagation_eligible (bool | None, optional): Flag for propagation eligibility. Defaults to None.</span>
<span class="sd">        is_metric (bool | None, optional): Flag for attributes that are metrics. Defaults to None.</span>
<span class="sd">        available_from (str | None, optional): Date from which the attribute is available. Defaults to None.</span>
<span class="sd">        deprecated_from (str | None, optional): Date from which the attribute is deprecated. Defaults to None.</span>
<span class="sd">        term (str, optional): Term. Defaults to &quot;bizterm1&quot;.</span>
<span class="sd">        dataset (int | None, optional): Dataset. Defaults to None.</span>
<span class="sd">        attribute_type (str | None, optional): Attribute type. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Attribute: Fusion Attribute class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; attr = fusion.attribute(identifier=&quot;attr1&quot;, index=0)</span>

<span class="sd">    Note:</span>
<span class="sd">        See the attributes module for more information on functionalities of attribute objects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="n">Types</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()]</span>
    <span class="n">attribute_obj</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">is_dataset_key</span><span class="o">=</span><span class="n">is_dataset_key</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">source_field_id</span><span class="o">=</span><span class="n">source_field_id</span><span class="p">,</span>
        <span class="n">is_internal_dataset_key</span><span class="o">=</span><span class="n">is_internal_dataset_key</span><span class="p">,</span>
        <span class="n">is_externally_visible</span><span class="o">=</span><span class="n">is_externally_visible</span><span class="p">,</span>
        <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span>
        <span class="n">is_propagation_eligible</span><span class="o">=</span><span class="n">is_propagation_eligible</span><span class="p">,</span>
        <span class="n">is_metric</span><span class="o">=</span><span class="n">is_metric</span><span class="p">,</span>
        <span class="n">available_from</span><span class="o">=</span><span class="n">available_from</span><span class="p">,</span>
        <span class="n">deprecated_from</span><span class="o">=</span><span class="n">deprecated_from</span><span class="p">,</span>
        <span class="n">term</span><span class="o">=</span><span class="n">term</span><span class="p">,</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">attribute_type</span><span class="o">=</span><span class="n">attribute_type</span><span class="p">,</span>
        <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">attribute_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">attribute_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">attributes</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.attributes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate an Attributes object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>attributes</code>
            </td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="fusion.attributes.Attribute" href="../attributes/#fusion.attributes.Attribute">Attribute</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Attribute objects. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Attributes</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="fusion.attributes.Attributes" href="../attributes/#fusion.attributes.Attributes">Attributes</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion Attributes class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attr1</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s2">&quot;attr1&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attr2</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s2">&quot;attr2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">attributes</span><span class="p">([</span><span class="n">attr1</span><span class="p">,</span> <span class="n">attr2</span><span class="p">])</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>See the attributes module for more information on functionalities of attributes object.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">attributes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attributes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Attribute</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Attributes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate an Attributes object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        attributes (list[Attribute] | None, optional): List of Attribute objects. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Attributes: Fusion Attributes class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; attr1 = fusion.attribute(&quot;attr1&quot;, 0)</span>
<span class="sd">        &gt;&gt;&gt; attr2 = fusion.attribute(&quot;attr2&quot;, 1)</span>
<span class="sd">        &gt;&gt;&gt; attrs = fusion.attributes([attr1, attr2])</span>

<span class="sd">    Note:</span>
<span class="sd">        See the attributes module for more information on functionalities of attributes object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attributes_obj</span> <span class="o">=</span> <span class="n">Attributes</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">[])</span>
    <span class="n">attributes_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">attributes_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.catalog_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">catalog_resources</span><span class="p">(</span><span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.catalog_resources" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the resources contained within the catalog, for example products and datasets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each resource within the catalog</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">catalog_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the resources contained within the catalog, for example products and datasets.</span>

<span class="sd">    Args:</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">       class:`pandas.DataFrame`: A dataframe with a row for each resource within the catalog</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cat_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">cat_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.create_dataset_lineage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_dataset_lineage</span><span class="p">(</span><span class="n">base_dataset</span><span class="p">,</span> <span class="n">source_dataset_catalog_mapping</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_resp_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.create_dataset_lineage" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Upload lineage to a dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>base_dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier to which you want to add lineage.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_dataset_catalog_mapping</code>
            </td>
            <td>
                  <code>Union[<span title="pandas.DataFrame">DataFrame</span>, list[dict[str]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping for the dataset
identifier(s) and catalog(s) from which to add lineage.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Catalog identifier. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_resp_obj</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then return the response object. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If source_dataset_catalog_mapping is not a pandas DataFrame or a list of dictionaries</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>HTTPError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the request is unsuccessful.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Creating lineage from a pandas DataFrame.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span><span class="o">.</span><span class="n">create_dataset_lineage</span><span class="p">(</span><span class="n">base_dataset</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">source_dataset_catalog_mapping</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Creating lineage from a list of dictionaries.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span><span class="o">.</span><span class="n">create_dataset_lineage</span><span class="p">(</span><span class="n">base_dataset</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">source_dataset_catalog_mapping</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_dataset_lineage</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">base_dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">source_dataset_catalog_mapping</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload lineage to a dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        base_dataset (str): A dataset identifier to which you want to add lineage.</span>
<span class="sd">        source_dataset_catalog_mapping (Union[pd.DataFrame, list[dict[str]]]): Mapping for the dataset</span>
<span class="sd">            identifier(s) and catalog(s) from which to add lineage.</span>
<span class="sd">        catalog (Optional[str], optional): Catalog identifier. Defaults to None.</span>
<span class="sd">        return_resp_obj (bool, optional): If True then return the response object. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If source_dataset_catalog_mapping is not a pandas DataFrame or a list of dictionaries</span>
<span class="sd">        HTTPError: If the request is unsuccessful.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Creating lineage from a pandas DataFrame.</span>
<span class="sd">        &gt;&gt;&gt; data = [{&quot;dataset&quot;: &quot;a&quot;, &quot;catalog&quot;: &quot;a&quot;}, {&quot;dataset&quot;: &quot;b&quot;, &quot;catalog&quot;: &quot;b&quot;}]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(data)</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; fusion.create_dataset_lineage(base_dataset=&quot;c&quot;, source_dataset_catalog_mapping=df, catalog=&quot;c&quot;)</span>

<span class="sd">        Creating lineage from a list of dictionaries.</span>
<span class="sd">        &gt;&gt;&gt; data = [{&quot;dataset&quot;: &quot;a&quot;, &quot;catalog&quot;: &quot;a&quot;}, {&quot;dataset&quot;: &quot;b&quot;, &quot;catalog&quot;: &quot;b&quot;}]</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; fusion.create_dataset_lineage(base_dataset=&quot;c&quot;, source_dataset_catalog_mapping=data, catalog=&quot;c&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_dataset_catalog_mapping</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">dataset_mapping_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">],</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;catalog&quot;</span><span class="p">]}</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">source_dataset_catalog_mapping</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_dataset_catalog_mapping</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">dataset_mapping_list</span> <span class="o">=</span> <span class="n">source_dataset_catalog_mapping</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;source_dataset_catalog_mapping must be a pandas DataFrame or a list of dictionaries.&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">dataset_mapping_list</span><span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">base_dataset</span><span class="si">}</span><span class="s2">/lineage&quot;</span>

    <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">resp</span> <span class="k">if</span> <span class="n">return_resp_obj</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dataset</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;Once&#39;</span><span class="p">,</span> <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_third_party_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_restricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_raw_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maintainer</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan Fusion&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">publisher</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan&#39;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">created_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modified_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delivery_channel</span><span class="o">=</span><span class="s1">&#39;API&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;Available&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span> <span class="n">container_type</span><span class="o">=</span><span class="s1">&#39;Snapshot-Full&#39;</span><span class="p">,</span> <span class="n">snowflake</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complexity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_immutable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_mnpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_pci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_pii</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_client</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_public</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_internal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_confidential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_highly_confidential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_active</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owners</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.dataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a Dataset object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifier</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset title. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A category or list of categories for the dataset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset description. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frequency</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frequency of the dataset. Defaults to "Once".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Once&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal_only_dataset</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for internal datasets. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_third_party_data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for third party data. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_restricted</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for restricted datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_raw_data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for raw datasets. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maintainer</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset maintainer. Defaults to "J.P. Morgan Fusion".</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan Fusion&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of data vendor which provided the data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Region. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>publisher</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of vendor that publishes the data. Defaults to "J.P. Morgan".</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product to associate dataset with. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sub-category. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tags used for search purposes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>created_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modified_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Modified date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delivery_channel</code>
            </td>
            <td>
                  <code>str | list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delivery channel. Defaults to "API".</p>
              </div>
            </td>
            <td>
                  <code>&#39;API&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>language</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Language. Defaults to "English".</p>
              </div>
            </td>
            <td>
                  <code>&#39;English&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Status. Defaults to "Available".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Available&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type_</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset type. Defaults to "Source".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Source&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>container_type</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Container type. Defaults to "Snapshot-Full".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Snapshot-Full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snowflake</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Snowflake account connection. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complexity</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Complexity. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_immutable</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for immutable datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_mnpi</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_mnpi. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_pci</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_pci. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_pii</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_pii. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_client</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_client. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_public</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_public. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_internal. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_confidential</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_confidential. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_highly_confidential</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_highly_confidential. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_active</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_active. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>owners</code>
            </td>
            <td>
                  <code>list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The owners of the dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>application_id</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The application ID of the dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataset</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="fusion.dataset.Dataset" href="../datasets/#fusion.dataset.Dataset">Dataset</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion Dataset class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;DATASET_1&quot;</span><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>See the dataset module for more information on functionalities of dataset objects.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dataset</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
    <span class="n">is_internal_only_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">is_third_party_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_raw_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan Fusion&quot;</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
    <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">created_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modified_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span>
    <span class="n">container_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Snapshot-Full&quot;</span><span class="p">,</span>
    <span class="n">snowflake</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">complexity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_immutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_mnpi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_pci</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_pii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_client</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_internal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_highly_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">owners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a Dataset object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier (str): Dataset identifier.</span>
<span class="sd">        title (str, optional): Dataset title. If not provided, defaults to identifier.</span>
<span class="sd">        category (str | list[str] | None, optional): A category or list of categories for the dataset.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">        description (str, optional): Dataset description. If not provided, defaults to identifier.</span>
<span class="sd">        frequency (str, optional): The frequency of the dataset. Defaults to &quot;Once&quot;.</span>
<span class="sd">        is_internal_only_dataset (bool, optional): Flag for internal datasets. Defaults to False.</span>
<span class="sd">        is_third_party_data (bool, optional): Flag for third party data. Defaults to True.</span>
<span class="sd">        is_restricted (bool | None, optional): Flag for restricted datasets. Defaults to None.</span>
<span class="sd">        is_raw_data (bool, optional): Flag for raw datasets. Defaults to True.</span>
<span class="sd">        maintainer (str | None, optional): Dataset maintainer. Defaults to &quot;J.P. Morgan Fusion&quot;.</span>
<span class="sd">        source (str | list[str] | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">        region (str | list[str] | None, optional): Region. Defaults to None.</span>
<span class="sd">        publisher (str, optional): Name of vendor that publishes the data. Defaults to &quot;J.P. Morgan&quot;.</span>
<span class="sd">        product (str | list[str] | None, optional): Product to associate dataset with. Defaults to None.</span>
<span class="sd">        sub_category (str | list[str] | None, optional): Sub-category. Defaults to None.</span>
<span class="sd">        tags (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">        created_date (str | None, optional): Created date. Defaults to None.</span>
<span class="sd">        modified_date (str | None, optional): Modified date. Defaults to None.</span>
<span class="sd">        delivery_channel (str | list[str], optional): Delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">        language (str, optional): Language. Defaults to &quot;English&quot;.</span>
<span class="sd">        status (str, optional): Status. Defaults to &quot;Available&quot;.</span>
<span class="sd">        type_ (str | None, optional): Dataset type. Defaults to &quot;Source&quot;.</span>
<span class="sd">        container_type (str | None, optional): Container type. Defaults to &quot;Snapshot-Full&quot;.</span>
<span class="sd">        snowflake (str | None, optional): Snowflake account connection. Defaults to None.</span>
<span class="sd">        complexity (str | None, optional): Complexity. Defaults to None.</span>
<span class="sd">        is_immutable (bool | None, optional): Flag for immutable datasets. Defaults to None.</span>
<span class="sd">        is_mnpi (bool | None, optional): is_mnpi. Defaults to None.</span>
<span class="sd">        is_pci (bool | None, optional): is_pci. Defaults to None.</span>
<span class="sd">        is_pii (bool | None, optional): is_pii. Defaults to None.</span>
<span class="sd">        is_client (bool | None, optional): is_client. Defaults to None.</span>
<span class="sd">        is_public (bool | None, optional): is_public. Defaults to None.</span>
<span class="sd">        is_internal (bool | None, optional): is_internal. Defaults to None.</span>
<span class="sd">        is_confidential (bool | None, optional): is_confidential. Defaults to None.</span>
<span class="sd">        is_highly_confidential (bool | None, optional): is_highly_confidential. Defaults to None.</span>
<span class="sd">        is_active (bool | None, optional): is_active. Defaults to None.</span>
<span class="sd">        owners (list[str] | None, optional): The owners of the dataset. Defaults to None.</span>
<span class="sd">        application_id (str | None, optional): The application ID of the dataset. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataset: Fusion Dataset class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; dataset = fusion.dataset(identifier=&quot;DATASET_1&quot;)</span>

<span class="sd">    Note:</span>
<span class="sd">        See the dataset module for more information on functionalities of dataset objects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataset_obj</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="n">is_internal_only_dataset</span><span class="p">,</span>
        <span class="n">is_third_party_data</span><span class="o">=</span><span class="n">is_third_party_data</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
        <span class="n">is_raw_data</span><span class="o">=</span><span class="n">is_raw_data</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
        <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
        <span class="n">created_date</span><span class="o">=</span><span class="n">created_date</span><span class="p">,</span>
        <span class="n">modified_date</span><span class="o">=</span><span class="n">modified_date</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
        <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
        <span class="n">container_type</span><span class="o">=</span><span class="n">container_type</span><span class="p">,</span>
        <span class="n">snowflake</span><span class="o">=</span><span class="n">snowflake</span><span class="p">,</span>
        <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
        <span class="n">is_immutable</span><span class="o">=</span><span class="n">is_immutable</span><span class="p">,</span>
        <span class="n">is_mnpi</span><span class="o">=</span><span class="n">is_mnpi</span><span class="p">,</span>
        <span class="n">is_pci</span><span class="o">=</span><span class="n">is_pci</span><span class="p">,</span>
        <span class="n">is_pii</span><span class="o">=</span><span class="n">is_pii</span><span class="p">,</span>
        <span class="n">is_client</span><span class="o">=</span><span class="n">is_client</span><span class="p">,</span>
        <span class="n">is_public</span><span class="o">=</span><span class="n">is_public</span><span class="p">,</span>
        <span class="n">is_internal</span><span class="o">=</span><span class="n">is_internal</span><span class="p">,</span>
        <span class="n">is_confidential</span><span class="o">=</span><span class="n">is_confidential</span><span class="p">,</span>
        <span class="n">is_highly_confidential</span><span class="o">=</span><span class="n">is_highly_confidential</span><span class="p">,</span>
        <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
        <span class="n">owners</span><span class="o">=</span><span class="n">owners</span><span class="p">,</span>
        <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">dataset_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">dataset_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.dataset_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dataset_resources</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.dataset_resources" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the resources available for a dataset, currently this will always be a datasetseries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each resource</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dataset_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the resources available for a dataset, currently this will always be a datasetseries.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each resource</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ds_res_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">ds_res_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.datasetmember_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">datasetmember_resources</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.datasetmember_resources" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the available resources for a datasetseries member.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The datasetseries identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each datasetseries member resource.
Currently, this will always be distributions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">datasetmember_resources</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the available resources for a datasetseries member.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        series (str): The datasetseries identifier</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each datasetseries member resource.</span>
<span class="sd">            Currently, this will always be distributions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries/</span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ds_mem_res_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">ds_mem_res_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.delete_all_datasetmembers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_all_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_resp_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.delete_all_datasetmembers" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Delete all dataset members within a dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_resp_obj</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then return the response object. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="requests.Response">Response</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[requests.Response]: a list of response objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span><span class="o">.</span><span class="n">delete_all_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;dataset1&quot;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_all_datasetmembers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all dataset members within a dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        return_resp_obj (bool, optional): If True then return the response object. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[requests.Response]: a list of response objects.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; fusion.delete_all_datasetmembers(dataset=&quot;dataset1&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span> <span class="k">if</span> <span class="n">return_resp_obj</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.delete_datasetmembers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">series_members</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_resp_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.delete_datasetmembers" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Delete dataset members.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_members</code>
            </td>
            <td>
                  <code>str | list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or list of strings that are dataset series member</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_resp_obj</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then return the response object. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="requests.Response">Response</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[requests.Response]: a list of response objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Delete one dataset member.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span><span class="o">.</span><span class="n">delete_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;dataset1&quot;</span><span class="p">,</span> <span class="n">series_members</span><span class="o">=</span><span class="s2">&quot;series1&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Delete multiple dataset members.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span><span class="o">.</span><span class="n">delete_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;dataset1&quot;</span><span class="p">,</span> <span class="n">series_members</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;series1&quot;</span><span class="p">,</span> <span class="s2">&quot;series2&quot;</span><span class="p">])</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_datasetmembers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">series_members</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">requests</span><span class="o">.</span><span class="n">Response</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete dataset members.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        series_members (str | list[str]): A string or list of strings that are dataset series member</span>
<span class="sd">        identifiers to delete.</span>
<span class="sd">        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        return_resp_obj (bool, optional): If True then return the response object. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[requests.Response]: a list of response objects.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Delete one dataset member.</span>

<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; fusion.delete_datasetmembers(dataset=&quot;dataset1&quot;, series_members=&quot;series1&quot;)</span>

<span class="sd">        Delete multiple dataset members.</span>

<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; fusion.delete_datasetmembers(dataset=&quot;dataset1&quot;, series_members=[&quot;series1&quot;, &quot;series2&quot;])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_members</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">series_members</span> <span class="o">=</span> <span class="p">[</span><span class="n">series_members</span><span class="p">]</span>
    <span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">series_member</span> <span class="ow">in</span> <span class="n">series_members</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries/</span><span class="si">{</span><span class="n">series_member</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
        <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">responses</span> <span class="k">if</span> <span class="n">return_resp_obj</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.download" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="n">dataset_format</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_par</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partitioning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preserve_original_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.download" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Downloads the requested distributions of a dataset to disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt_str</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a single date or a range identified by a start or end date,
or both separated with a ":". Defaults to 'latest' which will return the most recent
instance of the dataset. If more than one series member exists on the latest date, the
series member identifiers will be sorted alphabetically and the last one will be downloaded.</p>
              </div>
            </td>
            <td>
                  <code>&#39;latest&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_format</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file format, e.g. CSV or Parquet. Defaults to 'parquet'.
If set to None, the function will download if only one format is available, else it will raise an error.</p>
              </div>
            </td>
            <td>
                  <code>&#39;parquet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_par</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specify how many distributions to download in parallel.
Defaults to all cpus available.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Display a progress bar during data download Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_download</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then will always download a file even
if it is already on disk. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>download_folder</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path, absolute or relative, where downloaded files are saved.
Defaults to download_folder as set in <strong>init</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_paths</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return paths and success statuses of the downloaded files.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partitioning</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>preserve_original_name</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Preserve the original name of the file. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912, PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
    <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">partitioning</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">preserve_original_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads the requested distributions of a dataset to disk.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">            or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">            instance of the dataset. If more than one series member exists on the latest date, the</span>
<span class="sd">            series member identifiers will be sorted alphabetically and the last one will be downloaded.</span>
<span class="sd">        dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">            If set to None, the function will download if only one format is available, else it will raise an error.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        n_par (int, optional): Specify how many distributions to download in parallel.</span>
<span class="sd">            Defaults to all cpus available.</span>
<span class="sd">        show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">        force_download (bool, optional): If True then will always download a file even</span>
<span class="sd">            if it is already on disk. Defaults to True.</span>
<span class="sd">        download_folder (str, optional): The path, absolute or relative, where downloaded files are saved.</span>
<span class="sd">            Defaults to download_folder as set in __init__</span>
<span class="sd">        return_paths (bool, optional): Return paths and success statuses of the downloaded files.</span>
<span class="sd">        partitioning (str, optional): Partitioning specification.</span>
<span class="sd">        preserve_original_name (bool, optional): Preserve the original name of the file. Defaults to False.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="c1"># check access to the dataset</span>
    <span class="n">dataset_resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">dataset_resp</span><span class="p">)</span>

    <span class="n">access_status</span> <span class="o">=</span> <span class="n">dataset_resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">access_status</span> <span class="o">!=</span> <span class="s2">&quot;Subscribed&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>
            <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You are not subscribed to </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">. Please request access.&quot;</span><span class="p">),</span>
            <span class="n">status_code</span><span class="o">=</span><span class="mi">401</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">valid_date_range</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(\d</span><span class="si">{4}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">)$|^((\d</span><span class="si">{4}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">)?([:])(\d</span><span class="si">{4}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">\d</span><span class="si">{2}</span><span class="s2">)?)$&quot;</span><span class="p">)</span>

    <span class="c1"># check that format is valid and if none, check if there is only one format available</span>
    <span class="n">distributions_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_datasetmembers_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">distributions_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No distributions found for dataset &#39;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&#39; in catalog &#39;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="n">available_formats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">distributions_df</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">and</span> <span class="n">dataset_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available_formats</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Dataset format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2"> is not available for </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Available formats are </span><span class="si">{</span><span class="n">available_formats</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_formats</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dataset_format</span> <span class="o">=</span> <span class="n">available_formats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Multiple formats found for </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in catalog </span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">. Dataset format is required to&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;download. Available formats are </span><span class="si">{</span><span class="n">available_formats</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">valid_date_range</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">dt_str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
        <span class="n">required_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_distro_tuples</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">dataset_format</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># sample data is limited to csv</span>
        <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">:</span>
            <span class="n">dataset_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">required_series</span> <span class="o">=</span> <span class="p">[(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">dataset_format</span><span class="p">)]</span>  <span class="c1"># type: ignore[list-item]</span>

    <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RECOGNIZED_FORMATS</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">FileFormatError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2"> is not supported.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">download_folder</span><span class="p">:</span>
        <span class="n">download_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span>

    <span class="n">download_folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">download_folder</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">required_series</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">partitioning</span> <span class="o">==</span> <span class="s2">&quot;hive&quot;</span><span class="p">:</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">series</span> <span class="ow">in</span> <span class="n">required_series</span><span class="p">]</span>
        <span class="n">download_folders</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">download_folders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">members</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">series</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">required_series</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">download_folders</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">create_parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">n_par</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
    <span class="n">download_spec</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;lfs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
            <span class="s2">&quot;rpath&quot;</span><span class="p">:</span> <span class="n">distribution_to_url</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">is_download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;lpath&quot;</span><span class="p">:</span> <span class="n">distribution_to_filename</span><span class="p">(</span>
                <span class="n">download_folders</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">partitioning</span><span class="o">=</span><span class="n">partitioning</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;overwrite&quot;</span><span class="p">:</span> <span class="n">force_download</span><span class="p">,</span>
            <span class="s2">&quot;preserve_original_name&quot;</span><span class="p">:</span> <span class="n">preserve_original_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">series</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">required_series</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
        <span class="n">VERBOSE_LVL</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;Beginning </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">download_spec</span><span class="p">)</span><span class="si">}</span><span class="s2"> downloads in batches of </span><span class="si">{</span><span class="n">n_par</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Progress</span><span class="p">()</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">task</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;Downloading&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">download_spec</span><span class="p">))</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">download_spec</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="o">**</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="o">**</span><span class="n">spec</span><span class="p">)</span> <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">download_spec</span><span class="p">]</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The download of </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> was not successful&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span> <span class="k">if</span> <span class="n">return_paths</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.from_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">series_member</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">multipart</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span><span class="p">,</span> <span class="n">from_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.from_bytes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Uploads data from an object in memory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an object in memory to upload</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset name to which the bytes will be uploaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_member</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single date or label. Defaults to 'latest' which will return
the most recent.</p>
              </div>
            </td>
            <td>
                  <code>&#39;latest&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distribution</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A distribution type, e.g. a file format or raw</p>
              </div>
            </td>
            <td>
                  <code>&#39;parquet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Display a progress bar during data download Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multipart</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is multipart upload.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_paths</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return paths and success statuses of the downloaded files.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_size</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum chunk size.</p>
              </div>
            </td>
            <td>
                  <code>5 * 2 ** 20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>from_date</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>start of the data date range contained in the distribution,
defaults to upload date</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_date</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>end of the data date range contained in the distribution, defaults to upload date.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>file name to be used for the uploaded file. Defaults to Fusion standard naming.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[bool, str, str | None]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[list[tuple[bool, str, Optional[str]]]: a list of tuples, one for each distribution</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">from_bytes</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">BytesIO</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">series_member</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">multipart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">from_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>  <span class="c1"># noqa: ARG002</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads data from an object in memory.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str): an object in memory to upload</span>
<span class="sd">        dataset (str): Dataset name to which the bytes will be uploaded.</span>
<span class="sd">        series_member (str, optional): A single date or label. Defaults to &#39;latest&#39; which will return</span>
<span class="sd">            the most recent.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        distribution (str, optional): A distribution type, e.g. a file format or raw</span>
<span class="sd">        show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">        multipart (bool, optional): Is multipart upload.</span>
<span class="sd">        return_paths (bool, optional): Return paths and success statuses of the downloaded files.</span>
<span class="sd">        chunk_size (int, optional): Maximum chunk size.</span>
<span class="sd">        from_date (str, optional): start of the data date range contained in the distribution,</span>
<span class="sd">            defaults to upload date</span>
<span class="sd">        to_date (str, optional): end of the data date range contained in the distribution, defaults to upload date.</span>
<span class="sd">        file_name (str, optional): file name to be used for the uploaded file. Defaults to Fusion standard naming.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[list[tuple[bool, str, Optional[str]]]: a list of tuples, one for each distribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">fs_fusion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RECOGNIZED_FORMATS</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset format </span><span class="si">{</span><span class="n">distribution</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

    <span class="n">is_raw</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">fs_fusion</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))[</span><span class="s2">&quot;isRawData&quot;</span><span class="p">]</span>
    <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="n">path_to_url</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">series_member</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">distribution</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">is_raw</span><span class="p">)</span>

    <span class="n">data_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">local_url_eqiv</span><span class="p">,</span> <span class="n">file_name</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">data_map_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore[assignment]</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">upload_files</span><span class="p">(</span>
        <span class="n">fs_fusion</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">data_map_df</span><span class="p">,</span>
        <span class="n">multipart</span><span class="o">=</span><span class="n">multipart</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
        <span class="n">from_date</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span>
        <span class="n">to_date</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">):</span>
        <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Not all uploads were successfully completed. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span> <span class="k">if</span> <span class="n">return_paths</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.get_async_fusion_vector_store_client" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_async_fusion_vector_store_client</span><span class="p">(</span><span class="n">knowledge_base</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.get_async_fusion_vector_store_client" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns Fusion Embeddings Search client.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>knowledge_base</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Knowledge base (dataset) identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>OpenSearch</code></td>            <td>
                  <code><span title="opensearchpy.AsyncOpenSearch">AsyncOpenSearch</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion Embeddings Search client.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_async_fusion_vector_store_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">knowledge_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncOpenSearch</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns Fusion Embeddings Search client.</span>

<span class="sd">    Args:</span>
<span class="sd">        knowledge_base (str): Knowledge base (dataset) identifier.</span>
<span class="sd">        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        OpenSearch: Fusion Embeddings Search client.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">opensearchpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncOpenSearch</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">fusion.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">FusionAsyncHttpConnection</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">AsyncOpenSearch</span><span class="p">(</span>
        <span class="n">connection_class</span><span class="o">=</span><span class="n">FusionAsyncHttpConnection</span><span class="p">,</span>
        <span class="n">catalog</span><span class="o">=</span><span class="n">catalog</span><span class="p">,</span>
        <span class="n">knowledge_base</span><span class="o">=</span><span class="n">knowledge_base</span><span class="p">,</span>
        <span class="n">root_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.get_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_events</span><span class="p">(</span><span class="n">last_event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.get_events" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run server sent event listener and print out the new events. Keyboard terminate to stop.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>last_event_id</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>id of the last event.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>catalog.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_background</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>execute event monitoring in the background (default = True).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subscription url. Defaults to client's root url.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">last_event_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">in_background</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run server sent event listener and print out the new events. Keyboard terminate to stop.</span>

<span class="sd">    Args:</span>
<span class="sd">        last_event_id (str): id of the last event.</span>
<span class="sd">        catalog (str): catalog.</span>
<span class="sd">        in_background (bool): execute event monitoring in the background (default = True).</span>
<span class="sd">        url (str): subscription url. Defaults to client&#39;s root url.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Union[None, class:`pandas.DataFrame`]: If in_background is True then the function returns no output.</span>
<span class="sd">            If in_background is set to False then pandas DataFrame is output upon keyboard termination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">url</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_background</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sseclient</span><span class="w"> </span><span class="kn">import</span> <span class="n">SSEClient</span>

        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_resources</span><span class="p">()</span>  <span class="c1"># refresh token</span>
        <span class="n">interrupted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">messages</span> <span class="o">=</span> <span class="n">SSEClient</span><span class="p">(</span>
            <span class="n">session</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
            <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/notifications/subscribe&quot;</span><span class="p">,</span>
            <span class="n">last_id</span><span class="o">=</span><span class="n">last_event_id</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">bearer_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                <span class="n">event</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="c1"># Preserve the original metaData column</span>
                <span class="n">original_meta_data</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metaData&quot;</span><span class="p">,</span> <span class="p">{})</span>

                <span class="c1"># Flatten the metaData dictionary into the event dictionary</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;HeartBeatNotification&quot;</span><span class="p">:</span>
                    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">interrupted</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="k">if</span> <span class="n">interrupted</span> <span class="ow">or</span> <span class="n">lst</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.get_fusion_filesystem" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fusion_filesystem</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.get_fusion_filesystem" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve Fusion file system instance.</p>
<p>Note: This function always returns a reference to the exact same FFS instance since
an FFS instance is based off the FusionCredentials object.</p>
<p>Returns: Fusion Filesystem</p>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_fusion_filesystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FusionHTTPFileSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve Fusion file system instance.</span>

<span class="sd">    Note: This function always returns a reference to the exact same FFS instance since</span>
<span class="sd">    an FFS instance is based off the FusionCredentials object.</span>

<span class="sd">    Returns: Fusion Filesystem</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">as_async</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;asynchronous&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">FusionHTTPFileSystem</span><span class="p">(</span>
        <span class="n">asynchronous</span><span class="o">=</span><span class="n">as_async</span><span class="p">,</span> <span class="n">client_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;root_url&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">}</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.get_fusion_vector_store_client" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fusion_vector_store_client</span><span class="p">(</span><span class="n">knowledge_base</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.get_fusion_vector_store_client" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns Fusion Embeddings Search client.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>knowledge_base</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Knowledge base (dataset) identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>OpenSearch</code></td>            <td>
                  <code><span title="opensearchpy.OpenSearch">OpenSearch</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion Embeddings Search client.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_fusion_vector_store_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">knowledge_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpenSearch</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns Fusion Embeddings Search client.</span>

<span class="sd">    Args:</span>
<span class="sd">        knowledge_base (str): Knowledge base (dataset) identifier.</span>
<span class="sd">        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        OpenSearch: Fusion Embeddings Search client.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">opensearchpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenSearch</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">fusion.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">FusionEmbeddingsConnection</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">OpenSearch</span><span class="p">(</span>
        <span class="n">connection_class</span><span class="o">=</span><span class="n">FusionEmbeddingsConnection</span><span class="p">,</span>
        <span class="n">catalog</span><span class="o">=</span><span class="n">catalog</span><span class="p">,</span>
        <span class="n">knowledge_base</span><span class="o">=</span><span class="n">knowledge_base</span><span class="p">,</span>
        <span class="n">root_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.input_dataflow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_dataflow</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;Once&#39;</span><span class="p">,</span> <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_third_party_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_restricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_raw_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maintainer</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan Fusion&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">publisher</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan&#39;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">created_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modified_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delivery_channel</span><span class="o">=</span><span class="s1">&#39;API&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;Available&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s1">&#39;Flow&#39;</span><span class="p">,</span> <span class="n">container_type</span><span class="o">=</span><span class="s1">&#39;Snapshot-Full&#39;</span><span class="p">,</span> <span class="n">snowflake</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complexity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_immutable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_mnpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_pci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_pii</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_client</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_public</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_internal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_confidential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_highly_confidential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_active</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owners</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">producer_application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">consumer_application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flow_details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.input_dataflow" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate an Input Dataflow object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifier</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset title. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A category or list of categories for the dataset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset description. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frequency</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frequency of the dataset. Defaults to "Once".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Once&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal_only_dataset</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for internal datasets. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_third_party_data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for third party data. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_restricted</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for restricted datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_raw_data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for raw datasets. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maintainer</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset maintainer. Defaults to "J.P. Morgan Fusion".</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan Fusion&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of data vendor which provided the data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Region. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>publisher</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of vendor that publishes the data. Defaults to "J.P. Morgan".</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product to associate dataset with. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sub-category. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tags used for search purposes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>created_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modified_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Modified date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delivery_channel</code>
            </td>
            <td>
                  <code>str | list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delivery channel. Defaults to "API".</p>
              </div>
            </td>
            <td>
                  <code>&#39;API&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>language</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Language. Defaults to "English".</p>
              </div>
            </td>
            <td>
                  <code>&#39;English&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Status. Defaults to "Available".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Available&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type_</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset type. Defaults to "Flow".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Flow&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>container_type</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Container type. Defaults to "Snapshot-Full".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Snapshot-Full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snowflake</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Snowflake account connection. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complexity</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Complexity. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_immutable</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for immutable datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_mnpi</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_mnpi. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_pci</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_pci. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_pii</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_pii. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_client</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_client. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_public</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_public. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_internal. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_confidential</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_confidential. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_highly_confidential</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_highly_confidential. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_active</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_active. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>owners</code>
            </td>
            <td>
                  <code>list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The owners of the dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>application_id</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The application ID of the dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>producer_application_id</code>
            </td>
            <td>
                  <code>dict[str, str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The producer application ID (upstream application
producing the flow).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>consumer_application_id</code>
            </td>
            <td>
                  <code>list[dict[str, str]] | dict[str, str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The consumer application
ID (downstream application, consuming the flow).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flow_details</code>
            </td>
            <td>
                  <code>dict[str, str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flow details. Specifies input versus output flow.
Defaults to {"flowDirection": "Input"}.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataset</code></td>            <td>
                  <code><span title="fusion.dataflow.InputDataFlow">InputDataFlow</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion InputDataFlow class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">input_dataflow</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;MY_DATAFLOW&quot;</span><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>See the dataset module for more information on functionalities of input dataflow objects.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">input_dataflow</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
    <span class="n">is_internal_only_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">is_third_party_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_raw_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan Fusion&quot;</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
    <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">created_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modified_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Flow&quot;</span><span class="p">,</span>
    <span class="n">container_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Snapshot-Full&quot;</span><span class="p">,</span>
    <span class="n">snowflake</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">complexity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_immutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_mnpi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_pci</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_pii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_client</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_internal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_highly_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">owners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">producer_application_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consumer_application_id</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">flow_details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InputDataFlow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate an Input Dataflow object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier (str): Dataset identifier.</span>
<span class="sd">        title (str, optional): Dataset title. If not provided, defaults to identifier.</span>
<span class="sd">        category (str | list[str] | None, optional): A category or list of categories for the dataset.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">        description (str, optional): Dataset description. If not provided, defaults to identifier.</span>
<span class="sd">        frequency (str, optional): The frequency of the dataset. Defaults to &quot;Once&quot;.</span>
<span class="sd">        is_internal_only_dataset (bool, optional): Flag for internal datasets. Defaults to False.</span>
<span class="sd">        is_third_party_data (bool, optional): Flag for third party data. Defaults to True.</span>
<span class="sd">        is_restricted (bool | None, optional): Flag for restricted datasets. Defaults to None.</span>
<span class="sd">        is_raw_data (bool, optional): Flag for raw datasets. Defaults to True.</span>
<span class="sd">        maintainer (str | None, optional): Dataset maintainer. Defaults to &quot;J.P. Morgan Fusion&quot;.</span>
<span class="sd">        source (str | list[str] | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">        region (str | list[str] | None, optional): Region. Defaults to None.</span>
<span class="sd">        publisher (str, optional): Name of vendor that publishes the data. Defaults to &quot;J.P. Morgan&quot;.</span>
<span class="sd">        product (str | list[str] | None, optional): Product to associate dataset with. Defaults to None.</span>
<span class="sd">        sub_category (str | list[str] | None, optional): Sub-category. Defaults to None.</span>
<span class="sd">        tags (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">        created_date (str | None, optional): Created date. Defaults to None.</span>
<span class="sd">        modified_date (str | None, optional): Modified date. Defaults to None.</span>
<span class="sd">        delivery_channel (str | list[str], optional): Delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">        language (str, optional): Language. Defaults to &quot;English&quot;.</span>
<span class="sd">        status (str, optional): Status. Defaults to &quot;Available&quot;.</span>
<span class="sd">        type_ (str | None, optional): Dataset type. Defaults to &quot;Flow&quot;.</span>
<span class="sd">        container_type (str | None, optional): Container type. Defaults to &quot;Snapshot-Full&quot;.</span>
<span class="sd">        snowflake (str | None, optional): Snowflake account connection. Defaults to None.</span>
<span class="sd">        complexity (str | None, optional): Complexity. Defaults to None.</span>
<span class="sd">        is_immutable (bool | None, optional): Flag for immutable datasets. Defaults to None.</span>
<span class="sd">        is_mnpi (bool | None, optional): is_mnpi. Defaults to None.</span>
<span class="sd">        is_pci (bool | None, optional): is_pci. Defaults to None.</span>
<span class="sd">        is_pii (bool | None, optional): is_pii. Defaults to None.</span>
<span class="sd">        is_client (bool | None, optional): is_client. Defaults to None.</span>
<span class="sd">        is_public (bool | None, optional): is_public. Defaults to None.</span>
<span class="sd">        is_internal (bool | None, optional): is_internal. Defaults to None.</span>
<span class="sd">        is_confidential (bool | None, optional): is_confidential. Defaults to None.</span>
<span class="sd">        is_highly_confidential (bool | None, optional): is_highly_confidential. Defaults to None.</span>
<span class="sd">        is_active (bool | None, optional): is_active. Defaults to None.</span>
<span class="sd">        owners (list[str] | None, optional): The owners of the dataset. Defaults to None.</span>
<span class="sd">        application_id (str | None, optional): The application ID of the dataset. Defaults to None.</span>
<span class="sd">        producer_application_id (dict[str, str] | None, optional): The producer application ID (upstream application</span>
<span class="sd">            producing the flow).</span>
<span class="sd">        consumer_application_id (list[dict[str, str]] | dict[str, str] | None, optional): The consumer application</span>
<span class="sd">            ID (downstream application, consuming the flow).</span>
<span class="sd">        flow_details (dict[str, str] | None, optional): The flow details. Specifies input versus output flow.</span>
<span class="sd">            Defaults to {&quot;flowDirection&quot;: &quot;Input&quot;}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataset: Fusion InputDataFlow class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; dataset = fusion.input_dataflow(identifier=&quot;MY_DATAFLOW&quot;)</span>

<span class="sd">    Note:</span>
<span class="sd">        See the dataset module for more information on functionalities of input dataflow objects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flow_details</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;flowDirection&quot;</span><span class="p">:</span> <span class="s2">&quot;Input&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="n">flow_details</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">flow_details</span>
    <span class="n">dataflow_obj</span> <span class="o">=</span> <span class="n">InputDataFlow</span><span class="p">(</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="n">is_internal_only_dataset</span><span class="p">,</span>
        <span class="n">is_third_party_data</span><span class="o">=</span><span class="n">is_third_party_data</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
        <span class="n">is_raw_data</span><span class="o">=</span><span class="n">is_raw_data</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
        <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
        <span class="n">created_date</span><span class="o">=</span><span class="n">created_date</span><span class="p">,</span>
        <span class="n">modified_date</span><span class="o">=</span><span class="n">modified_date</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
        <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
        <span class="n">container_type</span><span class="o">=</span><span class="n">container_type</span><span class="p">,</span>
        <span class="n">snowflake</span><span class="o">=</span><span class="n">snowflake</span><span class="p">,</span>
        <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
        <span class="n">is_immutable</span><span class="o">=</span><span class="n">is_immutable</span><span class="p">,</span>
        <span class="n">is_mnpi</span><span class="o">=</span><span class="n">is_mnpi</span><span class="p">,</span>
        <span class="n">is_pci</span><span class="o">=</span><span class="n">is_pci</span><span class="p">,</span>
        <span class="n">is_pii</span><span class="o">=</span><span class="n">is_pii</span><span class="p">,</span>
        <span class="n">is_client</span><span class="o">=</span><span class="n">is_client</span><span class="p">,</span>
        <span class="n">is_public</span><span class="o">=</span><span class="n">is_public</span><span class="p">,</span>
        <span class="n">is_internal</span><span class="o">=</span><span class="n">is_internal</span><span class="p">,</span>
        <span class="n">is_confidential</span><span class="o">=</span><span class="n">is_confidential</span><span class="p">,</span>
        <span class="n">is_highly_confidential</span><span class="o">=</span><span class="n">is_highly_confidential</span><span class="p">,</span>
        <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
        <span class="n">owners</span><span class="o">=</span><span class="n">owners</span><span class="p">,</span>
        <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
        <span class="n">producer_application_id</span><span class="o">=</span><span class="n">producer_application_id</span><span class="p">,</span>
        <span class="n">consumer_application_id</span><span class="o">=</span><span class="n">consumer_application_id</span><span class="p">,</span>
        <span class="n">flow_details</span><span class="o">=</span><span class="n">flow_details</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">dataflow_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">dataflow_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.link_attributes_to_terms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">link_attributes_to_terms</span><span class="p">(</span><span class="n">report_id</span><span class="p">,</span> <span class="n">mappings</span><span class="p">,</span> <span class="n">return_resp_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.link_attributes_to_terms" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Link one or more report attributes to business glossary terms.</p>


<details class="each-mapping-should-follow-this-format" open>
  <summary>Each mapping should follow this format</summary>
  <p>{
    "attribute": {"id": "attribute-id"},
    "term": {"id": "term-id"},
    "isKDE": True  # Optional; defaults to True if not provided
}</p>
</details>        <p>This method wraps <code>Report.link_attributes_to_terms</code> and automatically attaches the Fusion client.</p>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">link_attributes_to_terms</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">report_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mappings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Report</span><span class="o">.</span><span class="n">AttributeTermMapping</span><span class="p">],</span>
    <span class="n">return_resp_obj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Link one or more report attributes to business glossary terms.</span>

<span class="sd">    Each mapping should follow this format:</span>
<span class="sd">        {</span>
<span class="sd">            &quot;attribute&quot;: {&quot;id&quot;: &quot;attribute-id&quot;},</span>
<span class="sd">            &quot;term&quot;: {&quot;id&quot;: &quot;term-id&quot;},</span>
<span class="sd">            &quot;isKDE&quot;: True  # Optional; defaults to True if not provided</span>
<span class="sd">        }</span>

<span class="sd">    This method wraps `Report.link_attributes_to_terms` and automatically attaches the Fusion client.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">processed_mappings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mapping</span> <span class="ow">in</span> <span class="n">mappings</span><span class="p">:</span>
        <span class="n">new_mapping</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;isKDE&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_mapping</span><span class="p">:</span>
            <span class="n">new_mapping</span><span class="p">[</span><span class="s2">&quot;isKDE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">processed_mappings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_mapping</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Report</span><span class="o">.</span><span class="n">link_attributes_to_terms</span><span class="p">(</span>
        <span class="n">report_id</span><span class="o">=</span><span class="n">report_id</span><span class="p">,</span> <span class="n">mappings</span><span class="o">=</span><span class="n">processed_mappings</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_resp_obj</span><span class="o">=</span><span class="n">return_resp_obj</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_catalogs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_catalogs</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_catalogs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Lists the catalogs available to the API account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each catalog</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_catalogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists the catalogs available to the API account.</span>

<span class="sd">    Args:</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each catalog</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/&quot;</span>
    <span class="n">cat_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">cat_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_dataset_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_dataset_attributes</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">display_all_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_dataset_attributes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the list of attributes that are in the dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display_all_columns</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True displays all columns returned by the API,
otherwise only the key columns are displayed</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each attribute</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_dataset_attributes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the list of attributes that are in the dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">            otherwise only the key columns are displayed</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each attribute</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/attributes&quot;</span>
    <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;index&quot;</span> <span class="ow">in</span> <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
        <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">ds_attr_df</span><span class="p">[</span>
            <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;dataType&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;isDatasetKey&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">ds_attr_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_dataset_lineage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_dataset_lineage</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_dataset_lineage" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the upstream and downstream lineage of the dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limit the number of rows returned in the dataframe.
Defaults to -1 which returns all results.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each resource</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>HTTPError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the dataset is not found in the catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_dataset_lineage</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the upstream and downstream lineage of the dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">            Defaults to -1 which returns all results.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each resource</span>

<span class="sd">    Raises:</span>
<span class="sd">        HTTPError: If the dataset is not found in the catalog.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">/lineage&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
    <span class="n">relations_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;relations&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">restricted_datasets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">dataset_metadata</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">dataset_metadata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;datasets&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dataset_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Restricted&quot;</span>
    <span class="p">]</span>

    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">relations_data</span><span class="p">:</span>
        <span class="n">source_dataset_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span>
        <span class="n">source_catalog</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;catalog&quot;</span><span class="p">]</span>
        <span class="n">destination_dataset_id</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span>
        <span class="n">destination_catalog</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">][</span><span class="s2">&quot;catalog&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">destination_dataset_id</span> <span class="o">==</span> <span class="n">dataset_id</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;datasets&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Restricted&quot;</span><span class="p">:</span>
                    <span class="n">source_dataset_title</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Restricted&quot;</span><span class="p">:</span>
                    <span class="n">source_dataset_title</span> <span class="o">=</span> <span class="s2">&quot;Access Restricted&quot;</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="n">source_dataset_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                <span class="n">source_catalog</span><span class="p">,</span>
                <span class="n">source_dataset_title</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">source_dataset_id</span> <span class="o">==</span> <span class="n">dataset_id</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;datasets&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">destination_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Restricted&quot;</span><span class="p">:</span>
                    <span class="n">destination_dataset_title</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="p">(</span>
                    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">destination_dataset_id</span> <span class="ow">and</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Restricted&quot;</span>
                <span class="p">):</span>
                    <span class="n">destination_dataset_title</span> <span class="o">=</span> <span class="s2">&quot;Access Restricted&quot;</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="n">destination_dataset_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;produced&quot;</span><span class="p">,</span>
                <span class="n">destination_catalog</span><span class="p">,</span>
                <span class="n">destination_dataset_title</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="n">output_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
        <span class="s2">&quot;dataset_identifier&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
        <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
    <span class="p">}</span>

    <span class="n">lineage_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
    <span class="n">lineage_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="n">lineage_df</span><span class="p">[</span><span class="s2">&quot;dataset_identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">restricted_datasets</span><span class="p">),</span>
        <span class="p">[</span><span class="s2">&quot;dataset_identifier&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">],</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Access Restricted&quot;</span>

    <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">lineage_df</span> <span class="o">=</span> <span class="n">lineage_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">lineage_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_datasetmembers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_datasetmembers</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_datasetmembers" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the available members in the dataset series.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limit the number of rows returned in the dataframe.
Defaults to -1 which returns all results.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: a dataframe with a row for each dataset member.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_datasetmembers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the available members in the dataset series.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">            Defaults to -1 which returns all results.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: a dataframe with a row for each dataset member.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries&quot;</span>
    <span class="n">ds_members_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">ds_members_df</span> <span class="o">=</span> <span class="n">ds_members_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">ds_members_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_datasetmembers_distributions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_datasetmembers_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_datasetmembers_distributions" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the distributions of dataset members.</p>
<div class="highlight"><pre><span></span><code>    Args:
        dataset (str): Dataset identifier.
        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.
        output (bool, optional): If True then print the dataframe. Defaults to False.
</code></pre></div>
<p>F
        Returns:
            pd.DataFrame: A dataframe with a row for each dataset member distribution.</p>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_datasetmembers_distributions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the distributions of dataset members.</span>

<span class="sd">            Args:</span>
<span class="sd">                dataset (str): Dataset identifier.</span>
<span class="sd">                catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">                output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">    F</span>
<span class="sd">            Returns:</span>
<span class="sd">                pd.DataFrame: A dataframe with a row for each dataset member distribution.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/changes?datasets=</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

    <span class="n">datasets</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datasets&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">dists</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;distributions&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">MEMBER_FORMAT_INDEX</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Index for member_format in values list</span>
    <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">dists</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MEMBER_FORMAT_INDEX</span><span class="p">:</span>
            <span class="n">member_id</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">member_format</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">MEMBER_FORMAT_INDEX</span><span class="p">]</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">member_id</span><span class="p">,</span> <span class="n">member_format</span><span class="p">))</span>

    <span class="n">members_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">members_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_datasets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_datasets</span><span class="p">(</span><span class="n">contains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">id_contains</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">display_all_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataset_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_datasets" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the datasets contained in a catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contains</code>
            </td>
            <td>
                  <code>Union[str, list]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or a list of strings that are dataset
identifiers to filter the datasets list. If a list is provided then it will return
datasets whose identifier matches any of the strings. If a single dataset identifier is provided and
there is an exact match, only that dataset will be returned. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>id_contains</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter datasets only where the string(s) are contained in the identifier,
ignoring description.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product</code>
            </td>
            <td>
                  <code>Union[str, list]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or a list of strings that are product
identifiers to filter the datasets list. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limit the number of rows returned in the dataframe.
Defaults to -1 which returns all results.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display_all_columns</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True displays all columns returned by the API,
otherwise only the key columns are displayed</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filter the datasets by status, default is to show all results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filter the datasets by type, default is to show all results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: a dataframe with a row for each dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_datasets</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912, PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">contains</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">id_contains</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dataset_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the datasets contained in a catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        contains (Union[str, list], optional): A string or a list of strings that are dataset</span>
<span class="sd">            identifiers to filter the datasets list. If a list is provided then it will return</span>
<span class="sd">            datasets whose identifier matches any of the strings. If a single dataset identifier is provided and</span>
<span class="sd">            there is an exact match, only that dataset will be returned. Defaults to None.</span>
<span class="sd">        id_contains (bool): Filter datasets only where the string(s) are contained in the identifier,</span>
<span class="sd">            ignoring description.</span>
<span class="sd">        product (Union[str, list], optional): A string or a list of strings that are product</span>
<span class="sd">            identifiers to filter the datasets list. Defaults to None.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">            Defaults to -1 which returns all results.</span>
<span class="sd">        display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">            otherwise only the key columns are displayed</span>
<span class="sd">        status (str, optional): filter the datasets by status, default is to show all results.</span>
<span class="sd">        dataset_type (str, optional): filter the datasets by type, default is to show all results.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: a dataframe with a row for each dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="c1"># try for exact match</span>
    <span class="k">if</span> <span class="n">contains</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">contains</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">resp_json</span> <span class="o">=</span> <span class="n">handle_paginated_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;containerType&quot;</span><span class="p">,</span>
                <span class="s2">&quot;region&quot;</span><span class="p">,</span>
                <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                <span class="s2">&quot;coverageStartDate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;coverageEndDate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">resp_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">resp_json</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets&quot;</span>
    <span class="n">ds_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">contains</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_contains</span><span class="p">:</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span>
                <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="o">|</span> <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="p">]</span>

    <span class="k">if</span> <span class="n">product</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/productDatasets&quot;</span>
        <span class="n">prd_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="n">prd_df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">prd_df</span><span class="p">[</span><span class="n">prd_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">product</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">prd_df</span><span class="p">[</span><span class="n">prd_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">product</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">prd_df</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">())]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_df</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
    <span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_df</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">,</span>
            <span class="s2">&quot;containerType&quot;</span><span class="p">,</span>
            <span class="s2">&quot;region&quot;</span><span class="p">,</span>
            <span class="s2">&quot;category&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coverageStartDate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coverageEndDate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ds_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">status</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">dataset_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ds_df</span> <span class="o">=</span> <span class="n">ds_df</span><span class="p">[</span><span class="n">ds_df</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset_type</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">ds_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_distributions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_distributions" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the available distributions (downloadable instances of the dataset with a format type).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The datasetseries identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each distribution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_distributions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the available distributions (downloadable instances of the dataset with a format type).</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        series (str): The datasetseries identifier</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">/datasetseries/</span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">/distributions&quot;</span>
    <span class="n">distros_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">distros_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_indexes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_indexes</span><span class="p">(</span><span class="n">knowledge_base</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_details</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_indexes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>List the indexes in a knowledge base.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>knowledge_base</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Knowledge base (dataset) identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_details</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then show detailed information. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: a dataframe with a column for each index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_indexes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">knowledge_base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_details</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the indexes in a knowledge base.</span>

<span class="sd">    Args:</span>
<span class="sd">        knowledge_base (str): Knowledge base (dataset) identifier.</span>
<span class="sd">        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        show_details (bool | None, optional): If True then show detailed information. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: a dataframe with a column for each index.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">dataspaces/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/datasets/</span><span class="si">{</span><span class="n">knowledge_base</span><span class="si">}</span><span class="s2">/indexes/&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">requests_raise_for_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_details</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_format_full_index_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_format_summary_index_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_product_dataset_mapping" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_product_dataset_mapping</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_product_dataset_mapping" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>get the product to dataset linking contained in  a catalog. A product is a grouping of datasets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or list of strings that are dataset</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or list of strings that are product</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: a dataframe with a row  for each dataset to product mapping.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_product_dataset_mapping</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;get the product to dataset linking contained in  a catalog. A product is a grouping of datasets.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str | list[str] | None, optional): A string or list of strings that are dataset</span>
<span class="sd">        identifiers to filter the output. If a list is provided then it will return</span>
<span class="sd">        datasets whose identifier matches any of the strings. Defaults to None.</span>
<span class="sd">        product (str | list[str] | None, optional): A string or list of strings that are product</span>
<span class="sd">        identifiers to filter the output. If a list is provided then it will return</span>
<span class="sd">        products whose identifier matches any of the strings. Defaults to None.</span>
<span class="sd">        catalog (str | None, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: a dataframe with a row  for each dataset to product mapping.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/productDatasets&quot;</span>
    <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">)</span>
            <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">product</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">product</span><span class="p">)</span>
            <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">mapping_df</span> <span class="o">=</span> <span class="n">mapping_df</span><span class="p">[</span><span class="n">mapping_df</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">mapping_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_products" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_products</span><span class="p">(</span><span class="n">contains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">id_contains</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">display_all_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_products" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the products contained in a catalog. A product is a grouping of datasets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contains</code>
            </td>
            <td>
                  <code>Union[str, list]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or a list of strings that are product
identifiers to filter the products list. If a list is provided then it will return
products whose identifier matches any of the strings. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>id_contains</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter datasets only where the string(s) are contained in the identifier,
ignoring description.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Limit the number of rows returned in the dataframe.
Defaults to -1 which returns all results.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display_all_columns</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True displays all columns returned by the API,
otherwise only the key columns are displayed</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: a dataframe with a row for each product</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_products</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">contains</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">id_contains</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the products contained in a catalog. A product is a grouping of datasets.</span>

<span class="sd">    Args:</span>
<span class="sd">        contains (Union[str, list], optional): A string or a list of strings that are product</span>
<span class="sd">            identifiers to filter the products list. If a list is provided then it will return</span>
<span class="sd">            products whose identifier matches any of the strings. Defaults to None.</span>
<span class="sd">        id_contains (bool): Filter datasets only where the string(s) are contained in the identifier,</span>
<span class="sd">            ignoring description.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        max_results (int, optional): Limit the number of rows returned in the dataframe.</span>
<span class="sd">            Defaults to -1 which returns all results.</span>
<span class="sd">        display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">            otherwise only the key columns are displayed</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: a dataframe with a row for each product</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/products&quot;</span>
    <span class="n">full_prod_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contains</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">contains</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">contains</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_contains</span><span class="p">:</span>
            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">full_prod_df</span><span class="p">[</span><span class="n">full_prod_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">full_prod_df</span><span class="p">[</span>
                <span class="n">full_prod_df</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="o">|</span> <span class="n">full_prod_df</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">full_prod_df</span>

    <span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
    <span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span>
            <span class="n">filtered_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;region&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">max_results</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">filtered_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_registered_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_registered_attributes</span><span class="p">(</span><span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">display_all_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_registered_attributes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the list of attributes in a catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then print the dataframe. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display_all_columns</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True displays all columns returned by the API,
otherwise only the key columns are displayed</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>class</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>pandas.DataFrame</code>: A dataframe with a row for each attribute</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_registered_attributes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the list of attributes in a catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        output (bool, optional): If True then print the dataframe. Defaults to False.</span>
<span class="sd">        display_all_columns (bool, optional): If True displays all columns returned by the API,</span>
<span class="sd">            otherwise only the key columns are displayed</span>

<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: A dataframe with a row for each attribute</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/attributes&quot;</span>
    <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
        <span class="n">ds_attr_df</span> <span class="o">=</span> <span class="n">ds_attr_df</span><span class="p">[</span>
            <span class="n">ds_attr_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;dataType&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;publisher&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;applicationId&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">ds_attr_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_report_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_report_attributes</span><span class="p">(</span><span class="n">report_id</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">display_all_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_report_attributes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the attributes (report elements) of a specific report.</p>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_report_attributes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">report_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the attributes (report elements) of a specific report.&quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_new_root_url</span><span class="p">()</span><span class="si">}</span><span class="s2">/api/corelineage-service/v1/reports/</span><span class="si">{</span><span class="n">report_id</span><span class="si">}</span><span class="s2">/reportElements&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
        <span class="n">rep_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
            <span class="n">key_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;dataType&quot;</span><span class="p">,</span> <span class="s2">&quot;isMandatory&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;createdBy&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="n">rep_df</span> <span class="o">=</span> <span class="n">rep_df</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">rep_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;dataType&quot;</span><span class="p">,</span> <span class="s2">&quot;isMandatory&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;createdBy&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.list_reports" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_reports</span><span class="p">(</span><span class="n">report_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">display_all_columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.list_reports" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve a single report or all reports from the Fusion system.</p>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_reports</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">report_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">display_all_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a single report or all reports from the Fusion system.&quot;&quot;&quot;</span>
    <span class="n">key_columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;alternateId&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tierType&quot;</span><span class="p">,</span>
        <span class="s2">&quot;frequency&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subCategory&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reportOwner&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lob&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">report_id</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_new_root_url</span><span class="p">()</span><span class="si">}</span><span class="s2">/api/corelineage-service/v1/reports/</span><span class="si">{</span><span class="n">report_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="n">rep_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
                <span class="n">rep_df</span> <span class="o">=</span> <span class="n">rep_df</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="n">rep_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_new_root_url</span><span class="p">()</span><span class="si">}</span><span class="s2">/api/corelineage-service/v1/reports/list&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">rep_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">display_all_columns</span><span class="p">:</span>
                <span class="n">rep_df</span> <span class="o">=</span> <span class="n">rep_df</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="n">rep_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">key_columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.listen_to_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">listen_to_events</span><span class="p">(</span><span class="n">last_event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.listen_to_events" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run server sent event listener in the background. Retrieve results by running get_events.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>last_event_id</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last event ID (exclusive).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>catalog.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subscription url. Defaults to client's root url.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">listen_to_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">last_event_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run server sent event listener in the background. Retrieve results by running get_events.</span>

<span class="sd">    Args:</span>
<span class="sd">        last_event_id (str): Last event ID (exclusive).</span>
<span class="sd">        catalog (str): catalog.</span>
<span class="sd">        url (str): subscription url. Defaults to client&#39;s root url.</span>
<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span> <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">url</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiohttp_sse_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">client</span> <span class="k">as</span> <span class="n">sse_client</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_client</span>

    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">last_event_id</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Last-Event-ID&quot;</span><span class="p">:</span> <span class="n">last_event_id</span><span class="p">}}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_events</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Events sync function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="mf">1e100</span>
        <span class="n">session</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">sse_client</span><span class="o">.</span><span class="n">EventSource</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/notifications/subscribe&quot;</span><span class="p">,</span>
            <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">messages</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                    <span class="n">event</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                    <span class="c1"># Preserve the original metaData column</span>
                    <span class="n">original_meta_data</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metaData&quot;</span><span class="p">,</span> <span class="p">{})</span>

                    <span class="c1"># Flatten the metaData dictionary into the event dictionary</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">event</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">original_meta_data</span><span class="p">)</span>
                    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst</span><span class="p">)],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                            <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
                        <span class="p">)</span>
            <span class="k">except</span> <span class="ne">TimeoutError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">raise</span>

    <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_resources</span><span class="p">()</span>  <span class="c1"># refresh token</span>
    <span class="k">if</span> <span class="s2">&quot;headers&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">bearer_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">bearer_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="s2">&quot;http&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s2">&quot;https&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">proxies</span><span class="p">[</span><span class="s2">&quot;https&quot;</span><span class="p">]</span>
    <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">async_events</span><span class="p">(),),</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.output_dataflow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output_dataflow</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;Once&#39;</span><span class="p">,</span> <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_third_party_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_restricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_raw_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maintainer</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan Fusion&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">publisher</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan&#39;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">created_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modified_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delivery_channel</span><span class="o">=</span><span class="s1">&#39;API&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;Available&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s1">&#39;Flow&#39;</span><span class="p">,</span> <span class="n">container_type</span><span class="o">=</span><span class="s1">&#39;Snapshot-Full&#39;</span><span class="p">,</span> <span class="n">snowflake</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complexity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_immutable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_mnpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_pci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_pii</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_client</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_public</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_internal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_confidential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_highly_confidential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_active</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owners</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">producer_application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">consumer_application_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flow_details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.output_dataflow" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate an Output Dataflow object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifier</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset title. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A category or list of categories for the dataset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset description. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frequency</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frequency of the dataset. Defaults to "Once".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Once&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal_only_dataset</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for internal datasets. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_third_party_data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for third party data. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_restricted</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for restricted datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_raw_data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for raw datasets. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maintainer</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset maintainer. Defaults to "J.P. Morgan Fusion".</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan Fusion&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of data vendor which provided the data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Region. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>publisher</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of vendor that publishes the data. Defaults to "J.P. Morgan".</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product to associate dataset with. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sub-category. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tags used for search purposes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>created_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modified_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Modified date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delivery_channel</code>
            </td>
            <td>
                  <code>str | list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delivery channel. Defaults to "API".</p>
              </div>
            </td>
            <td>
                  <code>&#39;API&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>language</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Language. Defaults to "English".</p>
              </div>
            </td>
            <td>
                  <code>&#39;English&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Status. Defaults to "Available".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Available&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type_</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset type. Defaults to "Flow".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Flow&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>container_type</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Container type. Defaults to "Snapshot-Full".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Snapshot-Full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snowflake</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Snowflake account connection. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complexity</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Complexity. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_immutable</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for immutable datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_mnpi</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_mnpi. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_pci</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_pci. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_pii</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_pii. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_client</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_client. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_public</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_public. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_internal</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_internal. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_confidential</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_confidential. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_highly_confidential</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_highly_confidential. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_active</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is_active. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>owners</code>
            </td>
            <td>
                  <code>list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The owners of the dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>application_id</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The application ID of the dataset. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>producer_application_id</code>
            </td>
            <td>
                  <code>dict[str, str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The producer application ID (upstream application
producing the flow).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>consumer_application_id</code>
            </td>
            <td>
                  <code>list[dict[str, str]] | dict[str, str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The consumer application
ID (downstream application, consuming the flow).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flow_details</code>
            </td>
            <td>
                  <code>dict[str, str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flow details. Specifies input versus output flow.
Defaults to {"flowDirection": "Output"}.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataset</code></td>            <td>
                  <code><span title="fusion.dataflow.OutputDataFlow">OutputDataFlow</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion OutputDataFlow class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fusion</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">fusion</span><span class="o">.</span><span class="n">output_dataflow</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;MY_DATAFLOW&quot;</span><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>See the dataset module for more information on functionalities of output dataflow objects.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">output_dataflow</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
    <span class="n">is_internal_only_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">is_third_party_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_raw_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan Fusion&quot;</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
    <span class="n">product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">created_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modified_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Flow&quot;</span><span class="p">,</span>
    <span class="n">container_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;Snapshot-Full&quot;</span><span class="p">,</span>
    <span class="n">snowflake</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">complexity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_immutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_mnpi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_pci</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_pii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_client</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_internal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_highly_confidential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">owners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">application_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">producer_application_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consumer_application_id</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">flow_details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OutputDataFlow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate an Output Dataflow object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier (str): Dataset identifier.</span>
<span class="sd">        title (str, optional): Dataset title. If not provided, defaults to identifier.</span>
<span class="sd">        category (str | list[str] | None, optional): A category or list of categories for the dataset.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">        description (str, optional): Dataset description. If not provided, defaults to identifier.</span>
<span class="sd">        frequency (str, optional): The frequency of the dataset. Defaults to &quot;Once&quot;.</span>
<span class="sd">        is_internal_only_dataset (bool, optional): Flag for internal datasets. Defaults to False.</span>
<span class="sd">        is_third_party_data (bool, optional): Flag for third party data. Defaults to True.</span>
<span class="sd">        is_restricted (bool | None, optional): Flag for restricted datasets. Defaults to None.</span>
<span class="sd">        is_raw_data (bool, optional): Flag for raw datasets. Defaults to True.</span>
<span class="sd">        maintainer (str | None, optional): Dataset maintainer. Defaults to &quot;J.P. Morgan Fusion&quot;.</span>
<span class="sd">        source (str | list[str] | None, optional): Name of data vendor which provided the data. Defaults to None.</span>
<span class="sd">        region (str | list[str] | None, optional): Region. Defaults to None.</span>
<span class="sd">        publisher (str, optional): Name of vendor that publishes the data. Defaults to &quot;J.P. Morgan&quot;.</span>
<span class="sd">        product (str | list[str] | None, optional): Product to associate dataset with. Defaults to None.</span>
<span class="sd">        sub_category (str | list[str] | None, optional): Sub-category. Defaults to None.</span>
<span class="sd">        tags (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">        created_date (str | None, optional): Created date. Defaults to None.</span>
<span class="sd">        modified_date (str | None, optional): Modified date. Defaults to None.</span>
<span class="sd">        delivery_channel (str | list[str], optional): Delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">        language (str, optional): Language. Defaults to &quot;English&quot;.</span>
<span class="sd">        status (str, optional): Status. Defaults to &quot;Available&quot;.</span>
<span class="sd">        type_ (str | None, optional): Dataset type. Defaults to &quot;Flow&quot;.</span>
<span class="sd">        container_type (str | None, optional): Container type. Defaults to &quot;Snapshot-Full&quot;.</span>
<span class="sd">        snowflake (str | None, optional): Snowflake account connection. Defaults to None.</span>
<span class="sd">        complexity (str | None, optional): Complexity. Defaults to None.</span>
<span class="sd">        is_immutable (bool | None, optional): Flag for immutable datasets. Defaults to None.</span>
<span class="sd">        is_mnpi (bool | None, optional): is_mnpi. Defaults to None.</span>
<span class="sd">        is_pci (bool | None, optional): is_pci. Defaults to None.</span>
<span class="sd">        is_pii (bool | None, optional): is_pii. Defaults to None.</span>
<span class="sd">        is_client (bool | None, optional): is_client. Defaults to None.</span>
<span class="sd">        is_public (bool | None, optional): is_public. Defaults to None.</span>
<span class="sd">        is_internal (bool | None, optional): is_internal. Defaults to None.</span>
<span class="sd">        is_confidential (bool | None, optional): is_confidential. Defaults to None.</span>
<span class="sd">        is_highly_confidential (bool | None, optional): is_highly_confidential. Defaults to None.</span>
<span class="sd">        is_active (bool | None, optional): is_active. Defaults to None.</span>
<span class="sd">        owners (list[str] | None, optional): The owners of the dataset. Defaults to None.</span>
<span class="sd">        application_id (str | None, optional): The application ID of the dataset. Defaults to None.</span>
<span class="sd">        producer_application_id (dict[str, str] | None, optional): The producer application ID (upstream application</span>
<span class="sd">            producing the flow).</span>
<span class="sd">        consumer_application_id (list[dict[str, str]] | dict[str, str] | None, optional): The consumer application</span>
<span class="sd">            ID (downstream application, consuming the flow).</span>
<span class="sd">        flow_details (dict[str, str] | None, optional): The flow details. Specifies input versus output flow.</span>
<span class="sd">            Defaults to {&quot;flowDirection&quot;: &quot;Output&quot;}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataset: Fusion OutputDataFlow class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from fusion import Fusion</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; dataset = fusion.output_dataflow(identifier=&quot;MY_DATAFLOW&quot;)</span>

<span class="sd">    Note:</span>
<span class="sd">        See the dataset module for more information on functionalities of output dataflow objects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flow_details</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;flowDirection&quot;</span><span class="p">:</span> <span class="s2">&quot;Output&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="n">flow_details</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">flow_details</span>
    <span class="n">dataflow_obj</span> <span class="o">=</span> <span class="n">OutputDataFlow</span><span class="p">(</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">is_internal_only_dataset</span><span class="o">=</span><span class="n">is_internal_only_dataset</span><span class="p">,</span>
        <span class="n">is_third_party_data</span><span class="o">=</span><span class="n">is_third_party_data</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
        <span class="n">is_raw_data</span><span class="o">=</span><span class="n">is_raw_data</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
        <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
        <span class="n">created_date</span><span class="o">=</span><span class="n">created_date</span><span class="p">,</span>
        <span class="n">modified_date</span><span class="o">=</span><span class="n">modified_date</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
        <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
        <span class="n">container_type</span><span class="o">=</span><span class="n">container_type</span><span class="p">,</span>
        <span class="n">snowflake</span><span class="o">=</span><span class="n">snowflake</span><span class="p">,</span>
        <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
        <span class="n">is_immutable</span><span class="o">=</span><span class="n">is_immutable</span><span class="p">,</span>
        <span class="n">is_mnpi</span><span class="o">=</span><span class="n">is_mnpi</span><span class="p">,</span>
        <span class="n">is_pci</span><span class="o">=</span><span class="n">is_pci</span><span class="p">,</span>
        <span class="n">is_pii</span><span class="o">=</span><span class="n">is_pii</span><span class="p">,</span>
        <span class="n">is_client</span><span class="o">=</span><span class="n">is_client</span><span class="p">,</span>
        <span class="n">is_public</span><span class="o">=</span><span class="n">is_public</span><span class="p">,</span>
        <span class="n">is_internal</span><span class="o">=</span><span class="n">is_internal</span><span class="p">,</span>
        <span class="n">is_confidential</span><span class="o">=</span><span class="n">is_confidential</span><span class="p">,</span>
        <span class="n">is_highly_confidential</span><span class="o">=</span><span class="n">is_highly_confidential</span><span class="p">,</span>
        <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
        <span class="n">owners</span><span class="o">=</span><span class="n">owners</span><span class="p">,</span>
        <span class="n">application_id</span><span class="o">=</span><span class="n">application_id</span><span class="p">,</span>
        <span class="n">producer_application_id</span><span class="o">=</span><span class="n">producer_application_id</span><span class="p">,</span>
        <span class="n">consumer_application_id</span><span class="o">=</span><span class="n">consumer_application_id</span><span class="p">,</span>
        <span class="n">flow_details</span><span class="o">=</span><span class="n">flow_details</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">dataflow_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">dataflow_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.product" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">product</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">short_abstract</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">is_active</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_restricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maintainer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span> <span class="n">publisher</span><span class="o">=</span><span class="s1">&#39;J.P. Morgan&#39;</span><span class="p">,</span> <span class="n">sub_category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delivery_channel</span><span class="o">=</span><span class="s1">&#39;API&#39;</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">release_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;Available&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">logo</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.product" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a Product object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifier</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product title. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Category. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>short_abstract</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Short description. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description. If not provided, defaults to identifier.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_active</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean for Active status. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_restricted</code>
            </td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for restricted products. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maintainer</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product maintainer. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product region. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Global&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>publisher</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of vendor that publishes the data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;J.P. Morgan&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_category</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product sub-category. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tags used for search purposes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delivery_channel</code>
            </td>
            <td>
                  <code>str | list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product delivery channel. Defaults to "API".</p>
              </div>
            </td>
            <td>
                  <code>&#39;API&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>theme</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product theme. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>release_date</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product release date. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>language</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product language. Defaults to "English".</p>
              </div>
            </td>
            <td>
                  <code>&#39;English&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product status. Defaults to "Available".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Available&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product image. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logo</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product logo. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str | list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product datasets. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Product</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="fusion.product.Product" href="../products/#fusion.product.Product">Product</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fusion Product class instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span> <span class="o">=</span> <span class="n">Fusion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fusion</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;PRODUCT_1&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Product&quot;</span><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>See the product module for more information on functionalities of product objects.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">product</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">short_abstract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_restricted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">maintainer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Global&quot;</span><span class="p">,</span>
    <span class="n">publisher</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;J.P. Morgan&quot;</span><span class="p">,</span>
    <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delivery_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
    <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">release_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Available&quot;</span><span class="p">,</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">logo</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Product</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a Product object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier (str): Product identifier.</span>
<span class="sd">        title (str, optional): Product title. If not provided, defaults to identifier.</span>
<span class="sd">        category (str | list[str] | None, optional): Category. Defaults to None.</span>
<span class="sd">        short_abstract (str, optional): Short description. Defaults to &quot;&quot;.</span>
<span class="sd">        description (str, optional): Description. If not provided, defaults to identifier.</span>
<span class="sd">        is_active (bool, optional): Boolean for Active status. Defaults to True.</span>
<span class="sd">        is_restricted (bool | None, optional): Flag for restricted products. Defaults to None.</span>
<span class="sd">        maintainer (str | list[str] | None, optional): Product maintainer. Defaults to None.</span>
<span class="sd">        region (str | list[str] | None, optional): Product region. Defaults to None.</span>
<span class="sd">        publisher (str | None, optional): Name of vendor that publishes the data. Defaults to None.</span>
<span class="sd">        sub_category (str | list[str] | None, optional): Product sub-category. Defaults to None.</span>
<span class="sd">        tag (str | list[str] | None, optional): Tags used for search purposes. Defaults to None.</span>
<span class="sd">        delivery_channel (str | list[str], optional): Product delivery channel. Defaults to &quot;API&quot;.</span>
<span class="sd">        theme (str | None, optional): Product theme. Defaults to None.</span>
<span class="sd">        release_date (str | None, optional): Product release date. Defaults to None.</span>
<span class="sd">        language (str, optional): Product language. Defaults to &quot;English&quot;.</span>
<span class="sd">        status (str, optional): Product status. Defaults to &quot;Available&quot;.</span>
<span class="sd">        image (str, optional): Product image. Defaults to &quot;&quot;.</span>
<span class="sd">        logo (str, optional): Product logo. Defaults to &quot;&quot;.</span>
<span class="sd">        dataset (str | list[str] | None, optional): Product datasets. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Product: Fusion Product class instance.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; fusion.product(identifier=&quot;PRODUCT_1&quot;, title=&quot;Product&quot;)</span>

<span class="sd">    Note:</span>
<span class="sd">        See the product module for more information on functionalities of product objects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">product_obj</span> <span class="o">=</span> <span class="n">Product</span><span class="p">(</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
        <span class="n">short_abstract</span><span class="o">=</span><span class="n">short_abstract</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">is_active</span><span class="o">=</span><span class="n">is_active</span><span class="p">,</span>
        <span class="n">is_restricted</span><span class="o">=</span><span class="n">is_restricted</span><span class="p">,</span>
        <span class="n">maintainer</span><span class="o">=</span><span class="n">maintainer</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="n">delivery_channel</span><span class="o">=</span><span class="n">delivery_channel</span><span class="p">,</span>
        <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
        <span class="n">release_date</span><span class="o">=</span><span class="n">release_date</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
        <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
        <span class="n">logo</span><span class="o">=</span><span class="n">logo</span><span class="p">,</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">product_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">product_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">sub_category</span><span class="p">,</span> <span class="n">data_node_id</span><span class="p">,</span> <span class="n">regulatory_related</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">tier_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lob</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alternative_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_lob</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_bcbs239_program</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">risk_area</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">risk_stripe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sap_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.report" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a Report object with the current Fusion client attached.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the report.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the report or process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frequency</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reporting frequency (e.g., Monthly, Quarterly).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Main classification of the report.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_category</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sub-classification under the main category.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_node_id</code>
            </td>
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Associated data node details. Should include "name" and "dataNodeType".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regulatory_related</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the report is regulatory-designated. This is a required field.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tier_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tier classification (e.g., "Tier 1", "Non Tier 1").</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lob</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line of business.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alternative_id</code>
            </td>
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternate identifiers for the report.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sub_lob</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Subdivision of the line of business.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_bcbs239_program</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the report is part of the BCBS 239 program.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>risk_area</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Risk area covered by the report.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>risk_stripe</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stripe or classification under the risk area.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sap_code</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SAP financial tracking code.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code>dict[str, str | bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain details. Typically contains a "name" key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional optional fields such as:
- tier_designation (str)
- region (str)
- mnpi_indicator (bool)
- country_of_reporting_obligation (str)
- primary_regulator (str)</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Report</code></td>            <td>
                  <code><span title="fusion.report.Report">Report</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Report object ready for API upload or further manipulation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">frequency</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sub_category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data_node_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">regulatory_related</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">domain</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">tier_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alternative_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sub_lob</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_bcbs239_program</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">risk_area</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">risk_stripe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sap_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Report</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a Report object with the current Fusion client attached.</span>

<span class="sd">    Args:</span>
<span class="sd">        description (str): Description of the report.</span>
<span class="sd">        title (str): Title of the report or process.</span>
<span class="sd">        frequency (str): Reporting frequency (e.g., Monthly, Quarterly).</span>
<span class="sd">        category (str): Main classification of the report.</span>
<span class="sd">        sub_category (str): Sub-classification under the main category.</span>
<span class="sd">        data_node_id (dict[str, str]): Associated data node details. Should include &quot;name&quot; and &quot;dataNodeType&quot;.</span>
<span class="sd">        regulatory_related (bool): Whether the report is regulatory-designated. This is a required field.</span>
<span class="sd">        tier_type (str, optional): Tier classification (e.g., &quot;Tier 1&quot;, &quot;Non Tier 1&quot;).</span>
<span class="sd">        lob (str, optional): Line of business.</span>
<span class="sd">        alternative_id (dict[str, str], optional): Alternate identifiers for the report.</span>
<span class="sd">        sub_lob (str, optional): Subdivision of the line of business.</span>
<span class="sd">        is_bcbs239_program (bool, optional): Whether the report is part of the BCBS 239 program.</span>
<span class="sd">        risk_area (str, optional): Risk area covered by the report.</span>
<span class="sd">        risk_stripe (str, optional): Stripe or classification under the risk area.</span>
<span class="sd">        sap_code (str, optional): SAP financial tracking code.</span>
<span class="sd">        domain (dict[str, str | bool], optional): Domain details. Typically contains a &quot;name&quot; key.</span>
<span class="sd">        **kwargs (Any): Additional optional fields such as:</span>
<span class="sd">            - tier_designation (str)</span>
<span class="sd">            - region (str)</span>
<span class="sd">            - mnpi_indicator (bool)</span>
<span class="sd">            - country_of_reporting_obligation (str)</span>
<span class="sd">            - primary_regulator (str)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Report: A Report object ready for API upload or further manipulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">report_obj</span> <span class="o">=</span> <span class="n">Report</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
        <span class="n">sub_category</span><span class="o">=</span><span class="n">sub_category</span><span class="p">,</span>
        <span class="n">data_node_id</span><span class="o">=</span><span class="n">data_node_id</span><span class="p">,</span>
        <span class="n">regulatory_related</span><span class="o">=</span><span class="n">regulatory_related</span><span class="p">,</span>
        <span class="n">tier_type</span><span class="o">=</span><span class="n">tier_type</span><span class="p">,</span>
        <span class="n">lob</span><span class="o">=</span><span class="n">lob</span><span class="p">,</span>
        <span class="n">alternative_id</span><span class="o">=</span><span class="n">alternative_id</span><span class="p">,</span>
        <span class="n">sub_lob</span><span class="o">=</span><span class="n">sub_lob</span><span class="p">,</span>
        <span class="n">is_bcbs239_program</span><span class="o">=</span><span class="n">is_bcbs239_program</span><span class="p">,</span>
        <span class="n">risk_area</span><span class="o">=</span><span class="n">risk_area</span><span class="p">,</span>
        <span class="n">risk_stripe</span><span class="o">=</span><span class="n">risk_stripe</span><span class="p">,</span>
        <span class="n">sap_code</span><span class="o">=</span><span class="n">sap_code</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">report_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.report_attribute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_attribute</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">sourceIdentifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">technicalDataType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.report_attribute" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a ReportAttribute object with this client for metadata creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The display title of the attribute (required).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sourceIdentifier</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A unique identifier or reference ID from the source system.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A longer description of the attribute.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>technicalDataType</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The technical data type (e.g., string, int, boolean).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The hierarchical path or logical grouping for the attribute.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ReportAttribute</code></td>            <td>
                  <code><span title="fusion.report_attributes.ReportAttribute">ReportAttribute</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single ReportAttribute instance with the client context attached.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>fusion = Fusion()
attr = fusion.report_attribute(
...     title="Customer ID",
...     sourceIdentifier="cust_id_123",
...     description="Unique customer identifier",
...     technicalDataType="String",
...     path="Customer.Details"
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_attribute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sourceIdentifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">technicalDataType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReportAttribute</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a ReportAttribute object with this client for metadata creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        title (str): The display title of the attribute (required).</span>
<span class="sd">        sourceIdentifier (str | None, optional): A unique identifier or reference ID from the source system.</span>
<span class="sd">        description (str | None, optional): A longer description of the attribute.</span>
<span class="sd">        technicalDataType (str | None, optional): The technical data type (e.g., string, int, boolean).</span>
<span class="sd">        path (str | None, optional): The hierarchical path or logical grouping for the attribute.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ReportAttribute: A single ReportAttribute instance with the client context attached.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; attr = fusion.report_attribute(</span>
<span class="sd">        ...     title=&quot;Customer ID&quot;,</span>
<span class="sd">        ...     sourceIdentifier=&quot;cust_id_123&quot;,</span>
<span class="sd">        ...     description=&quot;Unique customer identifier&quot;,</span>
<span class="sd">        ...     technicalDataType=&quot;String&quot;,</span>
<span class="sd">        ...     path=&quot;Customer.Details&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attribute_obj</span> <span class="o">=</span> <span class="n">ReportAttribute</span><span class="p">(</span>
        <span class="n">sourceIdentifier</span><span class="o">=</span><span class="n">sourceIdentifier</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">technicalDataType</span><span class="o">=</span><span class="n">technicalDataType</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">attribute_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">attribute_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.report_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_attributes</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.report_attributes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a ReportAttributes collection with this client, allowing batch creation or manipulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>attributes</code>
            </td>
            <td>
                  <code>list[<span title="fusion.report_attributes.ReportAttribute">ReportAttribute</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of ReportAttribute objects to include.
Defaults to an empty list if not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ReportAttributes</code></td>            <td>
                  <code><span title="fusion.report_attributes.ReportAttributes">ReportAttributes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ReportAttributes collection object with the client context attached.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>fusion = Fusion()
attr1 = fusion.report_attribute(title="Code")
attr2 = fusion.report_attribute(title="Label")
attr_collection = fusion.report_attributes([attr1, attr2])
attr_collection.create(report_id="abc-123")</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_attributes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attributes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ReportAttribute</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReportAttributes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a ReportAttributes collection with this client, allowing batch creation or manipulation.</span>

<span class="sd">    Args:</span>
<span class="sd">        attributes (list[ReportAttribute] | None, optional): A list of ReportAttribute objects to include.</span>
<span class="sd">            Defaults to an empty list if not provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ReportAttributes: A ReportAttributes collection object with the client context attached.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; attr1 = fusion.report_attribute(title=&quot;Code&quot;)</span>
<span class="sd">        &gt;&gt;&gt; attr2 = fusion.report_attribute(title=&quot;Label&quot;)</span>
<span class="sd">        &gt;&gt;&gt; attr_collection = fusion.report_attributes([attr1, attr2])</span>
<span class="sd">        &gt;&gt;&gt; attr_collection.create(report_id=&quot;abc-123&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attributes_obj</span> <span class="o">=</span> <span class="n">ReportAttributes</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">[])</span>
    <span class="n">attributes_obj</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">return</span> <span class="n">attributes_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.reports" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reports</span><span class="p">()</span></code>

<a href="#fusion.fusion.Fusion.reports" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a ReportsWrapper collection with this client, providing access to
report-related operations such as creation, retrieval, and bulk manipulation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ReportsWrapper</code></td>            <td>
                  <code><span title="fusion.report.ReportsWrapper">ReportsWrapper</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ReportsWrapper collection object with the client context attached.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>fusion = Fusion()
reports = fusion.reports()
new_report = reports.create(
...     title="Monthly Risk Report",
...     description="Summary of monthly risk metrics",
...     frequency="Monthly",
...     category="Risk",
...     sub_category="Credit Risk",
...     data_node_id={"id": "node123"},
...     regulatory_related=True,
...     domain={"id": "domain123"}
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReportsWrapper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a ReportsWrapper collection with this client, providing access to</span>
<span class="sd">    report-related operations such as creation, retrieval, and bulk manipulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ReportsWrapper: A ReportsWrapper collection object with the client context attached.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; fusion = Fusion()</span>
<span class="sd">        &gt;&gt;&gt; reports = fusion.reports()</span>
<span class="sd">        &gt;&gt;&gt; new_report = reports.create(</span>
<span class="sd">        ...     title=&quot;Monthly Risk Report&quot;,</span>
<span class="sd">        ...     description=&quot;Summary of monthly risk metrics&quot;,</span>
<span class="sd">        ...     frequency=&quot;Monthly&quot;,</span>
<span class="sd">        ...     category=&quot;Risk&quot;,</span>
<span class="sd">        ...     sub_category=&quot;Credit Risk&quot;,</span>
<span class="sd">        ...     data_node_id={&quot;id&quot;: &quot;node123&quot;},</span>
<span class="sd">        ...     regulatory_related=True,</span>
<span class="sd">        ...     domain={&quot;id&quot;: &quot;domain123&quot;}</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ReportsWrapper</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.to_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_bytes</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">series_member</span><span class="p">,</span> <span class="n">dataset_format</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.to_bytes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns an instance of dataset (the distribution) as a bytes object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_member</code>
            </td>
            <td>
                  <code>(str,)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset series member identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_format</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file format, e.g. CSV or Parquet. Defaults to 'parquet'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;parquet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_bytes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">series_member</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BytesIO</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns an instance of dataset (the distribution) as a bytes object.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        series_member (str,): A dataset series member identifier</span>
<span class="sd">        dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">distribution_to_url</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">,</span>
        <span class="n">series_member</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Fusion</span><span class="o">.</span><span class="n">_call_for_bytes_object</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_df</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="n">dataset_format</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_par</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataframe_type</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.to_df" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Gets distributions for a specified date or date range and returns the data as a dataframe.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt_str</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a single date or a range identified by a start or end date,
or both separated with a ":". Defaults to 'latest' which will return the most recent
instance of the dataset.</p>
              </div>
            </td>
            <td>
                  <code>&#39;latest&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_format</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file format, e.g. CSV or Parquet. Defaults to 'parquet'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;parquet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_par</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specify how many distributions to download in parallel.
Defaults to all cpus available.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Display a progress bar during data download Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code>List</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of columns to return from a parquet file. Defaults to None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters</code>
            </td>
            <td>
                  <code>List</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Tuple] or List[List[Tuple]] or None (default)
Rows which do not match the filter predicate will be removed from scanned data.
Partition keys embedded in a nested directory structure will be exploited to avoid
loading files at all if they contain no matching rows. If use_legacy_dataset is True,
filters can only reference partition keys and only a hive-style directory structure
is supported. When setting use_legacy_dataset to False, also within-file level filtering
and different partitioning schemes are supported.
More on https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_download</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then will always download a file even
if it is already on disk. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>download_folder</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path, absolute or relative, where downloaded files are saved.
Defaults to download_folder as set in <strong>init</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataframe_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type</p>
              </div>
            </td>
            <td>
                  <code>&#39;pandas&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_df</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
    <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="n">PyArrowFilterT</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dataframe_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets distributions for a specified date or date range and returns the data as a dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">            or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">            instance of the dataset.</span>
<span class="sd">        dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        n_par (int, optional): Specify how many distributions to download in parallel.</span>
<span class="sd">            Defaults to all cpus available.</span>
<span class="sd">        show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">        columns (List, optional): A list of columns to return from a parquet file. Defaults to None</span>
<span class="sd">        filters (List, optional): List[Tuple] or List[List[Tuple]] or None (default)</span>
<span class="sd">            Rows which do not match the filter predicate will be removed from scanned data.</span>
<span class="sd">            Partition keys embedded in a nested directory structure will be exploited to avoid</span>
<span class="sd">            loading files at all if they contain no matching rows. If use_legacy_dataset is True,</span>
<span class="sd">            filters can only reference partition keys and only a hive-style directory structure</span>
<span class="sd">            is supported. When setting use_legacy_dataset to False, also within-file level filtering</span>
<span class="sd">            and different partitioning schemes are supported.</span>
<span class="sd">            More on https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html</span>
<span class="sd">        force_download (bool, optional): If True then will always download a file even</span>
<span class="sd">            if it is already on disk. Defaults to False.</span>
<span class="sd">        download_folder (str, optional): The path, absolute or relative, where downloaded files are saved.</span>
<span class="sd">            Defaults to download_folder as set in __init__</span>
<span class="sd">        dataframe_type (str, optional): Type</span>
<span class="sd">    Returns:</span>
<span class="sd">        class:`pandas.DataFrame`: a dataframe containing the requested data.</span>
<span class="sd">            If multiple dataset instances are retrieved then these are concatenated first.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="c1"># sample data is limited to csv</span>
    <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">:</span>
        <span class="n">dataset_format</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">download_folder</span><span class="p">:</span>
        <span class="n">download_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span>

    <span class="n">download_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
        <span class="n">dataset</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">,</span>
        <span class="n">n_par</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">force_download</span><span class="p">,</span>
        <span class="n">download_folder</span><span class="p">,</span>
        <span class="n">return_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">download_res</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must specify &#39;return_paths=True&#39; in download call to use this function&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">):</span>
        <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Not all downloads were successfully completed. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Re-run to collect missing files. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">]</span>

    <span class="n">pd_read_fn_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="n">read_csv</span><span class="p">,</span>
        <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="n">read_parquet</span><span class="p">,</span>
        <span class="s2">&quot;parq&quot;</span><span class="p">:</span> <span class="n">read_parquet</span><span class="p">,</span>
        <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">read_json</span><span class="p">,</span>
        <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">read_csv</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">pd_read_default_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
            <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
            <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
            <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
            <span class="s2">&quot;dataframe_type&quot;</span><span class="p">:</span> <span class="n">dataframe_type</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="n">pd_read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">]</span>

    <span class="n">pd_reader</span> <span class="o">=</span> <span class="n">pd_read_fn_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">)</span>
    <span class="n">pd_read_kwargs</span> <span class="o">=</span> <span class="n">pd_read_default_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd_reader</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No pandas function to read file in format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">pd_read_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>
            <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No series members for dataset: </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in date or date range: </span><span class="si">{</span><span class="n">dt_str</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and format: </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">),</span>
            <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;parq&quot;</span><span class="p">]:</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd_reader</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">pd_read_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">elif</span> <span class="n">dataset_format</span> <span class="o">==</span> <span class="s2">&quot;raw&quot;</span><span class="p">:</span>
        <span class="n">dataframes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">pd_reader</span><span class="p">(</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="o">**</span><span class="n">pd_read_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">namelist</span><span class="p">()],</span>  <span class="c1"># type: ignore  # noqa: SIM115</span>
                <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span>
        <span class="p">)</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dataframes</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd_reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">pd_read_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">dataframe_type</span> <span class="o">==</span> <span class="s2">&quot;pandas&quot;</span><span class="p">:</span>
            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dataframe_type</span> <span class="o">==</span> <span class="s2">&quot;polars&quot;</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;diagonal&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">data_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.to_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_table</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="n">dataset_format</span><span class="o">=</span><span class="s1">&#39;parquet&#39;</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_par</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.to_table" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Gets distributions for a specified date or date range and returns the data as an arrow table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataset identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt_str</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a single date or a range identified by a start or end date,
or both separated with a ":". Defaults to 'latest' which will return the most recent
instance of the dataset.</p>
              </div>
            </td>
            <td>
                  <code>&#39;latest&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_format</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file format, e.g. CSV or Parquet. Defaults to 'parquet'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;parquet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_par</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specify how many distributions to download in parallel.
Defaults to all cpus available.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Display a progress bar during data download Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code>List</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of columns to return from a parquet file. Defaults to None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters</code>
            </td>
            <td>
                  <code>List</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Tuple] or List[List[Tuple]] or None (default)
Rows which do not match the filter predicate will be removed from scanned data.
Partition keys embedded in a nested directory structure will be exploited to avoid
loading files at all if they contain no matching rows. If use_legacy_dataset is True,
filters can only reference partition keys and only a hive-style directory structure
is supported. When setting use_legacy_dataset to False, also within-file level filtering
and different partitioning schemes are supported.
More on https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_download</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True then will always download a file even
if it is already on disk. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>download_folder</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path, absolute or relative, where downloaded files are saved.
Defaults to download_folder as set in <strong>init</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_table</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
    <span class="n">dataset_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="n">PyArrowFilterT</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">download_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets distributions for a specified date or date range and returns the data as an arrow table.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (str): A dataset identifier</span>
<span class="sd">        dt_str (str, optional): Either a single date or a range identified by a start or end date,</span>
<span class="sd">            or both separated with a &quot;:&quot;. Defaults to &#39;latest&#39; which will return the most recent</span>
<span class="sd">            instance of the dataset.</span>
<span class="sd">        dataset_format (str, optional): The file format, e.g. CSV or Parquet. Defaults to &#39;parquet&#39;.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        n_par (int, optional): Specify how many distributions to download in parallel.</span>
<span class="sd">            Defaults to all cpus available.</span>
<span class="sd">        show_progress (bool, optional): Display a progress bar during data download Defaults to True.</span>
<span class="sd">        columns (List, optional): A list of columns to return from a parquet file. Defaults to None</span>
<span class="sd">        filters (List, optional): List[Tuple] or List[List[Tuple]] or None (default)</span>
<span class="sd">            Rows which do not match the filter predicate will be removed from scanned data.</span>
<span class="sd">            Partition keys embedded in a nested directory structure will be exploited to avoid</span>
<span class="sd">            loading files at all if they contain no matching rows. If use_legacy_dataset is True,</span>
<span class="sd">            filters can only reference partition keys and only a hive-style directory structure</span>
<span class="sd">            is supported. When setting use_legacy_dataset to False, also within-file level filtering</span>
<span class="sd">            and different partitioning schemes are supported.</span>
<span class="sd">            More on https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html</span>
<span class="sd">        force_download (bool, optional): If True then will always download a file even</span>
<span class="sd">            if it is already on disk. Defaults to False.</span>
<span class="sd">        download_folder (str, optional): The path, absolute or relative, where downloaded files are saved.</span>
<span class="sd">            Defaults to download_folder as set in __init__</span>
<span class="sd">    Returns:</span>
<span class="sd">        class:`pyarrow.Table`: a dataframe containing the requested data.</span>
<span class="sd">            If multiple dataset instances are retrieved then these are concatenated first.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
    <span class="n">n_par</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">download_folder</span><span class="p">:</span>
        <span class="n">download_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_folder</span>
    <span class="n">download_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
        <span class="n">dataset</span><span class="p">,</span>
        <span class="n">dt_str</span><span class="p">,</span>
        <span class="n">dataset_format</span><span class="p">,</span>
        <span class="n">catalog</span><span class="p">,</span>
        <span class="n">n_par</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">force_download</span><span class="p">,</span>
        <span class="n">download_folder</span><span class="p">,</span>
        <span class="n">return_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">download_res</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must specify &#39;return_paths=True&#39; in download call to use this function&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">):</span>
        <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Not all downloads were successfully completed. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Re-run to collect missing files. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">download_res</span><span class="p">]</span>

    <span class="n">read_fn_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="n">csv_to_table</span><span class="p">,</span>
        <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="n">parquet_to_table</span><span class="p">,</span>
        <span class="s2">&quot;parq&quot;</span><span class="p">:</span> <span class="n">parquet_to_table</span><span class="p">,</span>
        <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">json_to_table</span><span class="p">,</span>
        <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">csv_to_table</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">read_default_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;csv&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
        <span class="s2">&quot;parquet&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
        <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
        <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;fs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="n">read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_default_kwargs</span><span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">]</span>

    <span class="n">reader</span> <span class="o">=</span> <span class="n">read_fn_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">)</span>
    <span class="n">read_kwargs</span> <span class="o">=</span> <span class="n">read_default_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_format</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">reader</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No function to read file in format </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">read_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">APIResponseError</span><span class="p">(</span>
            <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No series members for dataset: </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> in date or date range: </span><span class="si">{</span><span class="n">dt_str</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and format: </span><span class="si">{</span><span class="n">dataset_format</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">),</span>
            <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;parq&quot;</span><span class="p">]:</span>
        <span class="n">tbl</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">read_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tbl</span> <span class="o">=</span> <span class="p">(</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">read_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">tbl</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">concat_tables</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tbl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fusion.fusion.Fusion.upload" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dt_str</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_par</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multipart</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span><span class="p">,</span> <span class="n">from_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preserve_original_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">additional_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fusion.fusion.Fusion.upload" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Uploads the requested files/files to Fusion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to a file or a folder with sub folders and files</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset identifier to which the files will be uploaded.
                    If not provided the dataset will be implied from file's name.
                    This is mandatory when uploading a directory.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt_str</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A file name. Can be any string but is usually a date.
                    Defaults to 'latest' which will return the most recent.
                    Relevant for a single file upload only. If not provided the dataset will
                    be implied from file's name. dt_str will be ignored when uploading
                    a directory.</p>
              </div>
            </td>
            <td>
                  <code>&#39;latest&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A catalog identifier. Defaults to 'common'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_par</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specify how many distributions to upload in parallel.
Defaults to all cpus available.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Display a progress bar during data upload Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_paths</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return paths and success statuses of the uploaded files.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multipart</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is multipart upload. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_size</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum chunk size.</p>
              </div>
            </td>
            <td>
                  <code>5 * 2 ** 20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>from_date</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>start of the data date range contained in the distribution,
defaults to upoad date</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_date</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>end of the data date range contained in the distribution,
defaults to upload date.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>preserve_original_name</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Preserve the original name of the file. Defaults to False.
Original name not preserved when uploading a directory.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        

            <details class="quote">
              <summary>Source code in <code>py_src/fusion/fusion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">upload</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912, PLR0913, PLR0915</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_par</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">multipart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">from_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">preserve_original_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">additional_headers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads the requested files/files to Fusion.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): path to a file or a folder with sub folders and files</span>
<span class="sd">        dataset (str, optional): Dataset identifier to which the files will be uploaded.</span>
<span class="sd">                                If not provided the dataset will be implied from file&#39;s name.</span>
<span class="sd">                                This is mandatory when uploading a directory.</span>
<span class="sd">        dt_str (str, optional): A file name. Can be any string but is usually a date.</span>
<span class="sd">                                Defaults to &#39;latest&#39; which will return the most recent.</span>
<span class="sd">                                Relevant for a single file upload only. If not provided the dataset will</span>
<span class="sd">                                be implied from file&#39;s name. dt_str will be ignored when uploading</span>
<span class="sd">                                a directory.</span>
<span class="sd">        catalog (str, optional): A catalog identifier. Defaults to &#39;common&#39;.</span>
<span class="sd">        n_par (int, optional): Specify how many distributions to upload in parallel.</span>
<span class="sd">            Defaults to all cpus available.</span>
<span class="sd">        show_progress (bool, optional): Display a progress bar during data upload Defaults to True.</span>
<span class="sd">        return_paths (bool, optional): Return paths and success statuses of the uploaded files.</span>
<span class="sd">        multipart (bool, optional): Is multipart upload. Defaults to True.</span>
<span class="sd">        chunk_size (int, optional): Maximum chunk size.</span>
<span class="sd">        from_date (str, optional): start of the data date range contained in the distribution,</span>
<span class="sd">            defaults to upoad date</span>
<span class="sd">        to_date (str, optional): end of the data date range contained in the distribution,</span>
<span class="sd">            defaults to upload date.</span>
<span class="sd">        preserve_original_name (bool, optional): Preserve the original name of the file. Defaults to False.</span>
<span class="sd">            Original name not preserved when uploading a directory.</span>

<span class="sd">    Returns:</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_catalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The provided path does not exist&quot;</span><span class="p">)</span>

    <span class="n">fs_fusion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fusion_filesystem</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;directory&quot;</span><span class="p">:</span>
        <span class="n">validate_file_formats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dt_str</span> <span class="ow">and</span> <span class="n">dt_str</span> <span class="o">!=</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;`dt_str` is not considered when uploading a directory. &quot;</span>
                <span class="s2">&quot;File names in the directory are used as series members instead.&quot;</span>
            <span class="p">)</span>

        <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">]</span>

        <span class="n">base_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="c1"># Construct unique file names by flattening the relative path from the base directory.</span>
        <span class="c1"># For example, if the base directory is &#39;data_folder&#39; and a file is at &#39;data_folder/sub1/file.txt&#39;,</span>
        <span class="c1"># the resulting name will be &#39;data_folder__sub1__file.txt&#39;.</span>
        <span class="c1"># This ensures that files in different subdirectories with the same base name do not conflict</span>
        <span class="c1"># and helps preserve the folder structure in the filename.</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">base_path</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;__&quot;</span> <span class="o">+</span> <span class="s2">&quot;__&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_path_lst</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">catalog</span> <span class="ow">and</span> <span class="n">dataset</span><span class="p">:</span>
            <span class="c1"># Construct URL mappings using the constructed file names as the series member</span>
            <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_name_to_url</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">is_download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No catalog/dataset: validate file names and infer raw</span>
            <span class="n">local_file_validation</span> <span class="o">=</span> <span class="n">validate_file_names</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">)</span>
            <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">flag</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">local_file_validation</span><span class="p">,</span> <span class="n">file_path_lst</span><span class="p">)</span> <span class="k">if</span> <span class="n">flag</span><span class="p">]</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_path_lst</span><span class="p">]</span>
            <span class="n">is_raw_lst</span> <span class="o">=</span> <span class="n">is_dataset_raw</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">fs_fusion</span><span class="p">)</span>
            <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span><span class="n">path_to_url</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">is_raw_lst</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">catalog</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">dataset</span><span class="p">:</span>
            <span class="n">local_file_validation</span> <span class="o">=</span> <span class="n">validate_file_names</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">)</span>
            <span class="n">file_path_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">flag</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">local_file_validation</span><span class="p">,</span> <span class="n">file_path_lst</span><span class="p">)</span> <span class="k">if</span> <span class="n">flag</span><span class="p">]</span>
            <span class="n">is_raw_lst</span> <span class="o">=</span> <span class="n">is_dataset_raw</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">fs_fusion</span><span class="p">)</span>
            <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span><span class="n">path_to_url</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">is_raw_lst</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">preserve_original_name</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;preserve_original_name can only be used when catalog and dataset are provided.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Normalize the dt_str</span>
            <span class="n">date_identifier</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(\d</span><span class="si">{4}</span><span class="s2">)(\d</span><span class="si">{2}</span><span class="s2">)(\d</span><span class="si">{2}</span><span class="s2">)$&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dt_str</span> <span class="o">==</span> <span class="s2">&quot;latest&quot;</span><span class="p">:</span>
                <span class="n">dt_str</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;today&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">date_identifier</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">dt_str</span><span class="p">):</span>
                <span class="n">dt_str</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">dt_str</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">file_format</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="s2">&quot;raw&quot;</span> <span class="k">if</span> <span class="n">file_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RECOGNIZED_FORMATS</span> <span class="k">else</span> <span class="n">file_format</span>

            <span class="n">local_url_eqiv</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">distribution_to_url</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">dt_str</span><span class="p">,</span> <span class="n">file_format</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;directory&quot;</span> <span class="ow">or</span> <span class="n">preserve_original_name</span><span class="p">:</span>
        <span class="n">data_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">local_url_eqiv</span><span class="p">,</span> <span class="n">file_name</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">data_map_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">file_path_lst</span><span class="p">,</span> <span class="n">local_url_eqiv</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">data_map_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">])</span>

    <span class="n">n_par</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">upload_files</span><span class="p">(</span>
        <span class="n">fs_fusion</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
        <span class="n">data_map_df</span><span class="p">,</span>
        <span class="n">multipart</span><span class="o">=</span><span class="n">multipart</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
        <span class="n">from_date</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span>
        <span class="n">to_date</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span>
        <span class="n">additional_headers</span><span class="o">=</span><span class="n">additional_headers</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">):</span>
        <span class="n">failed_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Not all uploads were successfully completed. The following failed:</span><span class="se">\n</span><span class="si">{</span><span class="n">failed_res</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span> <span class="k">if</span> <span class="n">return_paths</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/jpmorganchase/fusion" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:fusion_developers@jpmorgan.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "navigation.tracking"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>